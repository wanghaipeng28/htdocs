<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>Building Interface Extensions &mdash; odoo 8.0 documentation</title>
    
    <link rel="stylesheet" href="odoo.css" tppabs="https://www.odoo.com/documentation/8.0/_static/odoo.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://www.odoo.com/documentation/8.0/_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="patchqueue.css" tppabs="https://www.odoo.com/documentation/8.0/_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="jquery.js" tppabs="https://www.odoo.com/documentation/8.0/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://www.odoo.com/documentation/8.0/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://www.odoo.com/documentation/8.0/_static/doctools.js"></script>
    <script type="text/javascript" src="patchqueue.js" tppabs="https://www.odoo.com/documentation/8.0/_static/patchqueue.js"></script>
    <script type="text/javascript" src="scrollspy.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/scrollspy.js"></script>
    <script type="text/javascript" src="affix.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/affix.js"></script>
    <script type="text/javascript" src="tooltip.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/tooltip.js"></script>
    <script type="text/javascript" src="collapse.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/collapse.js"></script>
    <script type="text/javascript" src="dropdown.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/dropdown.js"></script>
    <script type="text/javascript" src="ZeroClipboard.min.js" tppabs="https://www.odoo.com/documentation/8.0/_static/zeroclipboard-2.1.6/ZeroClipboard.min.js"></script>
    <script type="text/javascript" src="app.js" tppabs="https://www.odoo.com/documentation/8.0/_static/app.js"></script>
    <link rel="top" title="odoo 8.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials.html" />
    <link rel="next" title="Setting Up" href="../setup.html" />
    <link rel="prev" title="Building Themes" href="themes.html" /><link rel="canonical" href="https://www.odoo.com/documentation/8.0/howtos/web.html"/>
  </head>
  <body><header class="navbar navbar-default navbar-static-top docs-nav" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-main">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="index.html" tppabs="https://www.odoo.com/documentation/8.0/index.html" class="o_logo navbar-brand">
        <span class="o_logo_main">odoo</span><span class="o_logo_app">doc</span>
      </a>
      
        <div class="versions navbar-brand">
          <a class="dropdown-toggle" data-toggle="dropdown">
            8.0 <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" role="menu">
            
              <li><a href="javascript:if(confirm('https://www.odoo.com/documentation/master/howtos/web.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://www.odoo.com/documentation/master/howtos/web.html'" tppabs="https://www.odoo.com/documentation/master/howtos/web.html">master</a></li>
            
          </ul>
        </div>
      
    </div>
    <nav class="collapse navbar-collapse navbar-main" role="navigation">
      <ul class="current nav navbar-nav navbar-right">
<li class="toctree-l1 current dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="tutorials.html" tppabs="https://www.odoo.com/documentation/8.0/tutorials.html">Tutorials</a><ul class="current dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="website.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html">Building a Website</a></li>
<li class="toctree-l2"><a class="reference internal" href="backend.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html">Building a Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="themes.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html">Building Themes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Building Interface Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="setup.html" tppabs="https://www.odoo.com/documentation/8.0/setup.html">Setting Up</a><ul class="dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="install.html" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html">Installing Odoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html">Deploying Odoo</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="reference.html" tppabs="https://www.odoo.com/documentation/8.0/reference.html">Reference</a><ul class="dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="orm.html" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html">ORM</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html">Data Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="module.html" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmdline.html" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html">Command-line interface: odoo.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html">Security in Odoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html">Testing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="http.html" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html">Web Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="qweb.html" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html">QWeb</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html">Javascript</a></li>
<li class="toctree-l2"><a class="reference internal" href="translations.html" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html">Translating Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="reports.html" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html">QWeb Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html">Workflows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_integration.html" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html">Web Service</a><ul class="simple">
</ul>
</li>
</ul>

    </nav>
  </div>
</header><div class="document-super ">
    

    <div class="document"><div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
      <ul class="current nav">
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html" tppabs="https://www.odoo.com/documentation/8.0/tutorials.html">Tutorials</a><ul class="current nav">
<li class="toctree-l2"><a class="reference internal" href="website.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html">Building a Website</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="website.html#creating-a-basic-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#creating-a-basic-module">Creating a basic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#a-demonstration-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#a-demonstration-module">A demonstration module</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#to-the-browser" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#to-the-browser">To the browser</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#templates" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#templates">Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#storing-data-in-odoo" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#storing-data-in-odoo">Storing data in Odoo</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="website.html#defining-the-data-model" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#defining-the-data-model">Defining the data model</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#demonstration-data" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#demonstration-data">Demonstration data</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#accessing-the-data" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#accessing-the-data">Accessing the data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="website.html#website-support" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#website-support">Website support</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#urls-and-routing" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#urls-and-routing">URLs and routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#field-edition" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#field-edition">Field edition</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#administration-and-erp-integration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#administration-and-erp-integration">Administration and ERP integration</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="website.html#a-brief-and-incomplete-introduction-to-the-odoo-administration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#a-brief-and-incomplete-introduction-to-the-odoo-administration">A brief and incomplete introduction to the Odoo administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#editing-in-the-odoo-administration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#editing-in-the-odoo-administration">Editing in the Odoo administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#relations-between-models" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#relations-between-models">Relations between models</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#discussions-and-notifications" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#discussions-and-notifications">Discussions and notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#selling-courses" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#selling-courses">Selling courses</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#altering-existing-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#altering-existing-views">Altering existing views</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="backend.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html">Building a Module</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="backend.html#start-stop-the-odoo-server" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#start-stop-the-odoo-server">Start/Stop the Odoo server</a></li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#build-an-odoo-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#build-an-odoo-module">Build an Odoo module</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#composition-of-a-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#composition-of-a-module">Composition of a module</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#module-structure" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#module-structure">Module structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#object-relational-mapping" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#object-relational-mapping">Object-Relational Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#model-fields" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#model-fields">Model fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#data-files" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#data-files">Data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#actions-and-menus" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#actions-and-menus">Actions and Menus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#basic-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#basic-views">Basic views</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#generic-view-declaration" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#generic-view-declaration">Generic view declaration</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#tree-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#tree-views">Tree views</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#form-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#form-views">Form views</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#search-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#search-views">Search views</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#relations-between-models" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#relations-between-models">Relations between models</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#relational-fields" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#relational-fields">Relational fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#inheritance" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#inheritance">Inheritance</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#model-inheritance" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#model-inheritance">Model inheritance</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#view-inheritance" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#view-inheritance">View inheritance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#computed-fields-and-default-values" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#computed-fields-and-default-values">Computed fields and default values</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#dependencies" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#default-values" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#default-values">Default values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#onchange" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#onchange">Onchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#model-constraints" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#model-constraints">Model constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#advanced-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#advanced-views">Advanced Views</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#id3" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#id3">Tree views</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#calendars" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#calendars">Calendars</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#id4" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#id4">Search views</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#gantt" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#gantt">Gantt</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#graph-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#graph-views">Graph views</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#kanban" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#kanban">Kanban</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#workflows" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#workflows">Workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#security" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#security">Security</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#group-based-access-control-mechanisms" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#group-based-access-control-mechanisms">Group-based access control mechanisms</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#access-rights" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#access-rights">Access rights</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#record-rules" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#record-rules">Record rules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#wizards" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#wizards">Wizards</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#launching-wizards" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#launching-wizards">Launching wizards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#internationalization" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#internationalization">Internationalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#reporting" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#reporting">Reporting</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#printed-reports" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#printed-reports">Printed reports</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#dashboards" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#dashboards">Dashboards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backend.html#webservices" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#webservices">WebServices</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="backend.html#xml-rpc-library" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#xml-rpc-library">XML-RPC Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="backend.html#json-rpc-library" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html#json-rpc-library">JSON-RPC Library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="themes.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html">Building Themes</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="themes.html#basic-set-up" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#basic-set-up">Basic set up</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#static-page" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#static-page">Static Page</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#pimp-your-theme" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#pimp-your-theme">Pimp Your Theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#build-your-first-snippet" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#build-your-first-snippet">Build Your First Snippet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="themes.html#advanced-customization" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#advanced-customization">Advanced Customization</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#defining-your-theme-options" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#defining-your-theme-options">Defining Your Theme Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#the-image-database" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#the-image-database">The Image Database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="themes.html#theme-selector" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#theme-selector">Theme Selector</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#set-up" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#set-up">Set Up</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Building Interface Extensions</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="#a-simple-module">A Simple Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#odoo-javascript-module">Odoo JavaScript Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#widgets-basics">Widgets Basics</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#your-first-widget">Your First Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="#display-content">Display Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="#widget-parents-and-children">Widget Parents and Children</a></li>
<li class="toctree-l4"><a class="reference internal" href="#destroying-widgets">Destroying Widgets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#the-qweb-template-engine">The QWeb Template Engine</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#using-qweb">Using QWeb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#widget-helpers">Widget Helpers</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#widget-s-jquery-selector"><tt class="docutils literal"><span class="pre">Widget</span></tt>&#8216;s jQuery Selector</a></li>
<li class="toctree-l4"><a class="reference internal" href="#easier-dom-events-binding">Easier DOM Events Binding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#widget-events-and-properties">Widget Events and Properties</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#modify-existing-widgets-and-classes">Modify existing widgets and classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#translations">Translations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#communication-with-the-odoo-server">Communication with the Odoo Server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#contacting-models">Contacting Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compoundcontext">CompoundContext</a></li>
<li class="toctree-l4"><a class="reference internal" href="#queries">Queries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exercises">Exercises</a></li>
<li class="toctree-l3"><a class="reference internal" href="#existing-web-components">Existing web components</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#the-action-manager">The Action Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="#client-actions">Client Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#architecture-of-the-views">Architecture of the Views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-form-view-fields">The Form View Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-form-view-custom-widgets">The Form View Custom Widgets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup.html" tppabs="https://www.odoo.com/documentation/8.0/setup.html">Setting Up</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="install.html" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html">Installing Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="install.html#demo" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#demo">Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#saas" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#saas">SaaS</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#packaged-installers" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#packaged-installers">Packaged installers</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="install.html#windows" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#windows">Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#deb" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#deb">Deb</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#rpm" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#rpm">RPM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install.html#source-install" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#source-install">Source Install</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="install.html#installing-dependencies" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#installing-dependencies">Installing dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#running-odoo" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#running-odoo">Running Odoo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html">Deploying Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="deploy.html#dbfilter" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#dbfilter">dbfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#postgresql" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#postgresql">PostgreSQL</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#configuring-odoo" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#configuring-odoo">Configuring Odoo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#https" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#https">HTTPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#builtin-server" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#builtin-server">Builtin server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#livechat" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#livechat">LiveChat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#odoo-as-a-wsgi-application" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#odoo-as-a-wsgi-application">Odoo as a WSGI Application</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#cron-workers" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#cron-workers">Cron Workers</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploy.html#id4" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#id4">LiveChat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#serving-static-files" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#serving-static-files">Serving Static Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#security" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#security">Security</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#super-admin-password" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#super-admin-password">&#8220;Super-admin&#8221; password</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html" tppabs="https://www.odoo.com/documentation/8.0/reference.html">Reference</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="orm.html" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html">ORM</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="orm.html#recordsets" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#recordsets">Recordsets</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#field-access" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#field-access">Field access</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#set-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#set-operations">Set operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#other-recordset-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#other-recordset-operations">Other recordset operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#environment" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#environment">Environment</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#altering-the-environment" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#altering-the-environment">Altering the environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#common-orm-methods" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#common-orm-methods">Common ORM methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#creating-models" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#creating-models">Creating Models</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#computed-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#computed-fields">Computed fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#onchange-updating-ui-on-the-fly" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#onchange-updating-ui-on-the-fly">onchange: updating UI on the fly</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#low-level-sql" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#low-level-sql">Low-level SQL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#old-api-compatibility" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#old-api-compatibility">Old API compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#model-reference" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#model-reference">Model Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#module-openerp.api" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#module-openerp.api">Method decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#fields">Fields</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#basic-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#basic-fields">Basic fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#relational-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#relational-fields">Relational fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#inheritance-and-extension" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#inheritance-and-extension">Inheritance and extension</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#classical-inheritance" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#classical-inheritance">Classical inheritance</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#extension" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#extension">Extension</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#delegation" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#delegation">Delegation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#domains" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#domains">Domains</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#porting-from-the-old-api" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#porting-from-the-old-api">Porting from the old API</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#automatic-bridging-of-old-api-methods" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#automatic-bridging-of-old-api-methods">Automatic bridging of old API methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html">Data Files</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="data.html#structure" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#core-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#core-operations">Core operations</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="data.html#record" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#record"><tt class="docutils literal"><span class="pre">record</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#delete" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#delete"><tt class="docutils literal"><span class="pre">delete</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#function" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#function"><tt class="docutils literal"><span class="pre">function</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#workflow" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#workflow"><tt class="docutils literal"><span class="pre">workflow</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#shortcuts" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#shortcuts">Shortcuts</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="data.html#menuitem" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#menuitem"><tt class="docutils literal"><span class="pre">menuitem</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#template" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#template"><tt class="docutils literal"><span class="pre">template</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#report" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#report"><tt class="docutils literal"><span class="pre">report</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#csv-data-files" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#csv-data-files">CSV data files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="actions.html" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html">Actions</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="actions.html#window-actions-ir-actions-act-window" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#window-actions-ir-actions-act-window">Window Actions (<tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#url-actions-ir-actions-act-url" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#url-actions-ir-actions-act-url">URL Actions (<tt class="docutils literal"><span class="pre">ir.actions.act_url</span></tt>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#server-actions-ir-actions-server" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#server-actions-ir-actions-server">Server Actions (<tt class="docutils literal"><span class="pre">ir.actions.server</span></tt>)</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="actions.html#code" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#code"><tt class="docutils literal"><span class="pre">code</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#object-create" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#object-create"><tt class="docutils literal"><span class="pre">object_create</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#object-write" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#object-write"><tt class="docutils literal"><span class="pre">object_write</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#multi" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#multi"><tt class="docutils literal"><span class="pre">multi</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#trigger" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#trigger"><tt class="docutils literal"><span class="pre">trigger</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#client-action" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#client-action"><tt class="docutils literal"><span class="pre">client_action</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#evaluation-context" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#evaluation-context">Evaluation context</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#report-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#report-actions">Report Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#client-actions-ir-actions-client" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#client-actions-ir-actions-client">Client Actions (<tt class="docutils literal"><span class="pre">ir.actions.client</span></tt>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="views.html" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html">Views</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="views.html#common-structure" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#common-structure">Common Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#inheritance" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#inheritance">Inheritance</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#view-matching" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#view-matching">View matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#view-resolution" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#view-resolution">View resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#inheritance-specs" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#inheritance-specs">Inheritance specs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#lists" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#forms" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#forms">Forms</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#structural-components" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#structural-components">Structural components</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#semantic-components" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#semantic-components">Semantic components</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#business-views-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#business-views-guidelines">Business Views guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#configuration-forms-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#configuration-forms-guidelines">Configuration forms guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#dialog-forms-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#dialog-forms-guidelines">Dialog forms guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#configuration-wizards-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#configuration-wizards-guidelines">Configuration Wizards guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#graphs" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#graphs">Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#kanban" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#kanban">Kanban</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#javascript-api" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#javascript-api">Javascript API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#calendar" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#calendar">Calendar</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#gantt" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#gantt">Gantt</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#diagram" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#diagram">Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#search" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#search">Search</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#search-defaults" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#search-defaults">Search defaults</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#qweb">QWeb</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module.html" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html">Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="module.html#manifest" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html#manifest">Manifest</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cmdline.html" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html">Command-line interface: odoo.py</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#running-the-server" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#running-the-server">Running the server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#database" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#database">database</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#built-in-http" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#built-in-http">built-in HTTP</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#logging" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#logging">logging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#scaffolding" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#scaffolding">Scaffolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#configuration-file" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#configuration-file">Configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="security.html" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html">Security in Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="security.html#access-control" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#access-control">Access Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#record-rules" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#record-rules">Record Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#field-access" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#field-access">Field Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#workflow-transition-rules" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#workflow-transition-rules">Workflow transition rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html">Testing Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="testing.html#running-tests" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html#running-tests">Running tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="http.html" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html">Web Controllers</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="http.html#routing" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#routing">Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#request" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#request">Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#response" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#response">Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#controllers" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#controllers">Controllers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qweb.html" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html">QWeb</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="qweb.html#data-output" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#data-output">data output</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#conditionals" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#conditionals">conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#loops" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#loops">loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#attributes" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#attributes">attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#setting-variables" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#setting-variables">setting variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#calling-sub-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#calling-sub-templates">calling sub-templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#python" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#python">Python</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="qweb.html#exclusive-directives" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#exclusive-directives">Exclusive directives</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#helpers" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#helpers">Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#api" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#javascript" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#javascript">Javascript</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id3" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id3">Exclusive directives</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#debugging" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#debugging">debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id4" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id4">Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id5" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id5">API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html">Javascript</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="javascript.html#widgets" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#widgets">Widgets</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-root" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-root">DOM Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-events-handling" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-events-handling">DOM events handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#subclassing-widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#subclassing-widget">Subclassing Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#development-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#development-guidelines">Development Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#rpc" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#rpc">RPC</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#high-level-api-calling-into-odoo-models" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#high-level-api-calling-into-odoo-models">High-level API: calling into Odoo models</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#low-level-api-rpc-calls-to-python-side" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#low-level-api-rpc-calls-to-python-side">Low-level API: RPC calls to Python side</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#web-client" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#web-client">Web Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#testing-in-odoo-web-client" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#testing-in-odoo-web-client">Testing in Odoo Web Client</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#javascript-unit-testing" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#javascript-unit-testing">Javascript Unit Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#writing-a-test-case" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#writing-a-test-case">Writing a test case</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#assertions" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#assertions">Assertions</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#getting-an-odoo-instance" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#getting-an-odoo-instance">Getting an Odoo instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-scratchpad" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-scratchpad">DOM Scratchpad</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#loading-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#loading-templates">Loading templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#asynchronous-cases" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#asynchronous-cases">Asynchronous cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#id3" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#id3">RPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#testing-api" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#testing-api">Testing API</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#running-through-python" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#running-through-python">Running through Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="translations.html" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html">Translating Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="translations.html#exporting-translatable-term" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#exporting-translatable-term">Exporting translatable term</a></li>
<li class="toctree-l3"><a class="reference internal" href="translations.html#implicit-exports" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#implicit-exports">Implicit exports</a></li>
<li class="toctree-l3"><a class="reference internal" href="translations.html#explicit-exports" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#explicit-exports">Explicit exports</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reports.html" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html">QWeb Reports</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="reports.html#paper-formats" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#paper-formats">Paper Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="reports.html#expressions-used-in-odoo-report-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#expressions-used-in-odoo-report-templates">Expressions used in Odoo report templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="reports.html#custom-report" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#custom-report">Custom report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html">Workflows</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="workflows.html#basics" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="workflows.html#activities" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#activities">Activities</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="workflows.html#flow-start-and-flow-stop" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#flow-start-and-flow-stop">Flow start and flow stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#subflow" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#subflow">Subflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#sending-a-signal-from-a-subflow" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#sending-a-signal-from-a-subflow">Sending a signal from a subflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#server-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#server-actions">Server actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#python-action" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#python-action">Python action</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#split-mode" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#split-mode">Split mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#join-mode" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#join-mode">Join mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#kinds" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#kinds">Kinds</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="workflows.html#transitions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#transitions">Transitions</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="workflows.html#conditions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#conditions">Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#signals" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#signals">Signals</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#triggers" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#triggers">Triggers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_integration.html" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html">Web Service</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="api_integration.html#connection" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#connection">Connection</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#configuration" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#logging-in" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#logging-in">Logging in</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_integration.html#calling-methods" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#calling-methods">Calling methods</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#list-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#list-records">List records</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#pagination" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#pagination">Pagination</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#count-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#count-records">Count records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#read-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#read-records">Read records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#listing-record-fields" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#listing-record-fields">Listing record fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#search-and-read" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#search-and-read">Search and read</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#create-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#create-records">Create records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#update-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#update-records">Update records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#delete-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#delete-records">Delete records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#inspection-and-introspection" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#inspection-and-introspection">Inspection and introspection</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#ir-model" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#ir-model"><tt class="docutils literal"><span class="pre">ir.model</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#ir-model-fields" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#ir-model-fields"><tt class="docutils literal"><span class="pre">ir.model.fields</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#workflow-manipulations" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#workflow-manipulations">Workflow manipulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#report-printing" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#report-printing">Report printing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

      
        <p><a href="javascript:if(confirm('https://github.com/odoo/odoo/edit/8.0/doc/howtos/web.rst  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/odoo/odoo/edit/8.0/doc/howtos/web.rst'" tppabs="https://github.com/odoo/odoo/edit/8.0/doc/howtos/web.rst" class="github">
          Edit on GitHub
        </a></p>
      
    </div>
  </div>
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="building-interface-extensions">
<h1>Building Interface Extensions</h1>
<p>This guide is about creating modules for Odoo&#8217;s web client.</p>
<p>To create websites with Odoo, see <a class="reference internal" href="website.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html"><em>Building a Website</em></a>; to add business capabilities
or extend existing business systems of Odoo, see <a class="reference internal" href="backend.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/backend.html"><em>Building a Module</em></a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This guide assumes knowledge of:</p>
<ul class="simple">
<li>Javascript basics and good practices</li>
<li><a class="reference external" href="javascript:if(confirm('http://jquery.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://jquery.org/'" tppabs="http://jquery.org/">jQuery</a></li>
<li><a class="reference external" href="javascript:if(confirm('http://underscorejs.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://underscorejs.org/'" tppabs="http://underscorejs.org/">Underscore.js</a></li>
</ul>
<p class="last">It also requires <a class="reference internal" href="install.html#setup-install" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#setup-install"><em>an installed Odoo</em></a>, and <a class="reference external" href="javascript:if(confirm('http://git-scm.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://git-scm.com/'" tppabs="http://git-scm.com/">Git</a>.</p>
</div>
<div class="section" id="a-simple-module">
<h2>A Simple Module</h2>
<p>Let&#8217;s start with a simple Odoo module holding basic web component
configuration and letting us test the web framework.</p>
<p>The example module is available online and can be downloaded using the
following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> git clone http://github.com/odoo/petstore
</pre></div>
</div>
<p>This will create a <tt class="docutils literal"><span class="pre">petstore</span></tt> folder wherever you executed the command.
You then need to add that folder to Odoo&#8217;s
<a class="reference internal" href="cmdline.html#cmdoption-odoo.py--addons-path" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#cmdoption-odoo.py--addons-path"><em class="xref std std-option">addons path</em></a>, create a new database and
install the <tt class="docutils literal"><span class="pre">oepetstore</span></tt> module.</p>
<p>If you browse the <tt class="docutils literal"><span class="pre">petstore</span></tt> folder, you should see the following content:</p>
<div class="highlight-text"><div class="highlight"><pre>oepetstore
|-- images
|   |-- alligator.jpg
|   |-- ball.jpg
|   |-- crazy_circle.jpg
|   |-- fish.jpg
|   `-- mice.jpg
|-- __init__.py
|-- oepetstore.message_of_the_day.csv
|-- __openerp__.py
|-- petstore_data.xml
|-- petstore.py
|-- petstore.xml
`-- static
    `-- src
        |-- css
        |   `-- petstore.css
        |-- js
        |   `-- petstore.js
        `-- xml
            `-- petstore.xml
</pre></div>
</div>
<p>The module already holds various server customizations. We&#8217;ll come back to
these later, for now let&#8217;s focus on the web-related content, in the <tt class="docutils literal"><span class="pre">static</span></tt>
folder.</p>
<p>Files used in the &#8220;web&#8221; side of an Odoo module must be placed in a <tt class="docutils literal"><span class="pre">static</span></tt>
folder so they are available to a web browser, files outside that folder can
not be fetched by browsers. The <tt class="docutils literal"><span class="pre">src/css</span></tt>, <tt class="docutils literal"><span class="pre">src/js</span></tt> and <tt class="docutils literal"><span class="pre">src/xml</span></tt>
sub-folders are conventional and not strictly necessary.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">oepetstore/static/css/petstore.css</span></tt></dt>
<dd>currently empty, will hold the <a class="reference external" href="javascript:if(confirm('http://www.w3.org/Style/CSS/Overview.en.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.w3.org/Style/CSS/Overview.en.html'" tppabs="http://www.w3.org/Style/CSS/Overview.en.html">CSS</a> for pet store content</dd>
<dt><tt class="docutils literal"><span class="pre">oepetstore/static/xml/petstore.xml</span></tt></dt>
<dd>Mostly empty, will hold <a class="reference internal" href="qweb.html#reference-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#reference-qweb"><em>QWeb</em></a> templates</dd>
<dt><tt class="docutils literal"><span class="pre">oepetstore/static/js/petstore.js</span></tt></dt>
<dd><p class="first">The most important (and interesting) part, contains the logic of the
application (or at least its web-browser side) as javascript. It should
currently look like:</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pet store home page loaded&quot;</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
        <span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
<p>Which only prints a small message in the browser&#8217;s console.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>All JavaScript files are concatenated and <a class="reference internal" href="glossary.html#term-minified" tppabs="https://www.odoo.com/documentation/8.0/glossary.html#term-minified"><em class="xref std std-term">minified</em></a> to improve
application load time.</p>
<p>One of the drawback is debugging becomes more difficult as
individual files disappear and the code is made significantly less
readable. It is possible to disable this process by enabling the
&#8220;developer mode&#8221;: log into your Odoo instance (user <em>admin</em> password
<em>admin</em> by default) open the user menu (in the top-right corner of the
Odoo screen) and select <em class="guilabel">About Odoo</em> then <em class="guilabel">Activate
the developer mode</em>:</p>
<img alt="../_images/about_odoo.png" class="align-center" src="about_odoo.png" tppabs="https://www.odoo.com/documentation/8.0/_images/about_odoo.png" />
<img alt="../_images/devmode.png" class="align-center" src="devmode.png" tppabs="https://www.odoo.com/documentation/8.0/_images/devmode.png" />
<p class="last">This will reload the web client with optimizations disabled, making
development and debugging significantly more comfortable.</p>
</div>
</div>
<div class="section" id="odoo-javascript-module">
<h2>Odoo JavaScript Module</h2>
<p>Javascript doesn&#8217;t have built-in modules. As a result variables defined in
different files are all mashed together and may conflict. This has given rise
to various module patterns used to build clean namespaces and limit risks of
naming conflicts.</p>
<p>The Odoo framework uses one such pattern to define modules within web addons,
in order to both namespace code and correctly order its loading.</p>
<p><tt class="docutils literal"><span class="pre">oepetstore/static/js/petstore.js</span></tt> contains a module declaration:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">local</span><span class="p">.</span><span class="nx">xxx</span> <span class="o">=</span> <span class="p">...;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Odoo web, modules are declared as functions set on the global <tt class="docutils literal"><span class="pre">openerp</span></tt>
variable. The function&#8217;s name must be the same as the addon (in this case
<tt class="docutils literal"><span class="pre">oepetstore</span></tt>) so the framework can find it, and automatically initialize it.</p>
<p>When the web client decides to load your module, it&#8217;ll call the root function
and provide two parameters:</p>
<ul class="simple">
<li>the first parameter is the current instance of the Odoo web client, it gives
access to various capabilities defined by the Odoo (translations,
network services) as well as objects defined by the core or by other
modules.</li>
<li>the second parameter is your own local namespace automatically created by
the web client. Objects and variables which should be accessible from
outside your module (either because the Odoo web client needs to call them
or because others may want to customize them) should be set inside that
namespace.</li>
</ul>
</div>
<div class="section" id="classes">
<h2>Classes</h2>
<p>Much as modules, and contrary to most object-oriented languages, javascript
does not build in <em>classes</em><a class="footnote-reference" href="#id4" id="id1">[1]</a> although it provides roughly
equivalent (if lower-level and more verbose) mechanisms.</p>
<p>For simplicity and developer-friendliness purposes, Odoo web provides a class
system based on John Resig&#8217;s <a class="reference external" href="javascript:if(confirm('http://ejohn.org/blog/simple-javascript-inheritance/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://ejohn.org/blog/simple-javascript-inheritance/'" tppabs="http://ejohn.org/blog/simple-javascript-inheritance/">Simple JavaScript Inheritance</a>.</p>
<p>New classes are defined by calling the <tt class="xref js js-func docutils literal"><span class="pre">extend()</span></tt>
method of <tt class="xref js js-class docutils literal"><span class="pre">openerp.web.Class()</span></tt>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <tt class="xref js js-func docutils literal"><span class="pre">extend()</span></tt> method takes a dictionary describing
the new class&#8217;s content (methods and static attributes). In this case, it will
only have a <tt class="docutils literal"><span class="pre">say_hello</span></tt> method which takes no parameters.</p>
<p>Classes are instantiated using the <tt class="docutils literal"><span class="pre">new</span></tt> operator:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello&quot; in the console</span>
</pre></div>
</div>
<p>And attributes of the instance can be accessed via <tt class="docutils literal"><span class="pre">this</span></tt>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Bob&quot;</span><span class="p">;</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob&quot; in the console</span>
</pre></div>
</div>
<p>Classes can provide an initializer to perform the initial setup of the
instance, by defining an <tt class="docutils literal"><span class="pre">init()</span></tt> method. The initializer receives the
parameters passed when using the <tt class="docutils literal"><span class="pre">new</span></tt> operator:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob&quot; in the console</span>
</pre></div>
</div>
<p>It is also possible to create subclasses from existing (used-defined) classes
by calling <tt class="xref js js-func docutils literal"><span class="pre">extend()</span></tt> on the parent class, as is done
to subclass <tt class="xref js js-class docutils literal"><span class="pre">Class()</span></tt>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;hola&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hola Bob&quot; in the console</span>
</pre></div>
</div>
<p>When overriding a method using inheritance, you can use <tt class="docutils literal"><span class="pre">this._super()</span></tt> to
call the original method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;translation in Spanish: hola&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print &quot;hello Bob \n translation in Spanish: hola Bob&quot; in the console</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p><tt class="docutils literal"><span class="pre">_super</span></tt> is not a standard method, it is set on-the-fly to the next
method in the current inheritance chain, if any. It is only defined
during the <em>synchronous</em> part of a method call, for use in asynchronous
handlers (after network calls or in <tt class="docutils literal"><span class="pre">setTimeout</span></tt> callbacks) a reference
to its value should be retained, it should not be accessed via <tt class="docutils literal"><span class="pre">this</span></tt>:</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="c1">// broken, will generate an error</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// correct</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// don&#39;t forget .bind()</span>
    <span class="kd">var</span> <span class="nx">_super</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="widgets-basics">
<h2>Widgets Basics</h2>
<p>The Odoo web client bundles <a class="reference external" href="javascript:if(confirm('http://jquery.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://jquery.org/'" tppabs="http://jquery.org/">jQuery</a> for easy DOM manipulation. It is useful
and provides a better API than standard <a class="reference external" href="javascript:if(confirm('http://www.w3.org/TR/DOM-Level-3-Core/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.w3.org/TR/DOM-Level-3-Core/'" tppabs="http://www.w3.org/TR/DOM-Level-3-Core/">W3C DOM</a><a class="footnote-reference" href="#dombugs" id="id2">[2]</a>, but
insufficient to structure complex applications leading to difficult
maintenance.</p>
<p>Much like object-oriented desktop UI toolkits (e.g. <a class="reference external" href="javascript:if(confirm('http://qt-project.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://qt-project.org/'" tppabs="http://qt-project.org/">Qt</a>, <a class="reference external" href="javascript:if(confirm('https://developer.apple.com/technologies/mac/cocoa.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://developer.apple.com/technologies/mac/cocoa.html'" tppabs="https://developer.apple.com/technologies/mac/cocoa.html">Cocoa</a> or <a class="reference external" href="javascript:if(confirm('http://www.gtk.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.gtk.org/'" tppabs="http://www.gtk.org/">GTK</a>),
Odoo Web makes specific components responsible for sections of a page. In
Odoo web, the base for such components is the <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>
class, a component specialized in handling a page section and displaying
information for the user.</p>
<div class="section" id="your-first-widget">
<h3>Your First Widget</h3>
<p>The initial demonstration module already provides a basic widget:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;pet store home page loaded&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>It extends <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a> and overrides the standard method
<a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a>, which  much like the previous <tt class="docutils literal"><span class="pre">MyClass</span></tt>
 does little for now.</p>
<p>This line at the end of the file:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
    <span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>registers our basic widget as a client action. Client actions will be
explained later in the guide, for now this is just what allows our widget to
be called and displayed when we select the
<em class="menuselection">Pet Store  Pet Store  Home Page</em> menu.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">because the widget will be called from outside our module, the web client
needs its &#8220;fully qualified&#8221; name, not the local version.</p>
</div>
</div>
<div class="section" id="display-content">
<h3>Display Content</h3>
<p>Widgets have a number of methods and features, but the basics are simple:</p>
<ul class="simple">
<li>set up a widget</li>
<li>format the widget&#8217;s data</li>
<li>display the widget</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget already has a <a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a>
method. That method is part of the normal widget lifecycle and automatically
called once the widget is inserted in the page. We can use it to display some
content.</p>
<p>All widgets have a <a class="reference internal" href="javascript.html#openerp.Widget._S_el" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget._S_el" title="openerp.Widget.$el"><tt class="xref js js-attr docutils literal"><span class="pre">$el</span></tt></a> which represents the
section of page they&#8217;re in charge of (as a <a class="reference external" href="javascript:if(confirm('http://jquery.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://jquery.org/'" tppabs="http://jquery.org/">jQuery</a> object). Widget content
should be inserted there. By default, <a class="reference internal" href="javascript.html#openerp.Widget._S_el" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget._S_el" title="openerp.Widget.$el"><tt class="xref js js-attr docutils literal"><span class="pre">$el</span></tt></a> is an
empty <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> element.</p>
<p>A <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> element is usually invisible for the user if it does not
have any content (or specific styles giving it a size) which is why nothing
is displayed on the page when <tt class="docutils literal"><span class="pre">HomePage</span></tt> is launched.</p>
<p>Let&#8217;s add some content to the widget&#8217;s root element, using jQuery:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>That message will now appear when you open <em class="menuselection">Pet Store
 Pet Store  Home Page</em></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">to refresh the javascript code loaded in Odoo Web, you will need to reload
the page. There is no need to restart the Odoo server</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget is used by Odoo Web and managed automatically, to
learn how to use a widget &#8220;from scratch&#8221; let&#8217;s create a new one:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;We are so happy to see you again in this menu!&lt;/div&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>We can now add our <tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt> to the <tt class="docutils literal"><span class="pre">HomePage</span></tt> by using the
<tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt>&#8216;s <a class="reference internal" href="javascript.html#openerp.Widget.appendTo" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.appendTo" title="openerp.Widget.appendTo"><tt class="xref js js-func docutils literal"><span class="pre">appendTo()</span></tt></a> method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">HomePage</span></tt> first adds its own content to its DOM root</li>
<li><tt class="docutils literal"><span class="pre">HomePage</span></tt> then instantiates <tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt></li>
<li>Finally it tells <tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt> where to insert itself, delegating part
of its <a class="reference internal" href="javascript.html#openerp.Widget._S_el" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget._S_el" title="openerp.Widget.$el"><tt class="xref js js-attr docutils literal"><span class="pre">$el</span></tt></a> to the <tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt>.</li>
</ul>
<p>When the <a class="reference internal" href="javascript.html#openerp.Widget.appendTo" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.appendTo" title="openerp.Widget.appendTo"><tt class="xref js js-func docutils literal"><span class="pre">appendTo()</span></tt></a> method is called, it asks the
widget to insert itself at the specified position and to display its content.
The <a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a> method will be called during the call
to <a class="reference internal" href="javascript.html#openerp.Widget.appendTo" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.appendTo" title="openerp.Widget.appendTo"><tt class="xref js js-func docutils literal"><span class="pre">appendTo()</span></tt></a>.</p>
<p>To see what happens under the displayed interface, we will use the browser&#8217;s
DOM Explorer. But first let&#8217;s alter our widgets slightly so we can more easily
find where they are, by <a class="reference internal" href="javascript.html#openerp.Widget.className" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.className" title="openerp.Widget.className"><tt class="xref js js-attr docutils literal"><span class="pre">adding</span> <span class="pre">a</span> <span class="pre">class</span> <span class="pre">to</span> <span class="pre">their</span> <span class="pre">root</span> <span class="pre">elements</span></tt></a>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;oe_petstore_homepage&#39;</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
<span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;oe_petstore_greetings&#39;</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If you can find the relevant section of the DOM (right-click on the text
then <em class="guilabel">Inspect Element</em>), it should look like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_homepage&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello dear Odoo user!<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_greetings&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>We are so happy to see you again in this menu!<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Which clearly shows the two <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> elements automatically created by
<a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>, because we added some classes on them.</p>
<p>We can also see the two message-holding divs we added ourselves</p>
<p>Finally, note the <tt class="docutils literal"><span class="pre">&lt;div</span> <span class="pre">class=&quot;oe_petstore_greetings&quot;&gt;</span></tt> element which
represents the <tt class="docutils literal"><span class="pre">GreetingsWidget</span></tt> instance is <em>inside</em> the
<tt class="docutils literal"><span class="pre">&lt;div</span> <span class="pre">class=&quot;oe_petstore_homepage&quot;&gt;</span></tt> which represents the <tt class="docutils literal"><span class="pre">HomePage</span></tt>
instance, since we appended</p>
</div>
<div class="section" id="widget-parents-and-children">
<h3>Widget Parents and Children</h3>
<p>In the previous part, we instantiated a widget using this syntax:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
</div>
<p>The first argument is <tt class="docutils literal"><span class="pre">this</span></tt>, which in that case was a <tt class="docutils literal"><span class="pre">HomePage</span></tt>
instance. This tells the widget being created which other widget is its
<em>parent</em>.</p>
<p>As we&#8217;ve seen, widgets are usually inserted in the DOM by another widget and
<em>inside</em> that other widget&#8217;s root element. This means most widgets are &#8220;part&#8221;
of another widget, and exist on behalf of it. We call the container the
<em>parent</em>, and the contained widget the <em>child</em>.</p>
<p>Due to multiple technical and conceptual reasons, it is necessary for a widget
to know who is his parent and who are its children.</p>
<dl class="docutils">
<dt><tt class="xref js js-func docutils literal"><span class="pre">getParent()</span></tt></dt>
<dd><p class="first">can be used to get the parent of a widget:</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getParent</span><span class="p">().</span><span class="nx">$el</span> <span class="p">);</span>
        <span class="c1">// will print &quot;div.oe_petstore_homepage&quot; in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd>
<dt><tt class="xref js js-func docutils literal"><span class="pre">getChildren()</span></tt></dt>
<dd><p class="first">can be used to get a list of its children:</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">$el</span><span class="p">);</span>
        <span class="c1">// will print &quot;div.oe_petstore_greetings&quot; in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd>
</dl>
<p>When overriding the <a class="reference internal" href="javascript.html#openerp.Widget.init" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.init" title="openerp.Widget.init"><tt class="xref js js-func docutils literal"><span class="pre">init()</span></tt></a> method of a widget it is
<em>of the utmost importance</em> to pass the parent to the <tt class="docutils literal"><span class="pre">this._super()</span></tt> call,
otherwise the relation will not be set up correctly:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Finally, if a widget does not have a parent (e.g. because it&#8217;s the root
widget of the application), <tt class="docutils literal"><span class="pre">null</span></tt> can be provided as parent:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="destroying-widgets">
<h3>Destroying Widgets</h3>
<p>If you can display content to your users, you should also be able to erase
it. This is done via the <a class="reference internal" href="javascript.html#openerp.Widget.destroy" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.destroy" title="openerp.Widget.destroy"><tt class="xref js js-func docutils literal"><span class="pre">destroy()</span></tt></a> method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">greeting</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
</div>
<p>When a widget is destroyed it will first call
<a class="reference internal" href="javascript.html#openerp.Widget.destroy" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.destroy" title="openerp.Widget.destroy"><tt class="xref js js-func docutils literal"><span class="pre">destroy()</span></tt></a> on all its children. Then it erases itself
from the DOM. If you have set up permanent structures in
<a class="reference internal" href="javascript.html#openerp.Widget.init" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.init" title="openerp.Widget.init"><tt class="xref js js-func docutils literal"><span class="pre">init()</span></tt></a> or <a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a> which
must be explicitly cleaned up (because the garbage collector will not handle
them), you can override <a class="reference internal" href="javascript.html#openerp.Widget.destroy" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.destroy" title="openerp.Widget.destroy"><tt class="xref js js-func docutils literal"><span class="pre">destroy()</span></tt></a>.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">when overriding <a class="reference internal" href="javascript.html#openerp.Widget.destroy" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.destroy" title="openerp.Widget.destroy"><tt class="xref js js-func docutils literal"><span class="pre">destroy()</span></tt></a>, <tt class="docutils literal"><span class="pre">_super()</span></tt>
<em>must always</em> be called otherwise the widget and its children are not
correctly cleaned up leaving possible memory leaks and &#8220;phantom events&#8221;,
even if no error is displayed</p>
</div>
</div>
</div>
<div class="section" id="the-qweb-template-engine">
<h2>The QWeb Template Engine</h2>
<p>In the previous section we added content to our widgets by directly
manipulating (and adding to) their DOM:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>This allows generating and displaying any type of content, but tends to
rapidly get unwieldy when generating significant amounts of DOM (lots of
duplication, quoting issues, ...)</p>
<p>As many other environments, Odoo&#8217;s solution is to use a <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Web_template_system  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Web_template_system'" tppabs="http://en.wikipedia.org/wiki/Web_template_system">template engine</a>.
Odoo&#8217;s template engine is called <a class="reference internal" href="qweb.html#reference-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#reference-qweb"><em>QWeb</em></a>.</p>
<p>QWeb is an XML-based templating language, similar to <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Genshi_(templating_language)  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Genshi_(templating_language)'" tppabs="http://en.wikipedia.org/wiki/Genshi_(templating_language)">Genshi</a>, <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Thymeleaf  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Thymeleaf'" tppabs="http://en.wikipedia.org/wiki/Thymeleaf">Thymeleaf</a> or <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Facelets  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Facelets'" tppabs="http://en.wikipedia.org/wiki/Facelets">Facelets</a>. It has the following
characteristics:</p>
<ul class="simple">
<li>It&#8217;s implemented fully in JavaScript and rendered in the browser</li>
<li>Each template file (XML files) contains multiple templates</li>
<li>It has special support in Odoo Web&#8217;s <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>, though it
can be used outside of Odoo&#8217;s web client (and it&#8217;s possible to use
<a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a> without relying on QWeb)</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The rationale behind using QWeb instead of existing javascript template
engines is the extensibility of pre-existing (third-party) templates, much
like Odoo <a class="reference internal" href="views.html#reference-views" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#reference-views"><em>views</em></a>.</p>
<p class="last">Most javascript template engines are text-based which precludes easy
structural extensibility where an XML-based templating engine can be
generically altered using e.g. XPath or CSS and a tree-alteration DSL (or
even just XSLT). This flexibility and extensibility is a core
characteristic of Odoo, and losing it was considered unacceptable.</p>
</div>
<div class="section" id="using-qweb">
<h3>Using QWeb</h3>
<p>First let&#8217;s define a simple QWeb template in the almost-empty
<tt class="docutils literal"><span class="pre">oepetstore/static/src/xml/petstore.xml</span></tt> file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">&quot;background-color: red;&quot;</span><span class="nt">&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p>Now we can use this template inside of the <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget. Using the
<tt class="docutils literal"><span class="pre">QWeb</span></tt> loader variable defined at the top of the page, we can call to the
template defined in the XML file:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p><tt class="xref js js-func docutils literal"><span class="pre">QWeb.render()</span></tt> looks for the specified template, renders it to a string
and returns the result.</p>
<p>However, because <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a> has special integration for QWeb
the template can be set directly on the widget via its
<a class="reference internal" href="javascript.html#openerp.Widget.template" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.template" title="openerp.Widget.template"><tt class="xref js js-attr docutils literal"><span class="pre">template</span></tt></a> attribute:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Although the result look similar, there are two differences between these
usages:</p>
<ul class="simple">
<li>with the second version, the template is rendered right before
<a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a> is called</li>
<li>in the first version the template&#8217;s content is added to the widget&#8217;s root
element, whereas in the second version the template&#8217;s root element is
directly <em>set as</em> the widget&#8217;s root element. Which is why the &#8220;greetings&#8221;
sub-widget also gets a red background</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">templates should have a single non-<tt class="docutils literal"><span class="pre">t</span></tt> root element, especially if
they&#8217;re set as a widget&#8217;s <a class="reference internal" href="javascript.html#openerp.Widget.template" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.template" title="openerp.Widget.template"><tt class="xref js js-attr docutils literal"><span class="pre">template</span></tt></a>. If there are
multiple &#8220;root elements&#8221;, results are undefined (usually only the first
root element will be used and the others will be ignored)</p>
</div>
<div class="section" id="qweb-context">
<h4>QWeb Context</h4>
<p>QWeb templates can be given data and can contain basic display logic.</p>
<p>For explicit calls to <tt class="xref js js-func docutils literal"><span class="pre">QWeb.render()</span></tt>, the template data is passed as
second parameter:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Klaus&quot;</span><span class="p">});</span>
</pre></div>
</div>
<p>with the template modified to:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>will result in:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>Hello Klaus<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>When using <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>&#8216;s integration it is not possible to
provide additional data to the template. The template will be given a single
<tt class="docutils literal"><span class="pre">widget</span></tt> context variable, referencing the widget being rendered right
before <a class="reference internal" href="javascript.html#openerp.Widget.start" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.start" title="openerp.Widget.start"><tt class="xref js js-func docutils literal"><span class="pre">start()</span></tt></a> is called (the widget&#8217;s state will
essentially be that set up by <a class="reference internal" href="javascript.html#openerp.Widget.init" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.init" title="openerp.Widget.init"><tt class="xref js js-func docutils literal"><span class="pre">init()</span></tt></a>):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;widget.name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePageTemplate&quot;</span><span class="p">,</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Mordecai&quot;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Result:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>Hello Mordecai<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="template-declaration">
<h4>Template Declaration</h4>
<p>We&#8217;ve seen how to <em>render</em> QWeb templates, let&#8217;s now see the syntax of
the templates themselves.</p>
<p>A QWeb template is composed of regular XML mixed with QWeb <em>directives</em>. A
QWeb directive is declared with XML attributes starting with <tt class="docutils literal"><span class="pre">t-</span></tt>.</p>
<p>The most basic directive is <tt class="docutils literal"><span class="pre">t-name</span></tt>, used to declare new templates in
a template file:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;templates&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePageTemplate&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">t-name</span></tt> takes the name of the template being defined, and declares that
it can be called using <tt class="xref js js-func docutils literal"><span class="pre">QWeb.render()</span></tt>. It can only be used at the
top-level of a template file.</p>
</div>
<div class="section" id="escaping">
<h4>Escaping</h4>
<p>The <tt class="docutils literal"><span class="pre">t-esc</span></tt> directive can be used to output text:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>It takes a Javascript expression which is evaluated, the result of the
expression is then HTML-escaped and inserted in the document. Since it&#8217;s an
expression it&#8217;s possible to provide just a variable name as above, or a more
complex expression like a computation:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;3+5&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>or method calls:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name.toUpperCase()&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="outputting-html">
<h4>Outputting HTML</h4>
<p>To inject HTML in the page being rendered, use <tt class="docutils literal"><span class="pre">t-raw</span></tt>. Like <tt class="docutils literal"><span class="pre">t-esc</span></tt> it
takes an arbitrary Javascript expression as parameter, but it does not
perform an HTML-escape step.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-raw=</span><span class="s">&quot;name.link(user_account)&quot;</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last"><tt class="docutils literal"><span class="pre">t-raw</span></tt> <em>must not</em> be used on any data which may contain non-escaped
user-provided content as this leads to <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Cross-site_scripting  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Cross-site_scripting'" tppabs="http://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting</a>
vulnerabilities</p>
</div>
</div>
<div class="section" id="conditionals">
<h4>Conditionals</h4>
<p>QWeb can have conditional blocks using <tt class="docutils literal"><span class="pre">t-if</span></tt>. The directive takes an
arbitrary expression, if the expression is falsy (<tt class="docutils literal"><span class="pre">false</span></tt>, <tt class="docutils literal"><span class="pre">null</span></tt>, <tt class="docutils literal"><span class="pre">0</span></tt>
or an empty string) the whole block is suppressed, otherwise it is displayed.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;true == true&quot;</span><span class="nt">&gt;</span>
        true is true
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;true == false&quot;</span><span class="nt">&gt;</span>
        true is not true
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">QWeb doesn&#8217;t have an &#8220;else&#8221; structure, use a second <tt class="docutils literal"><span class="pre">t-if</span></tt> with the
original condition inverted. You may want to store the condition in a
local variable if it&#8217;s a complex or expensive expression.</p>
</div>
</div>
<div class="section" id="iteration">
<h4>Iteration</h4>
<p>To iterate on a list, use <tt class="docutils literal"><span class="pre">t-foreach</span></tt> and <tt class="docutils literal"><span class="pre">t-as</span></tt>. <tt class="docutils literal"><span class="pre">t-foreach</span></tt> takes an
expression returning a list to iterate on <tt class="docutils literal"><span class="pre">t-as</span></tt> takes a variable name to
bind to each item during iteration.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;names&quot;</span> <span class="na">t-as=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">t-foreach</span></tt> can also be used with numbers and objects
(dictionaries)</p>
</div>
</div>
<div class="section" id="defining-attributes">
<h4>Defining attributes</h4>
<p>QWeb provides two related directives to define computed attributes:
<tt class="samp docutils literal"><span class="pre">t-att-</span><em><span class="pre">name</span></em></tt> and <tt class="samp docutils literal"><span class="pre">t-attf-</span><em><span class="pre">name</span></em></tt>. In either case, <em>name</em> is the
name of the attribute to create (e.g. <tt class="docutils literal"><span class="pre">t-att-id</span></tt> defines the attribute
<tt class="docutils literal"><span class="pre">id</span></tt> after rendering).</p>
<p><tt class="docutils literal"><span class="pre">t-att-</span></tt> takes a javascript expression whose result is set as the
attribute&#8217;s value, it is most useful if all of the attribute&#8217;s value is
computed:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    Input your name:
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">t-att-value=</span><span class="s">&quot;defaultName&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">t-attf-</span></tt> takes a <em>format string</em>. A format string is literal text with
interpolation blocks inside, an interpolation block is a javascript
expression between <tt class="docutils literal"><span class="pre">{{</span></tt> and <tt class="docutils literal"><span class="pre">}}</span></tt>, which will be replaced by the result
of the expression. It is most useful for attributes which are partially
literal and partially computed such as a class:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">t-attf-class=</span><span class="s">&quot;container {{ left ? &#39;text-left&#39; : &#39;&#39; }} {{ extra_class }}&quot;</span><span class="nt">&gt;</span>
    insert content here
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="calling-other-templates">
<h4>Calling other templates</h4>
<p>Templates can be split into sub-templates (for simplicity, maintainability,
reusability or to avoid excessive markup nesting).</p>
<p>This is done using the <tt class="docutils literal"><span class="pre">t-call</span></tt> directive, which takes the name of the
template to render:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;A&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-a&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;B&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;B&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-b&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>rendering the <tt class="docutils literal"><span class="pre">A</span></tt> template will result in:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-a&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;i-am-b&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Sub-templates inherit the rendering context of their caller.</p>
</div>
<div class="section" id="to-learn-more-about-qweb">
<h4>To Learn More About QWeb</h4>
<p>For a QWeb reference, see <a class="reference internal" href="qweb.html#reference-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#reference-qweb"><em>QWeb</em></a>.</p>
</div>
<div class="section" id="exercise">
<h4>Exercise</h4>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Usage of QWeb in Widgets</p>
<p>Create a widget whose constructor takes two parameters aside from
<tt class="docutils literal"><span class="pre">parent</span></tt>: <tt class="docutils literal"><span class="pre">product_names</span></tt> and <tt class="docutils literal"><span class="pre">color</span></tt>.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">product_names</span></tt> should an array of strings, each one the name of a
product</li>
<li><tt class="docutils literal"><span class="pre">color</span></tt> is a string containing a color in CSS color format (ie:
<tt class="docutils literal"><span class="pre">#000000</span></tt> for black).</li>
</ul>
<p>The widget should display the given product names one under the other,
each one in a separate box with a background color with the value of
<tt class="docutils literal"><span class="pre">color</span></tt> and a border. You should use QWeb to render the HTML. Any
necessary CSS should be in <tt class="docutils literal"><span class="pre">oepetstore/static/src/css/petstore.css</span></tt>.</p>
<p>Use the widget in <tt class="docutils literal"><span class="pre">HomePage</span></tt> with half a dozen products.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ProductsWidget</span><span class="p">(</span>
                <span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="s2">&quot;keyboard&quot;</span><span class="p">,</span> <span class="s2">&quot;graphic card&quot;</span><span class="p">,</span> <span class="s2">&quot;screen&quot;</span><span class="p">],</span> <span class="s2">&quot;#00FF00&quot;</span><span class="p">);</span>
            <span class="nx">products</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">ProductsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;ProductsWidget&quot;</span><span class="p">,</span>
        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">products</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">products</span> <span class="o">=</span> <span class="nx">products</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
        <span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;ProductsWidget&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;widget.products&quot;</span> <span class="na">t-as=</span><span class="s">&quot;product&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;oe_products_item&quot;</span>
                      <span class="na">t-attf-style=</span><span class="s">&quot;background-color: {{ widget.color }};&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;product&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/span&gt;</span>
                <span class="nt">&lt;br/&gt;</span>
            <span class="nt">&lt;/t&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_products_item</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">inline</span><span class="o">-</span><span class="k">block</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="nb">black</span><span class="p">;</span>
    <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<a class="last reference internal image-reference" href="qweb.png" tppabs="https://www.odoo.com/documentation/8.0/_images/qweb.png"><img alt="../_images/qweb.png" class="align-center" src="qweb.png" tppabs="https://www.odoo.com/documentation/8.0/_images/qweb.png" style="width: 70%;" /></a>
</div>
</div>
</div>
</div>
<div class="section" id="widget-helpers">
<h2>Widget Helpers</h2>
<div class="section" id="widget-s-jquery-selector">
<h3><tt class="docutils literal"><span class="pre">Widget</span></tt>&#8216;s jQuery Selector</h3>
<p>Selecting DOM elements within a widget can be performed by calling the
<tt class="docutils literal"><span class="pre">find()</span></tt> method on the widget&#8217;s DOM root:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;input.my_input&quot;</span><span class="p">)...</span>
</pre></div>
</div>
<p>But because it&#8217;s an extremely common operation, <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>
provides an equivalent shortcut through the <a class="reference internal" href="javascript.html#openerp.Widget._S_" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget._S_" title="openerp.Widget.$"><tt class="xref js js-func docutils literal"><span class="pre">$()</span></tt></a>
method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input.my_input&quot;</span><span class="p">)...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The global jQuery function <tt class="docutils literal"><span class="pre">$()</span></tt> should <em>never</em> be used unless it is
absolutely necessary: selection on a widget&#8217;s root are scoped to the
widget and local to it, but selections with <tt class="docutils literal"><span class="pre">$()</span></tt> are global to the
page/application and may match parts of other widgets and views, leading
to odd or dangerous side-effects. Since a widget should generally act
only on the DOM section it owns, there is no cause for global selection.</p>
</div>
</div>
<div class="section" id="easier-dom-events-binding">
<h3>Easier DOM Events Binding</h3>
<p>We have previously bound DOM events using normal jQuery event handlers (e.g.
<tt class="docutils literal"><span class="pre">.click()</span></tt> or <tt class="docutils literal"><span class="pre">.change()</span></tt>) on widget elements:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.my_button&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">button_clicked</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>While this works it has a few issues:</p>
<ol class="arabic simple">
<li>it is rather verbose</li>
<li>it does not support replacing the widget&#8217;s root element at runtime as
the binding is only performed when <tt class="docutils literal"><span class="pre">start()</span></tt> is run (during widget
initialization)</li>
<li>it requires dealing with <tt class="docutils literal"><span class="pre">this</span></tt>-binding issues</li>
</ol>
<p>Widgets thus provide a shortcut to DOM event binding via
<a class="reference internal" href="javascript.html#openerp.Widget.events" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.events" title="openerp.Widget.events"><tt class="xref js js-attr docutils literal"><span class="pre">events</span></tt></a>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;click .my_button&quot;</span><span class="o">:</span> <span class="s2">&quot;button_clicked&quot;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p><a class="reference internal" href="javascript.html#openerp.Widget.events" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget.events" title="openerp.Widget.events"><tt class="xref js js-attr docutils literal"><span class="pre">events</span></tt></a> is an object (mapping) of an event to the
function or method to call when the event is triggered:</p>
<ul>
<li><p class="first">the key is an event name, possibly refined with a CSS selector in which
case only if the event happens on a selected sub-element will the function
or method run: <tt class="docutils literal"><span class="pre">click</span></tt> will handle all clicks within the widget, but
<tt class="docutils literal"><span class="pre">click</span> <span class="pre">.my_button</span></tt> will only handle clicks in elements bearing the
<tt class="docutils literal"><span class="pre">my_button</span></tt> class</p>
</li>
<li><p class="first">the value is the action to perform when the event is triggered</p>
<p>It can be either a function:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">&#39;click&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* code here */</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or the name of a method on the object (see example above).</p>
<p>In either case, the <tt class="docutils literal"><span class="pre">this</span></tt> is the widget instance and the handler is given
a single parameter, the <a class="reference external" href="javascript:if(confirm('http://api.jquery.com/category/events/event-object/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://api.jquery.com/category/events/event-object/'" tppabs="http://api.jquery.com/category/events/event-object/">jQuery event object</a> for the event.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="widget-events-and-properties">
<h2>Widget Events and Properties</h2>
<div class="section" id="events">
<h3>Events</h3>
<p>Widgets provide an event system (separate from the DOM/jQuery event system
described above): a widget can fire events on itself, and other widgets (or
itself) can bind themselves and listen for these events:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;click button.ok_button&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;user_chose&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="s1">&#39;click button.cancel_button&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;user_chose&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Are you sure you want to perform this action?&lt;/div&gt;&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;button class=&#39;ok_button&#39;&gt;Ok&lt;/button&gt;&quot;</span> <span class="o">+</span>
            <span class="s2">&quot;&lt;button class=&#39;cancel_button&#39;&gt;Cancel&lt;/button&gt;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>This widget acts as a facade, transforming user input (through DOM events)
into a documentable internal event to which parent widgets can bind
themselves.</p>
<p><tt class="xref js js-func docutils literal"><span class="pre">trigger()</span></tt> takes the name of the event to trigger as
its first (mandatory) argument, any further arguments are treated as event
data and passed directly to listeners.</p>
<p>We can then set up a parent event instantiating our generic widget and
listening to the <tt class="docutils literal"><span class="pre">user_chose</span></tt> event using <tt class="xref js js-func docutils literal"><span class="pre">on()</span></tt>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;user_chose&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">user_chose</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">user_chose</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The user agreed to continue&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The user refused to continue&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p><tt class="xref js js-func docutils literal"><span class="pre">on()</span></tt> binds a function to be called when the
event identified by <tt class="docutils literal"><span class="pre">event_name</span></tt> is. The <tt class="docutils literal"><span class="pre">func</span></tt> argument is the
function to call and <tt class="docutils literal"><span class="pre">object</span></tt> is the object to which that function is
related if it is a method. The bound function will be called with the
additional arguments of <tt class="xref js js-func docutils literal"><span class="pre">trigger()</span></tt> if it has
any. Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">my_event_triggered</span><span class="p">);</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;my_event&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">my_event_triggered</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
    <span class="c1">// will print &quot;1 2 3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Triggering events on an other widget is generally a bad idea. The main
exception to that rule is <tt class="docutils literal"><span class="pre">openerp.web.bus</span></tt> which exists specifically
to broadcasts evens in which any widget could be interested throughout
the Odoo web application.</p>
</div>
</div>
<div class="section" id="properties">
<h3>Properties</h3>
<p>Properties are very similar to normal object attributes in that they allow
storing data on a widget instance, however they have the additional feature
that they trigger events when set:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:name&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name_changed</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Nicolas&quot;</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">name_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;The new value of the property &#39;name&#39; is&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><tt class="xref js js-func docutils literal"><span class="pre">set()</span></tt> sets the value of a property and triggers
<tt class="samp docutils literal"><span class="pre">change:</span><em><span class="pre">propname</span></em></tt> (where <em>propname</em> is the property name passed as
first parameter to <tt class="xref js js-func docutils literal"><span class="pre">set()</span></tt>) and <tt class="docutils literal"><span class="pre">change</span></tt></li>
<li><tt class="xref js js-func docutils literal"><span class="pre">get()</span></tt> retrieves the value of a property.</li>
</ul>
</div>
<div class="section" id="id3">
<h3>Exercise</h3>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Widget Properties and Events</p>
<p>Create a widget <tt class="docutils literal"><span class="pre">ColorInputWidget</span></tt> that will display 3 <tt class="docutils literal"><span class="pre">&lt;input</span>
<span class="pre">type=&quot;text&quot;&gt;</span></tt>. Each of these <tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt> is dedicated to type a
hexadecimal number from 00 to FF. When any of these <tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt> is
modified by the user the widget must query the content of the three
<tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt>, concatenate their values to have a complete CSS color code
(ie: <tt class="docutils literal"><span class="pre">#00FF00</span></tt>) and put the result in a property named <tt class="docutils literal"><span class="pre">color</span></tt>. Please
note the jQuery <tt class="docutils literal"><span class="pre">change()</span></tt> event that you can bind on any HTML
<tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt> element and the <tt class="docutils literal"><span class="pre">val()</span></tt> method that can query the current
value of that <tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt> could be useful to you for this exercise.</p>
<p>Then, modify the <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget to instantiate <tt class="docutils literal"><span class="pre">ColorInputWidget</span></tt>
and display it. The <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget should also display an empty
rectangle. That rectangle must always, at any moment, have the same
background color than the color in the <tt class="docutils literal"><span class="pre">color</span></tt> property of the
<tt class="docutils literal"><span class="pre">ColorInputWidget</span></tt> instance.</p>
<p>Use QWeb to generate all HTML.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">ColorInputWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;ColorInputWidget&quot;</span><span class="p">,</span>
        <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">&#39;change input&#39;</span><span class="o">:</span> <span class="s1">&#39;input_changed&#39;</span>
        <span class="p">},</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input_changed</span><span class="p">();</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="nx">input_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;#&quot;</span><span class="p">,</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_color_red&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_color_green&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_color_blue&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePage&quot;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ColorInputWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:color&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">color_changed</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">color_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_color_div&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">));</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;ColorInputWidget&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            Red: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_color_red&quot;</span> <span class="na">value=</span><span class="s">&quot;00&quot;</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
            Green: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_color_green&quot;</span> <span class="na">value=</span><span class="s">&quot;00&quot;</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
            Blue: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_color_blue&quot;</span> <span class="na">value=</span><span class="s">&quot;00&quot;</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePage&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_color_div&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="last highlight-css"><div class="highlight"><pre><span class="nc">.oe_color_div</span> <span class="p">{</span>
    <span class="k">width</span><span class="o">:</span> <span class="m">100px</span><span class="p">;</span>
    <span class="k">height</span><span class="o">:</span> <span class="m">100px</span><span class="p">;</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="modify-existing-widgets-and-classes">
<h2>Modify existing widgets and classes</h2>
<p>The class system of the Odoo web framework allows direct modification of
existing classes using the <tt class="xref js js-func docutils literal"><span class="pre">include()</span></tt> method:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">TestClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;hello&quot;</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">TestClass</span><span class="p">.</span><span class="nx">include</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; world&quot;</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">TestClass</span><span class="p">().</span><span class="nx">testMethod</span><span class="p">());</span>
<span class="c1">// will print &quot;hello world&quot;</span>
</pre></div>
</div>
<p>This system is similar to the inheritance mechanism, except it will alter the
target class in-place instead of creating a new class.</p>
<p>In that case, <tt class="docutils literal"><span class="pre">this._super()</span></tt> will call the original implementation of a
method being replaced/redefined. If the class already had sub-classes, all
calls to <tt class="docutils literal"><span class="pre">this._super()</span></tt> in sub-classes will call the new implementations
defined in the call to <tt class="xref js js-func docutils literal"><span class="pre">include()</span></tt>. This will also work
if some instances of the class (or of any of its sub-classes) were created
prior to the call to <tt class="xref js js-func docutils literal"><span class="pre">include()</span></tt>.</p>
</div>
<div class="section" id="translations">
<h2>Translations</h2>
<p>The process to translate text in Python and JavaScript code is very
similar. You could have noticed these lines at the beginning of the
<tt class="docutils literal"><span class="pre">petstore.js</span></tt> file:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
    <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
</pre></div>
</div>
<p>These lines are simply used to import the translation functions in the current
JavaScript module. They are used thus:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_t</span><span class="p">(</span><span class="s2">&quot;Hello user!&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p>In Odoo, translations files are automatically generated by scanning the source
code. All piece of code that calls a certain function are detected and their
content is added to a translation file that will then be sent to the
translators. In Python, the function is <tt class="docutils literal"><span class="pre">_()</span></tt>. In JavaScript the function is
<tt class="xref js js-func docutils literal"><span class="pre">_t()</span></tt> (and also <tt class="xref js js-func docutils literal"><span class="pre">_lt()</span></tt>).</p>
<p><tt class="docutils literal"><span class="pre">_t()</span></tt> will return the translation defined for the text it is given. If no
translation is defined for that text, it will return the original text as-is.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To inject user-provided values in translatable strings, it is recommended
to use <a class="reference external" href="javascript:if(confirm('http://gabceb.github.io/underscore.string.site/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://gabceb.github.io/underscore.string.site/#sprintf'" tppabs="http://gabceb.github.io/underscore.string.site/#sprintf">_.str.sprintf</a> with named
arguments <em>after</em> the translation:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">str</span><span class="p">.</span><span class="nx">sprintf</span><span class="p">(</span>
    <span class="nx">_t</span><span class="p">(</span><span class="s2">&quot;Hello, %(user)s!&quot;</span><span class="p">),</span> <span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="s2">&quot;Ed&quot;</span>
<span class="p">}));</span>
</pre></div>
</div>
<p class="last">This makes translatable strings more readable to translators, and gives
them more flexibility to reorder or ignore parameters.</p>
</div>
<p><tt class="xref js js-func docutils literal"><span class="pre">_lt()</span></tt> (&#8220;lazy translate&#8221;) is similar but somewhat more
complex: instead of translating its parameter immediately, it returns
an object which, when converted to a string, will perform the translation.</p>
<p>It is used to define translatable terms before the translations system is
initialized, for class attributes for instance (as modules are loaded before
the user&#8217;s language is configured and translations are downloaded).</p>
</div>
<div class="section" id="communication-with-the-odoo-server">
<h2>Communication with the Odoo Server</h2>
<div class="section" id="contacting-models">
<h3>Contacting Models</h3>
<p>Most operations with Odoo involve communicating with <em>models</em> implementing
business concern, these models will then (potentially) interact with some
storage engine (usually <a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/PostgreSQL  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/PostgreSQL'" tppabs="http://en.wikipedia.org/wiki/PostgreSQL">PostgreSQL</a>).</p>
<p>Although <a class="reference external" href="javascript:if(confirm('http://jquery.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://jquery.org/'" tppabs="http://jquery.org/">jQuery</a> provides a <a class="reference external" href="javascript:if(confirm('http://api.jquery.com/jquery.ajax/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://api.jquery.com/jquery.ajax/'" tppabs="http://api.jquery.com/jquery.ajax/">$.ajax</a> function for network interactions,
communicating with Odoo requires additional metadata whose setup before every
call would be verbose and error-prone. As a result, Odoo web provides
higher-level communication primitives.</p>
<p>To demonstrate this, the file <tt class="docutils literal"><span class="pre">petstore.py</span></tt> already contains a small model
with a sample method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">message_of_the_day</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&quot;oepetstore.message_of_the_day&quot;</span>

    <span class="nd">@api.model</span>
    <span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;hello&quot;</span><span class="p">:</span> <span class="s">&quot;world&quot;</span><span class="p">}</span>

    <span class="n">message</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
</pre></div>
</div>
<p>This declares a model with two fields, and a method <tt class="docutils literal"><span class="pre">my_method()</span></tt> which
returns a literal dictionary.</p>
<p>Here is a sample widget that calls <tt class="docutils literal"><span class="pre">my_method()</span></tt> and displays the result:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s2">&quot;oepetstore.message_of_the_day&quot;</span><span class="p">);</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&quot;&lt;div&gt;Hello &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">[</span><span class="s2">&quot;hello&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">);</span>
            <span class="c1">// will show &quot;Hello world&quot; to the user</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The class used to call Odoo models is <a class="reference internal" href="javascript.html#openerp.Model" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Model" title="openerp.Model"><tt class="xref js js-class docutils literal"><span class="pre">openerp.Model()</span></tt></a>. It is
instantiated with the Odoo model&#8217;s name as first parameter
(<tt class="docutils literal"><span class="pre">oepetstore.message_of_the_day</span></tt> here).</p>
<p><tt class="xref js js-func docutils literal"><span class="pre">call()</span></tt> can be used to call any (public) method of an
Odoo model. It takes the following positional arguments:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">name</span></tt></dt>
<dd>The name of the method to call, <tt class="docutils literal"><span class="pre">my_method</span></tt> here</dd>
<dt><tt class="docutils literal"><span class="pre">args</span></tt></dt>
<dd><p class="first">an array of <a class="reference external" href="javascript:if(confirm('https://docs.python.org/2/glossary.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://docs.python.org/2/glossary.html#term-argument'" tppabs="https://docs.python.org/2/glossary.html#term-argument">positional arguments</a> to provide to the method. Because the
example has no positional argument to provide, the <tt class="docutils literal"><span class="pre">args</span></tt> parameter is not
provided.</p>
<p>Here is an other example with positional arguments:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd>
<dt><tt class="docutils literal"><span class="pre">kwargs</span></tt></dt>
<dd><p class="first">a mapping of <a class="reference external" href="javascript:if(confirm('https://docs.python.org/2/glossary.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://docs.python.org/2/glossary.html#term-argument'" tppabs="https://docs.python.org/2/glossary.html#term-argument">keyword arguments</a> to pass. The example provides a single
named argument <tt class="docutils literal"><span class="pre">context</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd>
</dl>
<p><tt class="xref js js-func docutils literal"><span class="pre">call()</span></tt> returns a deferred resolved with the value
returned by the model&#8217;s method as first argument.</p>
</div>
<div class="section" id="compoundcontext">
<h3>CompoundContext</h3>
<p>The previous section used a <tt class="docutils literal"><span class="pre">context</span></tt> argument which was not explained in
the method call:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()})</span>
</pre></div>
</div>
<p>The context is like a &#8220;magic&#8221; argument that the web client will always give to
the server when calling a method. The context is a dictionary containing
multiple keys. One of the most important key is the language of the user, used
by the server to translate all the messages of the application. Another one is
the time zone of the user, used to compute correctly dates and times if Odoo
is used by people in different countries.</p>
<p>The <tt class="docutils literal"><span class="pre">argument</span></tt> is necessary in all methods, because if we forget it bad
things could happen (like the application not being translated
correctly). That&#8217;s why, when you call a model&#8217;s method, you should always give
it to that argument. The solution to achieve that is to use
<tt class="xref js js-class docutils literal"><span class="pre">openerp.web.CompoundContext()</span></tt>.</p>
<p><tt class="xref js js-class docutils literal"><span class="pre">CompoundContext()</span></tt> is a class used to pass the user&#8217;s
context (with language, time zone, etc...) to the server as well as adding new
keys to the context (some models&#8217; methods use arbitrary keys added to the
context). It is created by giving to its constructor any number of
dictionaries or other <tt class="xref js js-class docutils literal"><span class="pre">CompoundContext()</span></tt> instances. It will
merge all those contexts before sending them to the server.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">&quot;my_method&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">({</span><span class="s1">&#39;new_key&#39;</span><span class="o">:</span> <span class="s1">&#39;key_value&#39;</span><span class="p">})})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">context</span>
    <span class="o">//</span> <span class="n">will</span> <span class="k">print</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;lang&#39;</span><span class="p">:</span> <span class="s">&#39;en_US&#39;</span><span class="p">,</span> <span class="s">&#39;new_key&#39;</span><span class="p">:</span> <span class="s">&#39;key_value&#39;</span><span class="p">,</span> <span class="s">&#39;tz&#39;</span><span class="p">:</span> <span class="s">&#39;Europe/Brussels&#39;</span><span class="p">,</span> <span class="s">&#39;uid&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>You can see the dictionary in the argument <tt class="docutils literal"><span class="pre">context</span></tt> contains some keys that
are related to the configuration of the current user in Odoo plus the
<tt class="docutils literal"><span class="pre">new_key</span></tt> key that was added when instantiating
<tt class="xref js js-class docutils literal"><span class="pre">CompoundContext()</span></tt>.</p>
</div>
<div class="section" id="queries">
<h3>Queries</h3>
<p>While <a class="reference internal" href="javascript.html#openerp.Model.call" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Model.call" title="openerp.Model.call"><tt class="xref js js-func docutils literal"><span class="pre">call()</span></tt></a> is sufficient for any interaction with Odoo
models, Odoo Web provides a helper for simpler and clearer querying of models
(fetching of records based on various conditions):
<a class="reference internal" href="javascript.html#openerp.Model.query" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Model.query" title="openerp.Model.query"><tt class="xref js js-func docutils literal"><span class="pre">query()</span></tt></a> which acts as a shortcut for the common
combination of <a class="reference internal" href="orm.html#openerp.models.Model.search" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model.search" title="openerp.models.Model.search"><tt class="xref py py-meth docutils literal"><span class="pre">search()</span></tt></a> and
:<a class="reference internal" href="orm.html#openerp.models.Model.read" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model.read" title="openerp.models.Model.read"><tt class="xref py py-meth docutils literal"><span class="pre">read()</span></tt></a>. It provides a clearer syntax to search
and read models:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">])</span>
     <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;company_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]])</span>
     <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
     <span class="p">.</span><span class="nx">all</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do work with users records</span>
<span class="p">});</span>
</pre></div>
</div>
<p>versus:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;company_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]],</span> <span class="p">{</span><span class="nx">limit</span><span class="o">:</span> <span class="mi">15</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ids</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="p">[</span><span class="nx">ids</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;user_email&#39;</span><span class="p">,</span> <span class="s1">&#39;signature&#39;</span><span class="p">]]);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// do work with users records</span>
    <span class="p">});</span>
</pre></div>
</div>
<ul class="simple">
<li><tt class="xref js js-func docutils literal"><span class="pre">query()</span></tt> takes an optional list of fields as
parameter (if no field is provided, all fields of the model are fetched). It
returns a <a class="reference internal" href="javascript.html#openerp.web.Query" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.web.Query" title="openerp.web.Query"><tt class="xref js js-class docutils literal"><span class="pre">openerp.web.Query()</span></tt></a> which can be further customized before
being executed</li>
<li><a class="reference internal" href="javascript.html#openerp.web.Query" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.web.Query" title="openerp.web.Query"><tt class="xref js js-class docutils literal"><span class="pre">Query()</span></tt></a> represents the query being built. It is
immutable, methods to customize the query actually return a modified copy,
so it&#8217;s possible to use the original and the new version side-by-side. See
<a class="reference internal" href="javascript.html#openerp.web.Query" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.web.Query" title="openerp.web.Query"><tt class="xref js js-class docutils literal"><span class="pre">Query()</span></tt></a> for its customization options.</li>
</ul>
<p>When the query is set up as desired, simply call
<a class="reference internal" href="javascript.html#openerp.web.Query.all" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.web.Query.all" title="openerp.web.Query.all"><tt class="xref js js-func docutils literal"><span class="pre">all()</span></tt></a> to perform the actual query and return a
deferred to its result. The result is the same as
<a class="reference internal" href="orm.html#openerp.models.Model.read" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model.read" title="openerp.models.Model.read"><tt class="xref py py-meth docutils literal"><span class="pre">read()</span></tt></a>&#8216;s, an array of dictionaries where each
dictionary is a requested record, with each requested field a dictionary key.</p>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises</h2>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Message of the Day</p>
<p>Create a <tt class="docutils literal"><span class="pre">MessageOfTheDay</span></tt>  widget displaying the last record of the
<tt class="docutils literal"><span class="pre">oepetstore.message_of_the_day</span></tt> model. The widget should fetch its
record as soon as it is displayed.</p>
<p>Display the widget in the Pet Store home page.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePage&quot;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span>

    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;MessageOfTheDay&quot;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s2">&quot;oepetstore.message_of_the_day&quot;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s2">&quot;message&quot;</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">order_by</span><span class="p">(</span><span class="s1">&#39;-create_date&#39;</span><span class="p">,</span> <span class="s1">&#39;-id&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">first</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_mywidget_message_of_the_day&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">},</span>
    <span class="p">});</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePage&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_homepage&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;MessageOfTheDay&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_motd&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_mywidget_message_of_the_day&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="last highlight-css"><div class="highlight"><pre><span class="nc">.oe_petstore_motd</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Pet Toys List</p>
<p>Create a <tt class="docutils literal"><span class="pre">PetToysList</span></tt> widget displaying 5 toys (using their name and
their images).</p>
<p>The pet toys are not stored in a new model, instead they&#8217;re stored in
<tt class="docutils literal"><span class="pre">product.product</span></tt> using a special category <em>Pet Toys</em>. You can see the
pre-generated toys and add new ones by going to
<em class="menuselection">Pet Store  Pet Store  Pet Toys</em>. You will probably
need to explore <tt class="docutils literal"><span class="pre">product.product</span></tt> in order to create the right domain to
select just pet toys.</p>
<p>In Odoo, images are generally stored in regular fields encoded as
<a class="reference external" href="javascript:if(confirm('http://en.wikipedia.org/wiki/Base64  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://en.wikipedia.org/wiki/Base64'" tppabs="http://en.wikipedia.org/wiki/Base64">base64</a>, HTML supports displaying images straight from base64 with
<tt class="samp docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=&quot;data:</span><em><span class="pre">mime_type</span></em><span class="pre">;base64,</span><em><span class="pre">base64_image_data</span></em><span class="pre">&quot;/&gt;</span></tt></p>
<p>The <tt class="docutils literal"><span class="pre">PetToysList</span></tt> widget should be displayed on the home page on the
right of the <tt class="docutils literal"><span class="pre">MessageOfTheDay</span></tt> widget. You will need to make some layout
with CSS to achieve this.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">openerp</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">&quot;HomePage&quot;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">$</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span>
                <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.oe_petstore_homepage_left&#39;</span><span class="p">)),</span>
                <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.oe_petstore_homepage_right&#39;</span><span class="p">))</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;MessageOfTheDay&#39;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;oepetstore.message_of_the_day&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s2">&quot;message&quot;</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">order_by</span><span class="p">(</span><span class="s1">&#39;-create_date&#39;</span><span class="p">,</span> <span class="s1">&#39;-id&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">first</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_mywidget_message_of_the_day&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;PetToysList&#39;</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;product.product&#39;</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">&#39;categ_id.name&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;Pet Toys&quot;</span><span class="p">]])</span>
                <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">all</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">_</span><span class="p">(</span><span class="nx">results</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;PetToy&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">item</span><span class="o">:</span> <span class="nx">item</span><span class="p">}));</span>
                    <span class="p">});</span>
                <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">&quot;preserve&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;HomePage&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_homepage&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_homepage_left&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_homepage_right&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;MessageOfTheDay&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_motd&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_mywidget_message_of_the_day&quot;</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;PetToysList&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_pettoyslist&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;PetToy&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_pettoy&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;item.name&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;&lt;img</span> <span class="na">t-att-src=</span><span class="s">&quot;&#39;data:image/jpg;base64,&#39;+item.image&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="last highlight-css"><div class="highlight"><pre><span class="nc">.oe_petstore_homepage</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="n">table</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.oe_petstore_homepage_left</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">table-cell</span><span class="p">;</span>
    <span class="k">width</span> <span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.oe_petstore_homepage_right</span> <span class="p">{</span>
    <span class="k">display</span><span class="o">:</span> <span class="k">table-cell</span><span class="p">;</span>
    <span class="k">width</span> <span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.oe_petstore_motd</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.oe_petstore_pettoyslist</span> <span class="p">{</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.oe_petstore_pettoy</span> <span class="p">{</span>
    <span class="k">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="k">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="k">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="existing-web-components">
<h2>Existing web components</h2>
<div class="section" id="the-action-manager">
<h3>The Action Manager</h3>
<p>In Odoo, many operations start from an <a class="reference internal" href="actions.html#reference-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#reference-actions"><em>action</em></a>:
opening a menu item (to a view), printing a report, ...</p>
<p>Actions are pieces of data describing how a client should react to the
activation of a piece of content. Actions can be stored (and read through a
model) or they can be generated on-the fly (locally to the client by
javascript code, or remotely by a method of a model).</p>
<p>In Odoo Web, the component responsible for handling and reacting to these
actions is the <em>Action Manager</em>.</p>
<div class="section" id="using-the-action-manager">
<h4>Using the Action Manager</h4>
<p>The action manager can be invoked explicitly from javascript code by creating
a dictionary describing <a class="reference internal" href="actions.html#reference-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#reference-actions"><em>an action</em></a> of the right
type, and calling an action manager instance with it.</p>
<p><tt class="xref js js-func docutils literal"><span class="pre">do_action()</span></tt> is a shortcut of <a class="reference internal" href="javascript.html#openerp.Widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#openerp.Widget" title="openerp.Widget"><tt class="xref js js-class docutils literal"><span class="pre">Widget()</span></tt></a>
looking up the &#8220;current&#8221; action manager and executing the action:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">TestWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">dispatch_to_new_action</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">do_action</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ir.actions.act_window&#39;</span><span class="p">,</span>
            <span class="nx">res_model</span><span class="o">:</span> <span class="s2">&quot;product.product&quot;</span><span class="p">,</span>
            <span class="nx">res_id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">views</span><span class="o">:</span> <span class="p">[[</span><span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">]],</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;current&#39;</span><span class="p">,</span>
            <span class="nx">context</span><span class="o">:</span> <span class="p">{},</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The most common action <tt class="docutils literal"><span class="pre">type</span></tt> is <tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt> which provides
views to a model (displays a model in various manners), its most common
attributes are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">res_model</span></tt></dt>
<dd>The model to display in views</dd>
<dt><tt class="docutils literal"><span class="pre">res_id</span></tt> (optional)</dt>
<dd>For form views, a preselected record in <tt class="docutils literal"><span class="pre">res_model</span></tt></dd>
<dt><tt class="docutils literal"><span class="pre">views</span></tt></dt>
<dd>Lists the views available through the action. A list of
<tt class="docutils literal"><span class="pre">[view_id,</span> <span class="pre">view_type]</span></tt>, <tt class="docutils literal"><span class="pre">view_id</span></tt> can either be the database identifier
of a view of the right type, or <tt class="docutils literal"><span class="pre">false</span></tt> to use the view by default for
the specified type. View types can not be present multiple times. The action
will open the first view of the list by default.</dd>
<dt><tt class="docutils literal"><span class="pre">target</span></tt></dt>
<dd>Either <tt class="docutils literal"><span class="pre">current</span></tt> (the default) which replaces the &#8220;content&#8221; section of the
web client by the action, or <tt class="docutils literal"><span class="pre">new</span></tt> to open the action in a dialog box.</dd>
<dt><tt class="docutils literal"><span class="pre">context</span></tt></dt>
<dd>Additional context data to use within the action.</dd>
</dl>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Jump to Product</p>
<p>Modify the <tt class="docutils literal"><span class="pre">PetToysList</span></tt> component so clicking on a toy replaces the
homepage by the toy&#8217;s form view.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s1">&#39;PetToysList&#39;</span><span class="p">,</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;click .oe_petstore_pettoy&#39;</span><span class="o">:</span> <span class="s1">&#39;selected_item&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">&#39;product.product&#39;</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">])</span>
            <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">&#39;categ_id.name&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="s2">&quot;Pet Toys&quot;</span><span class="p">]])</span>
            <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">all</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_</span><span class="p">(</span><span class="nx">results</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;PetToy&#39;</span><span class="p">,</span> <span class="p">{</span><span class="nx">item</span><span class="o">:</span> <span class="nx">item</span><span class="p">}));</span>
                <span class="p">});</span>
            <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">selected_item</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">do_action</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;ir.actions.act_window&#39;</span><span class="p">,</span>
            <span class="nx">res_model</span><span class="o">:</span> <span class="s1">&#39;product.product&#39;</span><span class="p">,</span>
            <span class="nx">res_id</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span>
            <span class="nx">views</span><span class="o">:</span> <span class="p">[[</span><span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">]],</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="last highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;PetToy&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_petstore_pettoy&quot;</span> <span class="na">t-att-data-id=</span><span class="s">&quot;item.id&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">&quot;item.name&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;&lt;img</span> <span class="na">t-attf-src=</span><span class="s">&quot;data:image/jpg;base64,{{item.image}}&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="client-actions">
<h3>Client Actions</h3>
<p>Throughout this guide, we used a simple <tt class="docutils literal"><span class="pre">HomePage</span></tt> widget which the web
client automatically starts when we select the right menu item. But how did
the Odoo web know to start this widget? Because the widget is registered as
a <em>client action</em>.</p>
<p>A client action is (as its name implies) an action type defined almost
entirely in the client, in javascript for Odoo web. The server simply sends
an action tag (an arbitrary name), and optionally adds a few parameters, but
beyond that <em>everything</em> is handled by custom client code.</p>
<p>Our widget is registered as the handler for the client action through this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;petstore.homepage&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.HomePage&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">instance.web.client_actions</span></tt> is a <tt class="xref js js-class docutils literal"><span class="pre">Registry()</span></tt> in which
the action manager looks up client action handlers when it needs to execute
one. The first parameter of <tt class="xref js js-class docutils literal"><span class="pre">add()</span></tt> is the name
(tag) of the client action, and the second parameter is the path to the widget
from the Odoo web client root.</p>
<p>When a client action must be executed, the action manager looks up its tag
in the registry, walks the specified path and displays the widget it finds at
the end.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">a client action handler can also be a regular function, in whch case
it&#8217;ll be called and its result (if any) will be interpreted as the
next action to execute.</p>
</div>
<p>On the server side, we had simply defined an <tt class="docutils literal"><span class="pre">ir.actions.client</span></tt> action:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;action_home_page&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.actions.client&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;tag&quot;</span><span class="nt">&gt;</span>petstore.homepage<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<p>and a menu opening the action:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;home_page_petstore_menu&quot;</span> <span class="na">parent=</span><span class="s">&quot;petstore_menu&quot;</span>
          <span class="na">name=</span><span class="s">&quot;Home Page&quot;</span> <span class="na">action=</span><span class="s">&quot;action_home_page&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="architecture-of-the-views">
<h3>Architecture of the Views</h3>
<p>Much of Odoo web&#8217;s usefulness (and complexity) resides in views. Each view
type is a way of displaying a model in the client.</p>
<div class="section" id="the-view-manager">
<h4>The View Manager</h4>
<p>When an <tt class="docutils literal"><span class="pre">ActionManager</span></tt> instance receive an action of type
<tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt>, it delegates the synchronization and handling of
the views themselves to a <em>view manager</em>, which will then set up one or
multiple views depending on the original action&#8217;s requirements:</p>
<a class="reference internal image-reference" href="viewarchitecture.svg" tppabs="https://www.odoo.com/documentation/8.0/_images/viewarchitecture.svg"><div align="center" class="align-center"><img src="viewarchitecture.svg" tppabs="https://www.odoo.com/documentation/8.0/_images/viewarchitecture.svg" width="40%" /></div>
</a>
</div>
<div class="section" id="the-views">
<h4>The Views</h4>
<p>Most <a class="reference internal" href="views.html#reference-views" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#reference-views"><em>Odoo views</em></a> are implemented through a subclass
of <tt class="xref js js-class docutils literal"><span class="pre">openerp.web.View()</span></tt> which provides a bit of generic basic structure
for handling events and displaying model information.</p>
<p>The <em>search view</em> is considered a view type by the main Odoo framework, but
handled separately by the web client (as it&#8217;s a more permanent fixture and
can interact with other views, which regular views don&#8217;t do).</p>
<p>A view is responsible for loading its own description XML (using
<a class="reference internal" href="orm.html#openerp.models.Model.fields_view_get" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model.fields_view_get" title="openerp.models.Model.fields_view_get"><tt class="xref py py-class docutils literal"><span class="pre">fields_view_get</span></tt></a>) and any other data source
it needs. To that purpose, views are provided with an optional view
identifier set as the <tt class="xref js js-attr docutils literal"><span class="pre">view_id</span></tt> attribute.</p>
<p>Views are also provided with a <tt class="xref js js-class docutils literal"><span class="pre">DataSet()</span></tt> instance which
holds most necessary model information (the model name and possibly various
record ids).</p>
<p>Views may also want to handle search queries by overriding
<tt class="xref js js-func docutils literal"><span class="pre">do_search()</span></tt>, and updating their
<tt class="xref js js-class docutils literal"><span class="pre">DataSet()</span></tt> as necessary.</p>
</div>
</div>
<div class="section" id="the-form-view-fields">
<h3>The Form View Fields</h3>
<p>A common Odoo web need is the extension of the form view to add new ways of
displaying form fields.</p>
<p>All built-in fields have a default display implementation, creating a new
form widget may be necessary to correctly interact with a new field type
(e.g. a <a class="reference internal" href="glossary.html#term-gis" tppabs="https://www.odoo.com/documentation/8.0/glossary.html#term-gis"><em class="xref std std-term">GIS</em></a> field) or to provide new representations and ways to
interact with existing field types (e.g. validate
<a class="reference internal" href="orm.html#openerp.fields.Char" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Char" title="openerp.fields.Char"><tt class="xref py py-class docutils literal"><span class="pre">Char</span></tt></a> fields which should contain email addresses
and display them as email links).</p>
<p>To explicitly specify which form widget should be used to display a field,
simply use the <tt class="docutils literal"><span class="pre">widget</span></tt> attribute in the view&#8217;s XML description:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;contact_mail&quot;</span> <span class="na">widget=</span><span class="s">&quot;email&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>the same widget is used in both &#8220;view&#8221; (read-only) and &#8220;edition&#8221; modes
of a form view, it&#8217;s not possible to use a widget in one and an other
widget in the other</li>
<li>and a given field (name) can not be used multiple times in the same form</li>
<li>a widget may ignore the current mode of the form view and remain the
same in both view and edition</li>
</ul>
</div>
<p>Fields are instantiated by the form view after it has read its XML description
and constructed the corresponding HTML representing that description. After
that, the form view will communicate with the field objects using some
methods. Theses methods are defined by the <tt class="docutils literal"><span class="pre">FieldInterface</span></tt>
interface. Almost all fields inherit the <tt class="docutils literal"><span class="pre">AbstractField</span></tt> abstract
class. That class defines some default mechanisms that need to be implemented
by most fields.</p>
<p>Here are some of the responsibilities of a field class:</p>
<ul class="simple">
<li>The field class must display and allow the user to edit the value of the field.</li>
<li>It must correctly implement the 3 field attributes available in all fields
of Odoo. The <tt class="docutils literal"><span class="pre">AbstractField</span></tt> class already implements an algorithm that
dynamically calculates the value of these attributes (they can change at any
moment because their value change according to the value of other
fields). Their values are stored in <em>Widget Properties</em> (the widget
properties were explained earlier in this guide). It is the responsibility
of each field class to check these widget properties and dynamically adapt
depending of their values. Here is a description of each of these
attributes:<ul>
<li><tt class="docutils literal"><span class="pre">required</span></tt>: The field must have a value before saving. If <tt class="docutils literal"><span class="pre">required</span></tt>
is <tt class="docutils literal"><span class="pre">true</span></tt> and the field doesn&#8217;t have a value, the method
<tt class="docutils literal"><span class="pre">is_valid()</span></tt> of the field must return <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">invisible</span></tt>: When this is <tt class="docutils literal"><span class="pre">true</span></tt>, the field must be invisible. The
<tt class="docutils literal"><span class="pre">AbstractField</span></tt> class already has a basic implementation of this
behavior that fits most fields.</li>
<li><tt class="docutils literal"><span class="pre">readonly</span></tt>: When <tt class="docutils literal"><span class="pre">true</span></tt>, the field must not be editable by the
user. Most fields in Odoo have a completely different behavior depending
on the value of <tt class="docutils literal"><span class="pre">readonly</span></tt>. As example, the <tt class="docutils literal"><span class="pre">FieldChar</span></tt> displays an
HTML <tt class="docutils literal"><span class="pre">&lt;input&gt;</span></tt> when it is editable and simply displays the text when
it is read-only. This also means it has much more code it would need to
implement only one behavior, but this is necessary to ensure a good user
experience.</li>
</ul>
</li>
<li>Fields have two methods, <tt class="docutils literal"><span class="pre">set_value()</span></tt> and <tt class="docutils literal"><span class="pre">get_value()</span></tt>, which are
called by the form view to give it the value to display and get back the new
value entered by the user. These methods must be able to handle the value as
given by the Odoo server when a <tt class="docutils literal"><span class="pre">read()</span></tt> is performed on a model and give
back a valid value for a <tt class="docutils literal"><span class="pre">write()</span></tt>.  Remember that the JavaScript/Python
data types used to represent the values given by <tt class="docutils literal"><span class="pre">read()</span></tt> and given to
<tt class="docutils literal"><span class="pre">write()</span></tt> is not necessarily the same in Odoo. As example, when you read a
many2one, it is always a tuple whose first value is the id of the pointed
record and the second one is the name get (ie: <tt class="docutils literal"><span class="pre">(15,</span> <span class="pre">&quot;Agrolait&quot;)</span></tt>). But
when you write a many2one it must be a single integer, not a tuple
anymore. <tt class="docutils literal"><span class="pre">AbstractField</span></tt> has a default implementation of these methods
that works well for simple data type and set a widget property named
<tt class="docutils literal"><span class="pre">value</span></tt>.</li>
</ul>
<p>Please note that, to better understand how to implement fields, you are
strongly encouraged to look at the definition of the <tt class="docutils literal"><span class="pre">FieldInterface</span></tt>
interface and the <tt class="docutils literal"><span class="pre">AbstractField</span></tt> class directly in the code of the Odoo web
client.</p>
<div class="section" id="creating-a-new-type-of-field">
<h4>Creating a New Type of Field</h4>
<p>In this part we will explain how to create a new type of field. The example
here will be to re-implement the <tt class="docutils literal"><span class="pre">FieldChar</span></tt> class and explain progressively
each part.</p>
<div class="section" id="simple-read-only-field">
<h5>Simple Read-Only Field</h5>
<p>Here is a first implementation that will only be able to display a text. The
user will not be able to modify the content of the field.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;char2&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.FieldChar2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>In this example, we declare a class named <tt class="docutils literal"><span class="pre">FieldChar2</span></tt> inheriting from
<tt class="docutils literal"><span class="pre">AbstractField</span></tt>. We also register this class in the registry
<tt class="docutils literal"><span class="pre">instance.web.form.widgets</span></tt> under the key <tt class="docutils literal"><span class="pre">char2</span></tt>. That will allow us to
use this new field in any form view by specifying <tt class="docutils literal"><span class="pre">widget=&quot;char2&quot;</span></tt> in the
<tt class="docutils literal"><span class="pre">&lt;field/&gt;</span></tt> tag in the XML declaration of the view.</p>
<p>In this example, we define a single method: <tt class="docutils literal"><span class="pre">render_value()</span></tt>. All it does is
display the widget property <tt class="docutils literal"><span class="pre">value</span></tt>.  Those are two tools defined by the
<tt class="docutils literal"><span class="pre">AbstractField</span></tt> class. As explained before, the form view will call the
method <tt class="docutils literal"><span class="pre">set_value()</span></tt> of the field to set the value to display. This method
already has a default implementation in <tt class="docutils literal"><span class="pre">AbstractField</span></tt> which simply sets
the widget property <tt class="docutils literal"><span class="pre">value</span></tt>. <tt class="docutils literal"><span class="pre">AbstractField</span></tt> also watch the
<tt class="docutils literal"><span class="pre">change:value</span></tt> event on itself and calls the <tt class="docutils literal"><span class="pre">render_value()</span></tt> when it
occurs. So, <tt class="docutils literal"><span class="pre">render_value()</span></tt> is a convenience method to implement in child
classes to perform some operation each time the value of the field changes.</p>
<p>In the <tt class="docutils literal"><span class="pre">init()</span></tt> method, we also define the default value of the field if
none is specified by the form view (here we assume the default value of a
<tt class="docutils literal"><span class="pre">char</span></tt> field should be an empty string).</p>
</div>
<div class="section" id="read-write-field">
<h5>Read-Write Field</h5>
<p>Fields that only display their content and don&#8217;t give the possibility to the
user to modify it can be useful, but most fields in Odoo allow edition
too. This makes the field classes more complicated, mostly because fields are
supposed to handle both and editable and non-editable mode, those modes are
often completely different (for design and usability purpose) and the fields
must be able to switch from one mode to another at any moment.</p>
<p>To know in which mode the current field should be, the <tt class="docutils literal"><span class="pre">AbstractField</span></tt> class
sets a widget property named <tt class="docutils literal"><span class="pre">effective_readonly</span></tt>. The field should watch
the changes in that widget property and display the correct mode
accordingly. Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:effective_readonly&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render_value</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_field</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;FieldChar2&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">widget</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">internal_set_value</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;char2&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.FieldChar2&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;FieldChar2&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_field_char2&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;! widget.get(&#39;effective_readonly&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>In the <tt class="docutils literal"><span class="pre">start()</span></tt> method (which is called right after a widget has been
appended to the DOM), we bind on the event <tt class="docutils literal"><span class="pre">change:effective_readonly</span></tt>. That
will allow use to redisplay the field each time the widget property
<tt class="docutils literal"><span class="pre">effective_readonly</span></tt> changes. This event handler will call
<tt class="docutils literal"><span class="pre">display_field()</span></tt>, which is also called directly in <tt class="docutils literal"><span class="pre">start()</span></tt>. This
<tt class="docutils literal"><span class="pre">display_field()</span></tt> was created specifically for this field, it&#8217;s not a method
defined in <tt class="docutils literal"><span class="pre">AbstractField</span></tt> or any other class. This is the method we will
use to display the content of the field depending we are in read-only mode or
not.</p>
<p>From now on the conception of this field is quite typical, except there is a
lot of verifications to know the state of the <tt class="docutils literal"><span class="pre">effective_readonly</span></tt> property:</p>
<ul class="simple">
<li>In the QWeb template used to display the content of the widget, it displays
an <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;text&quot;</span> <span class="pre">/&gt;</span></tt> if we are in read-write mode and nothing in
particular in read-only mode.</li>
<li>In the <tt class="docutils literal"><span class="pre">display_field()</span></tt> method, we have to bind on the <tt class="docutils literal"><span class="pre">change</span></tt> event
of the <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;text&quot;</span> <span class="pre">/&gt;</span></tt> to know when the user has changed the
value. When it happens, we call the <tt class="docutils literal"><span class="pre">internal_set_value()</span></tt> method with the
new value of the field. This is a convenience method provided by the
<tt class="docutils literal"><span class="pre">AbstractField</span></tt> class. That method will set a new value in the <tt class="docutils literal"><span class="pre">value</span></tt>
property but will not trigger a call to <tt class="docutils literal"><span class="pre">render_value()</span></tt> (which is not
necessary since the <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;text&quot;</span> <span class="pre">/&gt;</span></tt> already contains the correct
value).</li>
<li>In <tt class="docutils literal"><span class="pre">render_value()</span></tt>, we use a completely different code to display the
value of the field depending if we are in read-only or in read-write mode.</li>
</ul>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Create a Color Field</p>
<p>Create a <tt class="docutils literal"><span class="pre">FieldColor</span></tt> class. The value of this field should be a string
containing a color code like those used in CSS (example: <tt class="docutils literal"><span class="pre">#FF0000</span></tt> for
red). In read-only mode, this color field should display a little block
whose color corresponds to the value of the field. In read-write mode, you
should display an <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;color&quot;</span> <span class="pre">/&gt;</span></tt>. That type of <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">/&gt;</span></tt>
is an HTML5 component that doesn&#8217;t work in all browsers but works well in
Google Chrome. So it&#8217;s OK to use as an exercise.</p>
<p>You can use that widget in the form view of the <tt class="docutils literal"><span class="pre">message_of_the_day</span></tt>
model for its field named <tt class="docutils literal"><span class="pre">color</span></tt>. As a bonus, you can change the
<tt class="docutils literal"><span class="pre">MessageOfTheDay</span></tt> widget created in the previous part of this guide to
display the message of the day with the background color indicated in the
<tt class="docutils literal"><span class="pre">color</span></tt> field.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldColor</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;change input&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;effective_readonly&#39;</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">internal_set_value</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:effective_readonly&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render_value</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_field</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;FieldColor&quot;</span><span class="p">,</span> <span class="p">{</span><span class="nx">widget</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;.oe_field_color_content&quot;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">&quot;background-color&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="s2">&quot;#FFFFFF&quot;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.FieldColor&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;FieldColor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_field_color&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;widget.get(&#39;effective_readonly&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_field_color_content&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">&quot;! widget.get(&#39;effective_readonly&#39;)&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;color&quot;</span><span class="nt">&gt;&lt;/input&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<div class="last highlight-css"><div class="highlight"><pre><span class="nc">.oe_field_color_content</span> <span class="p">{</span>
    <span class="k">height</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="k">width</span><span class="o">:</span> <span class="m">50px</span><span class="p">;</span>
    <span class="k">border</span><span class="o">:</span> <span class="m">1px</span> <span class="k">solid</span> <span class="nb">black</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="the-form-view-custom-widgets">
<h3>The Form View Custom Widgets</h3>
<p>Form fields are used to edit a single field, and are intrinsically linked to
a field. Because this may be limiting, it is also possible to create
<em>form widgets</em> which are not so restricted and have less ties to a specific
lifecycle.</p>
<p>Custom form widgets can be added to a form view through the <tt class="docutils literal"><span class="pre">widget</span></tt> tag:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;widget</span> <span class="na">type=</span><span class="s">&quot;xxx&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>This type of widget will simply be created by the form view during the
creation of the HTML according to the XML definition. They have properties in
common with the fields (like the <tt class="docutils literal"><span class="pre">effective_readonly</span></tt> property) but they are
not assigned a precise field. And so they don&#8217;t have methods like
<tt class="docutils literal"><span class="pre">get_value()</span></tt> and <tt class="docutils literal"><span class="pre">set_value()</span></tt>. They must inherit from the <tt class="docutils literal"><span class="pre">FormWidget</span></tt>
abstract class.</p>
<p>Form widgets can interact with form fields by listening for their changes and
fetching or altering their values. They can access form fields through
their <tt class="xref js js-attr docutils literal"><span class="pre">field_manager</span></tt> attribute:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetMultiplication</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:integer_a&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:integer_b&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_result</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;integer_a&quot;</span><span class="p">)</span> <span class="o">*</span>
                     <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;integer_b&quot;</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">&quot;a*b = &quot;</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;multiplication&#39;</span><span class="p">,</span> <span class="s1">&#39;instance.oepetstore.WidgetMultiplication&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p><tt class="xref js js-attr docutils literal"><span class="pre">FormWidget</span></tt> is generally the
<tt class="xref js js-class docutils literal"><span class="pre">FormView()</span></tt> itself, but features used from it should
be limited to those defined by <tt class="xref js js-class docutils literal"><span class="pre">FieldManagerMixin()</span></tt>,
the most useful being:</p>
<ul class="simple">
<li><tt class="xref js js-func docutils literal"><span class="pre">get_field_value(field_name)()</span></tt>
which returns the value of a field.</li>
<li><tt class="xref js js-func docutils literal"><span class="pre">set_values(values)()</span></tt> sets multiple
field values, takes a mapping of <tt class="docutils literal"><span class="pre">{field_name:</span> <span class="pre">value_to_set}</span></tt></li>
<li>An event <tt class="samp docutils literal"><span class="pre">field_changed:</span><em><span class="pre">field_name</span></em></tt> is triggered any time the value
of the field called <tt class="docutils literal"><span class="pre">field_name</span></tt> is changed</li>
</ul>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Show Coordinates on Google Map</p>
<p>Add two fields to <tt class="docutils literal"><span class="pre">product.product</span></tt> storing a latitude and a longitude,
then create a new form widget to display the latitude and longitude of
a product&#8217;s origin on a map</p>
<p>To display the map, use Google Map&#8217;s embedding:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">&quot;400&quot;</span> <span class="na">height=</span><span class="s">&quot;300&quot;</span> <span class="na">src=</span><span class="s">&quot;https://maps.google.com/?ie=UTF8&amp;amp;ll=XXX,YYY&amp;amp;output=embed&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/iframe&gt;</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">XXX</span></tt> should be replaced by the latitude and <tt class="docutils literal"><span class="pre">YYY</span></tt> by the
longitude.</p>
<p>Display the two position fields and a map widget using them in a new
notebook page of the product&#8217;s form view.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetCoordinates</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:provider_latitude&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:provider_longitude&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_map</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;WidgetCoordinates&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;provider_latitude&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;provider_longitude&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">}));</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;local.WidgetCoordinates&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="last highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;WidgetCoordinates&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">&quot;400&quot;</span> <span class="na">height=</span><span class="s">&quot;300&quot;</span>
        <span class="na">t-attf-src=</span><span class="s">&quot;https://maps.google.com/?ie=UTF8&amp;amp;ll={{latitude}},{{longitude}}&amp;amp;output=embed&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/iframe&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Get the Current Coordinate</p>
<p>Add a button resetting the product&#8217;s coordinates to the location of the
user, you can get these coordinates using the
<a class="reference external" href="javascript:if(confirm('http://diveintohtml5.info/geolocation.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://diveintohtml5.info/geolocation.html'" tppabs="http://diveintohtml5.info/geolocation.html">javascript geolocation API</a>.</p>
<p>Now we would like to display an additional button to automatically set the
coordinates to the location of the current user.</p>
<p>To get the coordinates of the user, an easy way is to use the geolocation
JavaScript API.  <a class="reference external" href="javascript:if(confirm('http://www.w3schools.com/html/html5_geolocation.asp  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.w3schools.com/html/html5_geolocation.asp'" tppabs="http://www.w3schools.com/html/html5_geolocation.asp">See the online documentation to know how to use it</a>.</p>
<p>Please also note that it wouldn&#8217;t be very logical to allow the user to
click on that button when the form view is in read-only mode. So, this
custom widget should handle correctly the <tt class="docutils literal"><span class="pre">effective_readonly</span></tt> property
just like any field. One way to do this would be to make the button
disappear when <tt class="docutils literal"><span class="pre">effective_readonly</span></tt> is true.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetCoordinates</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">&#39;click button&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span><span class="s1">&#39;received_position&#39;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">sup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:provider_latitude&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;field_changed:provider_longitude&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">&quot;change:effective_readonly&quot;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">sup</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">display_map</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">&quot;WidgetCoordinates&quot;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">&quot;latitude&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;provider_latitude&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;longitude&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">&quot;provider_longitude&quot;</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">}));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">).</span><span class="nx">toggle</span><span class="p">(</span><span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;effective_readonly&quot;</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">received_position</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">set_values</span><span class="p">({</span>
            <span class="s2">&quot;provider_latitude&quot;</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>
            <span class="s2">&quot;provider_longitude&quot;</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">,</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;coordinates&#39;</span><span class="p">,</span> <span class="s1">&#39;local.WidgetCoordinates&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="last highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;WidgetCoordinates&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">&quot;400&quot;</span> <span class="na">height=</span><span class="s">&quot;300&quot;</span>
        <span class="na">t-att-src=</span><span class="s">&quot;https://maps.google.com/?ie=UTF8&amp;amp;ll={{latitude}},{{longitude}}&amp;amp;output=embed&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/iframe&gt;</span>
    <span class="nt">&lt;button&gt;</span>Get My Current Coordinate<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>as a separate concept from instances. In many languages classes
are full-fledged objects and themselves instance (of
metaclasses) but there remains two fairly separate hierarchies
between classes and instances</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="dombugs" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>as well as papering over cross-browser differences, although
this has become less necessary over time</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
    <div class="footer">
      <div class="container">
        <ul class="docs-footer-links muted">
            <li>
                &copy; Copyright <a href="javascript:if(confirm('https://odoo.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://odoo.com/'" tppabs="https://odoo.com/">Odoo S.A.</a>.
            </li><li>路</li>
            <li>Created using <a href="javascript:if(confirm('http://sphinx-doc.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://sphinx-doc.org/'" tppabs="http://sphinx-doc.org/">Sphinx</a> 1.2.2.</li>
        </ul>
      <p>
        odoo docs theme based on <a href="javascript:if(confirm('http://getbootstrap.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://getbootstrap.com/'" tppabs="http://getbootstrap.com/">Bootstrap
        3.2 documentation</a> adapted to
        <a href="javascript:if(confirm('http://sphinx-doc.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://sphinx-doc.org/'" tppabs="http://sphinx-doc.org/">Sphinx</a> output with branding and
        color changes.
      </p>
      </div>
    </div><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','analytics.js'/*tpa=https://www.google-analytics.com/analytics.js*/,'ga');

    ga('create', 'UA-52174891-1', 'auto');
    ga('send','pageview');
    </script>
  </body>
</html>