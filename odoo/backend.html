<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>Building a Module &mdash; odoo 8.0 documentation</title>
    
    <link rel="stylesheet" href="odoo.css" tppabs="https://www.odoo.com/documentation/8.0/_static/odoo.css" type="text/css" />
    <link rel="stylesheet" href="pygments.css" tppabs="https://www.odoo.com/documentation/8.0/_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="patchqueue.css" tppabs="https://www.odoo.com/documentation/8.0/_static/patchqueue.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="jquery.js" tppabs="https://www.odoo.com/documentation/8.0/_static/jquery.js"></script>
    <script type="text/javascript" src="underscore.js" tppabs="https://www.odoo.com/documentation/8.0/_static/underscore.js"></script>
    <script type="text/javascript" src="doctools.js" tppabs="https://www.odoo.com/documentation/8.0/_static/doctools.js"></script>
    <script type="text/javascript" src="patchqueue.js" tppabs="https://www.odoo.com/documentation/8.0/_static/patchqueue.js"></script>
    <script type="text/javascript" src="scrollspy.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/scrollspy.js"></script>
    <script type="text/javascript" src="affix.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/affix.js"></script>
    <script type="text/javascript" src="tooltip.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/tooltip.js"></script>
    <script type="text/javascript" src="collapse.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/collapse.js"></script>
    <script type="text/javascript" src="dropdown.js" tppabs="https://www.odoo.com/documentation/8.0/_static/bootstrap/js/dropdown.js"></script>
    <script type="text/javascript" src="ZeroClipboard.min.js" tppabs="https://www.odoo.com/documentation/8.0/_static/zeroclipboard-2.1.6/ZeroClipboard.min.js"></script>
    <script type="text/javascript" src="app.js" tppabs="https://www.odoo.com/documentation/8.0/_static/app.js"></script>
    <link rel="top" title="odoo 8.0 documentation" href="../index.html" />
    <link rel="up" title="Tutorials" href="../tutorials.html" />
    <link rel="next" title="Building Themes" href="themes.html" />
    <link rel="prev" title="Building a Website" href="website.html" /><link rel="canonical" href="https://www.odoo.com/documentation/8.0/howtos/backend.html"/>
  </head>
  <body><header class="navbar navbar-default navbar-static-top docs-nav" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-main">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="index.html" tppabs="https://www.odoo.com/documentation/8.0/index.html" class="o_logo navbar-brand">
        <span class="o_logo_main">odoo</span><span class="o_logo_app">doc</span>
      </a>
      
        <div class="versions navbar-brand">
          <a class="dropdown-toggle" data-toggle="dropdown">
            8.0 <span class="caret"></span>
          </a>
          <ul class="dropdown-menu" role="menu">
            
              <li><a href="javascript:if(confirm('https://www.odoo.com/documentation/master/howtos/backend.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://www.odoo.com/documentation/master/howtos/backend.html'" tppabs="https://www.odoo.com/documentation/master/howtos/backend.html">master</a></li>
            
          </ul>
        </div>
      
    </div>
    <nav class="collapse navbar-collapse navbar-main" role="navigation">
      <ul class="current nav navbar-nav navbar-right">
<li class="toctree-l1 current dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="tutorials.html" tppabs="https://www.odoo.com/documentation/8.0/tutorials.html">Tutorials</a><ul class="current dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="website.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html">Building a Website</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Building a Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="themes.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html">Building Themes</a></li>
<li class="toctree-l2"><a class="reference internal" href="web.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html">Building Interface Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="setup.html" tppabs="https://www.odoo.com/documentation/8.0/setup.html">Setting Up</a><ul class="dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="install.html" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html">Installing Odoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html">Deploying Odoo</a></li>
</ul>
</li>
<li class="toctree-l1 dropdown"><a class="dropdown-toggle reference internal" data-toggle="dropdown" href="reference.html" tppabs="https://www.odoo.com/documentation/8.0/reference.html">Reference</a><ul class="dropdown-menu">
<li class="toctree-l2"><a class="reference internal" href="orm.html" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html">ORM</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html">Data Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions.html" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html">Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html">Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="module.html" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmdline.html" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html">Command-line interface: odoo.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html">Security in Odoo</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html">Testing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="http.html" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html">Web Controllers</a></li>
<li class="toctree-l2"><a class="reference internal" href="qweb.html" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html">QWeb</a></li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html">Javascript</a></li>
<li class="toctree-l2"><a class="reference internal" href="translations.html" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html">Translating Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="reports.html" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html">QWeb Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html">Workflows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_integration.html" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html">Web Service</a><ul class="simple">
</ul>
</li>
</ul>

    </nav>
  </div>
</header><div class="document-super ">
    

    <div class="document"><div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
      <ul class="current nav">
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html" tppabs="https://www.odoo.com/documentation/8.0/tutorials.html">Tutorials</a><ul class="current nav">
<li class="toctree-l2"><a class="reference internal" href="website.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html">Building a Website</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="website.html#creating-a-basic-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#creating-a-basic-module">Creating a basic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#a-demonstration-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#a-demonstration-module">A demonstration module</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#to-the-browser" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#to-the-browser">To the browser</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#templates" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#templates">Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#storing-data-in-odoo" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#storing-data-in-odoo">Storing data in Odoo</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="website.html#defining-the-data-model" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#defining-the-data-model">Defining the data model</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#demonstration-data" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#demonstration-data">Demonstration data</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#accessing-the-data" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#accessing-the-data">Accessing the data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="website.html#website-support" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#website-support">Website support</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#urls-and-routing" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#urls-and-routing">URLs and routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#field-edition" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#field-edition">Field edition</a></li>
<li class="toctree-l3"><a class="reference internal" href="website.html#administration-and-erp-integration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#administration-and-erp-integration">Administration and ERP integration</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="website.html#a-brief-and-incomplete-introduction-to-the-odoo-administration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#a-brief-and-incomplete-introduction-to-the-odoo-administration">A brief and incomplete introduction to the Odoo administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#editing-in-the-odoo-administration" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#editing-in-the-odoo-administration">Editing in the Odoo administration</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#relations-between-models" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#relations-between-models">Relations between models</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#discussions-and-notifications" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#discussions-and-notifications">Discussions and notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#selling-courses" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#selling-courses">Selling courses</a></li>
<li class="toctree-l4"><a class="reference internal" href="website.html#altering-existing-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/website.html#altering-existing-views">Altering existing views</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Building a Module</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="#start-stop-the-odoo-server">Start/Stop the Odoo server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-an-odoo-module">Build an Odoo module</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#composition-of-a-module">Composition of a module</a></li>
<li class="toctree-l4"><a class="reference internal" href="#module-structure">Module structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#object-relational-mapping">Object-Relational Mapping</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model-fields">Model fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-files">Data files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#actions-and-menus">Actions and Menus</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#basic-views">Basic views</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#generic-view-declaration">Generic view declaration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tree-views">Tree views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#form-views">Form views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search-views">Search views</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#relations-between-models">Relations between models</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#relational-fields">Relational fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#inheritance">Inheritance</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#model-inheritance">Model inheritance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-inheritance">View inheritance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#computed-fields-and-default-values">Computed fields and default values</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-values">Default values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#onchange">Onchange</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-constraints">Model constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-views">Advanced Views</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#id3">Tree views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calendars">Calendars</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Search views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gantt">Gantt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#graph-views">Graph views</a></li>
<li class="toctree-l4"><a class="reference internal" href="#kanban">Kanban</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#workflows">Workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#security">Security</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#group-based-access-control-mechanisms">Group-based access control mechanisms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-rights">Access rights</a></li>
<li class="toctree-l4"><a class="reference internal" href="#record-rules">Record rules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wizards">Wizards</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#launching-wizards">Launching wizards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#internationalization">Internationalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reporting">Reporting</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#printed-reports">Printed reports</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dashboards">Dashboards</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#webservices">WebServices</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="#xml-rpc-library">XML-RPC Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="#json-rpc-library">JSON-RPC Library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="themes.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html">Building Themes</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="themes.html#basic-set-up" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#basic-set-up">Basic set up</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#static-page" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#static-page">Static Page</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#pimp-your-theme" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#pimp-your-theme">Pimp Your Theme</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#build-your-first-snippet" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#build-your-first-snippet">Build Your First Snippet</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="themes.html#advanced-customization" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#advanced-customization">Advanced Customization</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#defining-your-theme-options" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#defining-your-theme-options">Defining Your Theme Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="themes.html#the-image-database" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#the-image-database">The Image Database</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="themes.html#theme-selector" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#theme-selector">Theme Selector</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="themes.html#set-up" tppabs="https://www.odoo.com/documentation/8.0/howtos/themes.html#set-up">Set Up</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="web.html" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html">Building Interface Extensions</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="web.html#a-simple-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#a-simple-module">A Simple Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#odoo-javascript-module" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#odoo-javascript-module">Odoo JavaScript Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#classes" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#widgets-basics" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#widgets-basics">Widgets Basics</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#your-first-widget" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#your-first-widget">Your First Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#display-content" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#display-content">Display Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#widget-parents-and-children" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#widget-parents-and-children">Widget Parents and Children</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#destroying-widgets" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#destroying-widgets">Destroying Widgets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="web.html#the-qweb-template-engine" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#the-qweb-template-engine">The QWeb Template Engine</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#using-qweb" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#using-qweb">Using QWeb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="web.html#widget-helpers" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#widget-helpers">Widget Helpers</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#widget-s-jquery-selector" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#widget-s-jquery-selector"><tt class="docutils literal"><span class="pre">Widget</span></tt>&#8216;s jQuery Selector</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#easier-dom-events-binding" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#easier-dom-events-binding">Easier DOM Events Binding</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="web.html#widget-events-and-properties" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#widget-events-and-properties">Widget Events and Properties</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#events" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#events">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#properties" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#id3" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#id3">Exercise</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="web.html#modify-existing-widgets-and-classes" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#modify-existing-widgets-and-classes">Modify existing widgets and classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#translations" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#translations">Translations</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#communication-with-the-odoo-server" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#communication-with-the-odoo-server">Communication with the Odoo Server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#contacting-models" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#contacting-models">Contacting Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#compoundcontext" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#compoundcontext">CompoundContext</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#queries" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#queries">Queries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="web.html#exercises" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#exercises">Exercises</a></li>
<li class="toctree-l3"><a class="reference internal" href="web.html#existing-web-components" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#existing-web-components">Existing web components</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="web.html#the-action-manager" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#the-action-manager">The Action Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#client-actions" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#client-actions">Client Actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#architecture-of-the-views" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#architecture-of-the-views">Architecture of the Views</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#the-form-view-fields" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#the-form-view-fields">The Form View Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="web.html#the-form-view-custom-widgets" tppabs="https://www.odoo.com/documentation/8.0/howtos/web.html#the-form-view-custom-widgets">The Form View Custom Widgets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup.html" tppabs="https://www.odoo.com/documentation/8.0/setup.html">Setting Up</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="install.html" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html">Installing Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="install.html#demo" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#demo">Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#saas" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#saas">SaaS</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#packaged-installers" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#packaged-installers">Packaged installers</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="install.html#windows" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#windows">Windows</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#deb" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#deb">Deb</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#rpm" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#rpm">RPM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install.html#source-install" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#source-install">Source Install</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="install.html#installing-dependencies" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#installing-dependencies">Installing dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="install.html#running-odoo" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#running-odoo">Running Odoo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="deploy.html" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html">Deploying Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="deploy.html#dbfilter" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#dbfilter">dbfilter</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#postgresql" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#postgresql">PostgreSQL</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#configuring-odoo" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#configuring-odoo">Configuring Odoo</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#https" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#https">HTTPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#builtin-server" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#builtin-server">Builtin server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#livechat" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#livechat">LiveChat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#odoo-as-a-wsgi-application" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#odoo-as-a-wsgi-application">Odoo as a WSGI Application</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#cron-workers" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#cron-workers">Cron Workers</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploy.html#id4" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#id4">LiveChat</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#serving-static-files" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#serving-static-files">Serving Static Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="deploy.html#security" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#security">Security</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="deploy.html#super-admin-password" tppabs="https://www.odoo.com/documentation/8.0/setup/deploy.html#super-admin-password">&#8220;Super-admin&#8221; password</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html" tppabs="https://www.odoo.com/documentation/8.0/reference.html">Reference</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="orm.html" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html">ORM</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="orm.html#recordsets" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#recordsets">Recordsets</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#field-access" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#field-access">Field access</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#set-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#set-operations">Set operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#other-recordset-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#other-recordset-operations">Other recordset operations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#environment" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#environment">Environment</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#altering-the-environment" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#altering-the-environment">Altering the environment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#common-orm-methods" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#common-orm-methods">Common ORM methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#creating-models" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#creating-models">Creating Models</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#computed-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#computed-fields">Computed fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#onchange-updating-ui-on-the-fly" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#onchange-updating-ui-on-the-fly">onchange: updating UI on the fly</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#low-level-sql" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#low-level-sql">Low-level SQL</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#old-api-compatibility" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#old-api-compatibility">Old API compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#model-reference" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#model-reference">Model Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#module-openerp.api" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#module-openerp.api">Method decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#fields">Fields</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#basic-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#basic-fields">Basic fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#relational-fields" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#relational-fields">Relational fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#inheritance-and-extension" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#inheritance-and-extension">Inheritance and extension</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#classical-inheritance" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#classical-inheritance">Classical inheritance</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#extension" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#extension">Extension</a></li>
<li class="toctree-l4"><a class="reference internal" href="orm.html#delegation" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#delegation">Delegation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#domains" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#domains">Domains</a></li>
<li class="toctree-l3"><a class="reference internal" href="orm.html#porting-from-the-old-api" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#porting-from-the-old-api">Porting from the old API</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="orm.html#automatic-bridging-of-old-api-methods" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#automatic-bridging-of-old-api-methods">Automatic bridging of old API methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html">Data Files</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="data.html#structure" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#structure">Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#core-operations" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#core-operations">Core operations</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="data.html#record" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#record"><tt class="docutils literal"><span class="pre">record</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#delete" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#delete"><tt class="docutils literal"><span class="pre">delete</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#function" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#function"><tt class="docutils literal"><span class="pre">function</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#workflow" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#workflow"><tt class="docutils literal"><span class="pre">workflow</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#shortcuts" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#shortcuts">Shortcuts</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="data.html#menuitem" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#menuitem"><tt class="docutils literal"><span class="pre">menuitem</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#template" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#template"><tt class="docutils literal"><span class="pre">template</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#report" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#report"><tt class="docutils literal"><span class="pre">report</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#csv-data-files" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#csv-data-files">CSV data files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="actions.html" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html">Actions</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="actions.html#window-actions-ir-actions-act-window" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#window-actions-ir-actions-act-window">Window Actions (<tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#url-actions-ir-actions-act-url" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#url-actions-ir-actions-act-url">URL Actions (<tt class="docutils literal"><span class="pre">ir.actions.act_url</span></tt>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#server-actions-ir-actions-server" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#server-actions-ir-actions-server">Server Actions (<tt class="docutils literal"><span class="pre">ir.actions.server</span></tt>)</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="actions.html#code" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#code"><tt class="docutils literal"><span class="pre">code</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#object-create" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#object-create"><tt class="docutils literal"><span class="pre">object_create</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#object-write" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#object-write"><tt class="docutils literal"><span class="pre">object_write</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#multi" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#multi"><tt class="docutils literal"><span class="pre">multi</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#trigger" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#trigger"><tt class="docutils literal"><span class="pre">trigger</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#client-action" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#client-action"><tt class="docutils literal"><span class="pre">client_action</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="actions.html#evaluation-context" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#evaluation-context">Evaluation context</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#report-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#report-actions">Report Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="actions.html#client-actions-ir-actions-client" tppabs="https://www.odoo.com/documentation/8.0/reference/actions.html#client-actions-ir-actions-client">Client Actions (<tt class="docutils literal"><span class="pre">ir.actions.client</span></tt>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="views.html" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html">Views</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="views.html#common-structure" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#common-structure">Common Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#inheritance" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#inheritance">Inheritance</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#view-matching" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#view-matching">View matching</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#view-resolution" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#view-resolution">View resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#inheritance-specs" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#inheritance-specs">Inheritance specs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#lists" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#forms" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#forms">Forms</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#structural-components" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#structural-components">Structural components</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#semantic-components" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#semantic-components">Semantic components</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#business-views-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#business-views-guidelines">Business Views guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#configuration-forms-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#configuration-forms-guidelines">Configuration forms guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#dialog-forms-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#dialog-forms-guidelines">Dialog forms guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="views.html#configuration-wizards-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#configuration-wizards-guidelines">Configuration Wizards guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#graphs" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#graphs">Graphs</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#kanban" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#kanban">Kanban</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#javascript-api" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#javascript-api">Javascript API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#calendar" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#calendar">Calendar</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#gantt" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#gantt">Gantt</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#diagram" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#diagram">Diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="views.html#search" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#search">Search</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="views.html#search-defaults" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#search-defaults">Search defaults</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="views.html#qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#qweb">QWeb</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="module.html" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html">Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="module.html#manifest" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html#manifest">Manifest</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cmdline.html" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html">Command-line interface: odoo.py</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#running-the-server" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#running-the-server">Running the server</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#database" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#database">database</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#built-in-http" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#built-in-http">built-in HTTP</a></li>
<li class="toctree-l4"><a class="reference internal" href="cmdline.html#logging" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#logging">logging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#scaffolding" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#scaffolding">Scaffolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmdline.html#configuration-file" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#configuration-file">Configuration file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="security.html" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html">Security in Odoo</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="security.html#access-control" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#access-control">Access Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#record-rules" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#record-rules">Record Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#field-access" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#field-access">Field Access</a></li>
<li class="toctree-l3"><a class="reference internal" href="security.html#workflow-transition-rules" tppabs="https://www.odoo.com/documentation/8.0/reference/security.html#workflow-transition-rules">Workflow transition rules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing.html" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html">Testing Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="testing.html#running-tests" tppabs="https://www.odoo.com/documentation/8.0/reference/testing.html#running-tests">Running tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="http.html" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html">Web Controllers</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="http.html#routing" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#routing">Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#request" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#request">Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#response" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#response">Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="http.html#controllers" tppabs="https://www.odoo.com/documentation/8.0/reference/http.html#controllers">Controllers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qweb.html" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html">QWeb</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="qweb.html#data-output" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#data-output">data output</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#conditionals" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#conditionals">conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#loops" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#loops">loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#attributes" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#attributes">attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#setting-variables" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#setting-variables">setting variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#calling-sub-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#calling-sub-templates">calling sub-templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#python" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#python">Python</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="qweb.html#exclusive-directives" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#exclusive-directives">Exclusive directives</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#helpers" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#helpers">Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#api" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="qweb.html#javascript" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#javascript">Javascript</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id3" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id3">Exclusive directives</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#debugging" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#debugging">debugging</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id4" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id4">Helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="qweb.html#id5" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#id5">API</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="javascript.html" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html">Javascript</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="javascript.html#widgets" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#widgets">Widgets</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-root" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-root">DOM Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-events-handling" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-events-handling">DOM events handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#subclassing-widget" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#subclassing-widget">Subclassing Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#development-guidelines" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#development-guidelines">Development Guidelines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#rpc" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#rpc">RPC</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#high-level-api-calling-into-odoo-models" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#high-level-api-calling-into-odoo-models">High-level API: calling into Odoo models</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#low-level-api-rpc-calls-to-python-side" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#low-level-api-rpc-calls-to-python-side">Low-level API: RPC calls to Python side</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#web-client" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#web-client">Web Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="javascript.html#testing-in-odoo-web-client" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#testing-in-odoo-web-client">Testing in Odoo Web Client</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="javascript.html#javascript-unit-testing" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#javascript-unit-testing">Javascript Unit Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#writing-a-test-case" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#writing-a-test-case">Writing a test case</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#assertions" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#assertions">Assertions</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#getting-an-odoo-instance" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#getting-an-odoo-instance">Getting an Odoo instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#dom-scratchpad" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#dom-scratchpad">DOM Scratchpad</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#loading-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#loading-templates">Loading templates</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#asynchronous-cases" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#asynchronous-cases">Asynchronous cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#id3" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#id3">RPC</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#testing-api" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#testing-api">Testing API</a></li>
<li class="toctree-l4"><a class="reference internal" href="javascript.html#running-through-python" tppabs="https://www.odoo.com/documentation/8.0/reference/javascript.html#running-through-python">Running through Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="translations.html" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html">Translating Modules</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="translations.html#exporting-translatable-term" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#exporting-translatable-term">Exporting translatable term</a></li>
<li class="toctree-l3"><a class="reference internal" href="translations.html#implicit-exports" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#implicit-exports">Implicit exports</a></li>
<li class="toctree-l3"><a class="reference internal" href="translations.html#explicit-exports" tppabs="https://www.odoo.com/documentation/8.0/reference/translations.html#explicit-exports">Explicit exports</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reports.html" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html">QWeb Reports</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="reports.html#paper-formats" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#paper-formats">Paper Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="reports.html#expressions-used-in-odoo-report-templates" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#expressions-used-in-odoo-report-templates">Expressions used in Odoo report templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="reports.html#custom-report" tppabs="https://www.odoo.com/documentation/8.0/reference/reports.html#custom-report">Custom report</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="workflows.html" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html">Workflows</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="workflows.html#basics" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#basics">Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="workflows.html#activities" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#activities">Activities</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="workflows.html#flow-start-and-flow-stop" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#flow-start-and-flow-stop">Flow start and flow stop</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#subflow" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#subflow">Subflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#sending-a-signal-from-a-subflow" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#sending-a-signal-from-a-subflow">Sending a signal from a subflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#server-actions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#server-actions">Server actions</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#python-action" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#python-action">Python action</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#split-mode" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#split-mode">Split mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#join-mode" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#join-mode">Join mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#kinds" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#kinds">Kinds</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="workflows.html#transitions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#transitions">Transitions</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="workflows.html#conditions" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#conditions">Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#signals" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#signals">Signals</a></li>
<li class="toctree-l4"><a class="reference internal" href="workflows.html#triggers" tppabs="https://www.odoo.com/documentation/8.0/reference/workflows.html#triggers">Triggers</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_integration.html" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html">Web Service</a><ul class="nav">
<li class="toctree-l2"><a class="reference internal" href="api_integration.html#connection" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#connection">Connection</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#configuration" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#logging-in" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#logging-in">Logging in</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api_integration.html#calling-methods" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#calling-methods">Calling methods</a><ul class="nav">
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#list-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#list-records">List records</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#pagination" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#pagination">Pagination</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#count-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#count-records">Count records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#read-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#read-records">Read records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#listing-record-fields" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#listing-record-fields">Listing record fields</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#search-and-read" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#search-and-read">Search and read</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#create-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#create-records">Create records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#update-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#update-records">Update records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#delete-records" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#delete-records">Delete records</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#inspection-and-introspection" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#inspection-and-introspection">Inspection and introspection</a><ul class="nav">
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#ir-model" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#ir-model"><tt class="docutils literal"><span class="pre">ir.model</span></tt></a></li>
<li class="toctree-l4"><a class="reference internal" href="api_integration.html#ir-model-fields" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#ir-model-fields"><tt class="docutils literal"><span class="pre">ir.model.fields</span></tt></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#workflow-manipulations" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#workflow-manipulations">Workflow manipulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="api_integration.html#report-printing" tppabs="https://www.odoo.com/documentation/8.0/api_integration.html#report-printing">Report printing</a></li>
</ul>
</li>
</ul>
</li>
</ul>

      
        <p><a href="javascript:if(confirm('https://github.com/odoo/odoo/edit/8.0/doc/howtos/backend.rst  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/odoo/odoo/edit/8.0/doc/howtos/backend.rst'" tppabs="https://github.com/odoo/odoo/edit/8.0/doc/howtos/backend.rst" class="github">
          Edit on GitHub
        </a></p>
      
    </div>
  </div>
  
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="building-a-module">
<h1>Building a Module</h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This tutorial requires <a class="reference internal" href="install.html#setup-install" tppabs="https://www.odoo.com/documentation/8.0/setup/install.html#setup-install"><em>having installed Odoo</em></a></p>
</div>
<div class="section" id="start-stop-the-odoo-server">
<h2>Start/Stop the Odoo server</h2>
<p>Odoo uses a client/server architecture in which clients are web browsers
accessing the Odoo server via RPC.</p>
<p>Business logic and extension is generally performed on the server side,
although supporting client features (e.g. new data representation such as
interactive maps) can be added to the client.</p>
<p>In order to start the server, simply invoke the command <a class="reference internal" href="cmdline.html#reference-cmdline" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#reference-cmdline"><em>odoo.py</em></a> in the shell, adding the full path to the file if
necessary:</p>
<div class="code bash highlight-python"><div class="highlight"><pre><span class="n">odoo</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>The server is stopped by hitting <tt class="docutils literal"><span class="pre">Ctrl-C</span></tt> twice from the terminal, or by
killing the corresponding OS process.</p>
</div>
<div class="section" id="build-an-odoo-module">
<h2>Build an Odoo module</h2>
<p>Both server and client extensions are packaged as <em>modules</em> which are
optionally loaded in a <em>database</em>.</p>
<p>Odoo modules can either add brand new business logic to an Odoo system, or
alter and extend existing business logic: a module can be created to add your
country&#8217;s accounting rules to Odoo&#8217;s generic accounting support, while the
next module adds support for real-time visualisation of a bus fleet.</p>
<p>Everything in Odoo thus starts and ends with modules.</p>
<div class="section" id="composition-of-a-module">
<h3>Composition of a module</h3>
<p>An Odoo module can contain a number of elements:</p>
<dl class="docutils">
<dt>Business objects</dt>
<dd>declared as Python classes, these resources are automatically persisted
by Odoo based on their configuration</dd>
<dt>Data files</dt>
<dd>XML or CSV files declaring metadata (views or workflows), configuration
data (modules parameterization), demonstration data and more</dd>
<dt>Web controllers</dt>
<dd>Handle requests from web browsers</dd>
<dt>Static web data</dt>
<dd>Images, CSS or javascript files used by the web interface or website</dd>
</dl>
</div>
<div class="section" id="module-structure">
<h3>Module structure</h3>
<p>Each module is a directory within a <em>module directory</em>. Module directories
are specified by using the <a class="reference internal" href="cmdline.html#cmdoption-odoo.py--addons-path" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#cmdoption-odoo.py--addons-path"><em class="xref std std-option">--addons-path</em></a>
option.</p>
<div class="aphorism admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">most command-line options can also be set using <a class="reference internal" href="cmdline.html#reference-cmdline-config" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#reference-cmdline-config"><em>a configuration
file</em></a></p>
</div>
<p>An Odoo module is declared by its <a class="reference internal" href="module.html#reference-module-manifest" tppabs="https://www.odoo.com/documentation/8.0/reference/module.html#reference-module-manifest"><em>manifest</em></a>. It
is mandatory and contains a single python dictionary declaring various
metadata for the module: the module&#8217;s name and description, list of Odoo
modules required for this one to work properly, references to data files, </p>
<p>The manifest&#8217;s general structure is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;MyModule&quot;</span><span class="p">,</span>
    <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="s">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;base&#39;</span><span class="p">],</span>
    <span class="s">&#39;author&#39;</span><span class="p">:</span> <span class="s">&quot;Author Name&quot;</span><span class="p">,</span>
    <span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="s">&#39;Category&#39;</span><span class="p">,</span>
    <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">    Description text</span>
<span class="s">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="c"># data files always loaded at installation</span>
    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">&#39;mymodule_view.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c"># data files containing optionally loaded demonstration data</span>
    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s">&#39;demo_data.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A module is also a
<a class="reference external" href="javascript:if(confirm('http://docs.python.org/2/tutorial/modules.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://docs.python.org/2/tutorial/modules.html#packages'" tppabs="http://docs.python.org/2/tutorial/modules.html#packages">Python package</a>
with a <tt class="docutils literal"><span class="pre">__init__.py</span></tt> file, containing import instructions for various Python
files in the module.</p>
<p>For instance, if the module has a single <tt class="docutils literal"><span class="pre">mymodule.py</span></tt> file <tt class="docutils literal"><span class="pre">__init__.py</span></tt>
might contain:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">mymodule</span>
</pre></div>
</div>
<p>Fortunately, there is a mechanism to help you set up an module. The command
<tt class="docutils literal"><span class="pre">odoo.py</span></tt> has a subcommand <a class="reference internal" href="cmdline.html#reference-cmdline-scaffold" tppabs="https://www.odoo.com/documentation/8.0/reference/cmdline.html#reference-cmdline-scaffold"><em>scaffold</em></a> to
create an empty module:</p>
<div class="code bash highlight-python"><div class="highlight"><pre>odoo.py scaffold &lt;module name&gt; &lt;where to put it&gt;
</pre></div>
</div>
<p>The command creates a subdirectory for your module, and automatically creates a
bunch of standard files for a module. Most of them simply contain commented code
or XML. The usage of most of those files will be explained along this tutorial.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Module creation</p>
<p>Use the command line above to  create an empty module Open Academy, and
install it in Odoo.</p>
<ol class="arabic simple">
<li>Invoke the command <tt class="docutils literal"><span class="pre">odoo.py</span> <span class="pre">scaffold</span> <span class="pre">openacademy</span> <span class="pre">addons</span></tt>.</li>
<li>Adapt the manifest file to your module.</li>
<li>Don&#8217;t bother about the other files.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="p">{</span>
</span><span class="hll">    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&quot;Open Academy&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s">&#39;summary&#39;</span><span class="p">:</span> <span class="s">&quot;&quot;&quot;Manage trainings&quot;&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="s">&quot;&quot;&quot;</span>
</span><span class="hll"><span class="s">        Open Academy module for managing trainings:</span>
</span><span class="hll"><span class="s">            - training courses</span>
</span><span class="hll"><span class="s">            - training sessions</span>
</span><span class="hll"><span class="s">            - attendees registration</span>
</span><span class="hll"><span class="s">    &quot;&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="s">&#39;author&#39;</span><span class="p">:</span> <span class="s">&quot;Your Company&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="s">&#39;website&#39;</span><span class="p">:</span> <span class="s">&quot;http://www.yourcompany.com&quot;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="c"># Categories can be used to filter modules in modules listing</span>
</span><span class="hll">    <span class="c"># Check https://github.com/odoo/odoo/blob/master/openerp/addons/base/module/module_data.xml</span>
</span><span class="hll">    <span class="c"># for the full list</span>
</span><span class="hll">    <span class="s">&#39;category&#39;</span><span class="p">:</span> <span class="s">&#39;Test&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="s">&#39;0.1&#39;</span><span class="p">,</span>
</span><span class="hll">
</span><span class="hll">    <span class="c"># any module necessary for this one to work correctly</span>
</span><span class="hll">    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;base&#39;</span><span class="p">],</span>
</span><span class="hll">
</span><span class="hll">    <span class="c"># always loaded</span>
</span><span class="hll">    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">        <span class="c"># &#39;security/ir.model.access.csv&#39;,</span>
</span><span class="hll">        <span class="s">&#39;templates.xml&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">],</span>
</span><span class="hll">    <span class="c"># only loaded in demonstration mode</span>
</span><span class="hll">    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">        <span class="s">&#39;demo.xml&#39;</span><span class="p">,</span>
</span><span class="hll">    <span class="p">],</span>
</span><span class="hll"><span class="p">}</span>
</span></pre></div>
</div>
</div>
<em>openacademy/__init__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">import</span> <span class="nn">controllers</span>
</span><span class="hll"><span class="kn">import</span> <span class="nn">models</span>
</span></pre></div>
</div>
</div>
<em>openacademy/controllers.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">http</span>
</span><span class="hll">
</span><span class="hll"><span class="c"># class Openacademy(http.Controller):</span>
</span><span class="hll"><span class="c">#     @http.route(&#39;/openacademy/openacademy/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c">#     def index(self, **kw):</span>
</span><span class="hll"><span class="c">#         return &quot;Hello, world&quot;</span>
</span><span class="hll">
</span><span class="hll"><span class="c">#     @http.route(&#39;/openacademy/openacademy/objects/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c">#     def list(self, **kw):</span>
</span><span class="hll"><span class="c">#         return http.request.render(&#39;openacademy.listing&#39;, {</span>
</span><span class="hll"><span class="c">#             &#39;root&#39;: &#39;/openacademy/openacademy&#39;,</span>
</span><span class="hll"><span class="c">#             &#39;objects&#39;: http.request.env[&#39;openacademy.openacademy&#39;].search([]),</span>
</span><span class="hll"><span class="c">#         })</span>
</span><span class="hll">
</span><span class="hll"><span class="c">#     @http.route(&#39;/openacademy/openacademy/objects/&lt;model(&quot;openacademy.openacademy&quot;):obj&gt;/&#39;, auth=&#39;public&#39;)</span>
</span><span class="hll"><span class="c">#     def object(self, obj, **kw):</span>
</span><span class="hll"><span class="c">#         return http.request.render(&#39;openacademy.object&#39;, {</span>
</span><span class="hll"><span class="c">#             &#39;object&#39;: obj</span>
</span><span class="hll"><span class="c">#         })</span>
</span></pre></div>
</div>
</div>
<em>openacademy/demo.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object0&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 0&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object1&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 1&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object2&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 2&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object3&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 3&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;record id=&quot;object4&quot; model=&quot;openacademy.openacademy&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;field name=&quot;name&quot;&gt;Object 4&lt;/field&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/record&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--  --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll">
</span><span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
</span><span class="hll">
</span><span class="hll"><span class="c"># class openacademy(models.Model):</span>
</span><span class="hll"><span class="c">#     _name = &#39;openacademy.openacademy&#39;</span>
</span><span class="hll">
</span><span class="hll"><span class="c">#     name = fields.Char()</span>
</span></pre></div>
</div>
</div>
<em>openacademy/security/ir.model.access.csv</em><div class="pq-section container">
<div class="highlight-guess"><div class="highlight"><pre><span class="hll"><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">model_id</span><span class="o">/</span><span class="n">id</span><span class="p">,</span><span class="n">group_id</span><span class="o">/</span><span class="n">id</span><span class="p">,</span><span class="n">perm_read</span><span class="p">,</span><span class="n">perm_write</span><span class="p">,</span><span class="n">perm_create</span><span class="p">,</span><span class="n">perm_unlink</span>
</span><span class="hll"><span class="n">access_openacademy_openacademy</span><span class="p">,</span><span class="n">openacademy</span><span class="p">.</span><span class="n">openacademy</span><span class="p">,</span><span class="n">model_openacademy_openacademy</span><span class="p">,,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</span></pre></div>
</div>
</div>
<em>openacademy/templates.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;template id=&quot;listing&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;ul&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;li t-foreach=&quot;objects&quot; t-as=&quot;object&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;a t-attf-href=&quot;{{ root }}/objects/{{ object.id }}&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--         &lt;t t-esc=&quot;object.display_name&quot;/&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;/a&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;/li&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/ul&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;/template&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;template id=&quot;object&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;h1&gt;&lt;t t-esc=&quot;object.display_name&quot;/&gt;&lt;/h1&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;dl&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;t t-foreach=&quot;object._fields&quot; t-as=&quot;field&quot;&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;dt&gt;&lt;t t-esc=&quot;field&quot;/&gt;&lt;/dt&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--       &lt;dd&gt;&lt;t t-esc=&quot;object</span><span class="cp">[</span><span class="nb">field</span><span class="cp">]</span><span class="c">&quot;/&gt;&lt;/dd&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--     &lt;/t&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--   &lt;/dl&gt; --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- &lt;/template&gt; --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="object-relational-mapping">
<h3>Object-Relational Mapping</h3>
<p>A key component of Odoo is the <abbr title="Object-Relational Mapping">ORM</abbr> layer.
This layer avoids having to write most <abbr title="Structured Query Language">SQL</abbr>
by hand and provides extensibility and security services<a class="footnote-reference" href="#rawsql" id="id1">[2]</a>.</p>
<p>Business objects are declared as Python classes extending
<a class="reference internal" href="orm.html#openerp.models.Model" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model" title="openerp.models.Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a> which integrates them into the automated
persistence system.</p>
<p>Models can be configured by setting a number of attributes at their
definition. The most important attribute is
<a class="reference internal" href="orm.html#openerp.models.Model._name" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._name" title="openerp.models.Model._name"><tt class="xref py py-attr docutils literal"><span class="pre">_name</span></tt></a> which is required and defines the name for
the model in the Odoo system. Here is a minimally complete definition of a
model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span>
<span class="k">class</span> <span class="nc">MinimalModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;test.model&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="model-fields">
<h3>Model fields</h3>
<p>Fields are used to define what the model can store and where. Fields are
defined as attributes on the model class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">LessMinimalModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;test.model2&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="common-attributes">
<h4>Common Attributes</h4>
<p>Much like the model itself, its fields can be configured, by passing
configuration attributes as parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">name</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Some attributes are available on all fields, here are the most common ones:</p>
<dl class="docutils">
<dt><tt class="xref py py-attr docutils literal"><span class="pre">string</span></tt> (<tt class="docutils literal"><span class="pre">unicode</span></tt>, default: field&#8217;s name)</dt>
<dd>The label of the field in UI (visible by users).</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">required</span></tt> (<tt class="docutils literal"><span class="pre">bool</span></tt>, default: <tt class="docutils literal"><span class="pre">False</span></tt>)</dt>
<dd>If <tt class="docutils literal"><span class="pre">True</span></tt>, the field can not be empty, it must either have a default
value or always be given a value when creating a record.</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">help</span></tt> (<tt class="docutils literal"><span class="pre">unicode</span></tt>, default: <tt class="docutils literal"><span class="pre">''</span></tt>)</dt>
<dd>Long-form, provides a help tooltip to users in the UI.</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">index</span></tt> (<tt class="docutils literal"><span class="pre">bool</span></tt>, default: <tt class="docutils literal"><span class="pre">False</span></tt>)</dt>
<dd>Requests that Odoo create a <a class="reference external" href="javascript:if(confirm('http://use-the-index-luke.com/sql/preface  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://use-the-index-luke.com/sql/preface'" tppabs="http://use-the-index-luke.com/sql/preface">database index</a> on the column</dd>
</dl>
</div>
<div class="section" id="simple-fields">
<h4>Simple fields</h4>
<p>There are two broad categories of fields: &#8220;simple&#8221; fields which are atomic
values stored directly in the model&#8217;s table and &#8220;relational&#8221; fields linking
records (of the same model or of different models).</p>
<p>Example of simple fields are <a class="reference internal" href="orm.html#openerp.fields.Boolean" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Boolean" title="openerp.fields.Boolean"><tt class="xref py py-class docutils literal"><span class="pre">Boolean</span></tt></a>,
<a class="reference internal" href="orm.html#openerp.fields.Date" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Date" title="openerp.fields.Date"><tt class="xref py py-class docutils literal"><span class="pre">Date</span></tt></a>, <a class="reference internal" href="orm.html#openerp.fields.Char" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Char" title="openerp.fields.Char"><tt class="xref py py-class docutils literal"><span class="pre">Char</span></tt></a>.</p>
</div>
<div class="section" id="reserved-fields">
<h4>Reserved fields</h4>
<p>Odoo creates a few fields in all models<a class="footnote-reference" href="#autofields" id="id2">[1]</a>. These fields are
managed by the system and shouldn&#8217;t be written to. They can be read if
useful or necessary:</p>
<dl class="docutils">
<dt><tt class="xref py py-attr docutils literal"><span class="pre">id</span></tt> (<tt class="xref py py-class docutils literal"><span class="pre">Id</span></tt>)</dt>
<dd>the unique identifier for a record in its model</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">create_date</span></tt> (<a class="reference internal" href="orm.html#openerp.fields.Datetime" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Datetime" title="openerp.fields.Datetime"><tt class="xref py py-class docutils literal"><span class="pre">Datetime</span></tt></a>)</dt>
<dd>creation date of the record</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">create_uid</span></tt> (<a class="reference internal" href="orm.html#openerp.fields.Many2one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2one" title="openerp.fields.Many2one"><tt class="xref py py-class docutils literal"><span class="pre">Many2one</span></tt></a>)</dt>
<dd>user who created the record</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">write_date</span></tt> (<a class="reference internal" href="orm.html#openerp.fields.Datetime" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Datetime" title="openerp.fields.Datetime"><tt class="xref py py-class docutils literal"><span class="pre">Datetime</span></tt></a>)</dt>
<dd>last modification date of the record</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">write_uid</span></tt> (<a class="reference internal" href="orm.html#openerp.fields.Many2one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2one" title="openerp.fields.Many2one"><tt class="xref py py-class docutils literal"><span class="pre">Many2one</span></tt></a>)</dt>
<dd>user who last modified the record</dd>
</dl>
</div>
<div class="section" id="special-fields">
<h4>Special fields</h4>
<p>By default, Odoo also requires a <tt class="docutils literal"><span class="pre">name</span></tt> field on all models for various
display and search behaviors. The field used for these purposes can be
overridden by setting <a class="reference internal" href="orm.html#openerp.models.Model._rec_name" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._rec_name" title="openerp.models.Model._rec_name"><tt class="xref py py-attr docutils literal"><span class="pre">_rec_name</span></tt></a>.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Define a model</p>
<p>Define a new data model <em>Course</em> in the <em>openacademy</em> module. A course
has a title and a description. Courses must have a title.</p>
<p>Edit the file <tt class="docutils literal"><span class="pre">openacademy/models.py</span></tt> to include a <em>Course</em> class.</p>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>

<span class="hll"><span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.course&#39;</span>
</span>
<span class="hll">    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="data-files">
<h3>Data files</h3>
<p>Odoo is a highly data driven system. Although behavior is customized using
<a class="reference external" href="javascript:if(confirm('http://python.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://python.org/'" tppabs="http://python.org/">Python</a> code part of a module&#8217;s value is in the data it sets up when loaded.</p>
<div class="aphorism admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">some modules exist solely to add data into Odoo</p>
</div>
<p>Module data is declared via <a class="reference internal" href="data.html#reference-data" tppabs="https://www.odoo.com/documentation/8.0/reference/data.html#reference-data"><em>data files</em></a>, XML files with
<tt class="docutils literal"><span class="pre">&lt;record&gt;</span></tt> elements. Each <tt class="docutils literal"><span class="pre">&lt;record&gt;</span></tt> element creates or updates a database
record.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;openerp&gt;</span>
    <span class="nt">&lt;data&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;{model name}&quot;</span> <span class="na">id=</span><span class="s">&quot;{record identifier}&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;{a field name}&quot;</span><span class="nt">&gt;</span>{a value}<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;openerp&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">model</span></tt> is the name of the Odoo model for the record</li>
<li><tt class="docutils literal"><span class="pre">id</span></tt> is an <a class="reference internal" href="glossary.html#term-external-identifier" tppabs="https://www.odoo.com/documentation/8.0/glossary.html#term-external-identifier"><em class="xref std std-term">external identifier</em></a>, it allows referring to the record
(without having to know its in-database identifier)</li>
<li><tt class="docutils literal"><span class="pre">&lt;field&gt;</span></tt> elements have a <tt class="docutils literal"><span class="pre">name</span></tt> which is the name of the field in the
model (e.g. <tt class="docutils literal"><span class="pre">description</span></tt>). Their body is the field&#8217;s value.</li>
</ul>
<p>Data files have to be declared in the manifest file to be loaded, they can
be declared in the <tt class="docutils literal"><span class="pre">'data'</span></tt> list (always loaded) or in the <tt class="docutils literal"><span class="pre">'demo'</span></tt> list
(only loaded in demonstration mode).</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Define demonstration data</p>
<p>Create demonstration data filling the <em>Courses</em> model with a few
demonstration courses.</p>
<p>Edit the file <tt class="docutils literal"><span class="pre">openacademy/demo.xml</span></tt> to include some data.</p>
<div class="pq-patch last container">
<em>openacademy/demo.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="nt">&lt;openerp&gt;</span>
    <span class="nt">&lt;data&gt;</span>
<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course0&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 0<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">&gt;</span>Course 0&#39;s description
</span><span class="hll">
</span><span class="hll">Can have multiple lines
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 1<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="c">&lt;!-- no description for this one --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;openacademy.course&quot;</span> <span class="na">id=</span><span class="s">&quot;course2&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Course 2<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">&gt;</span>Course 2&#39;s description<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="actions-and-menus">
<h3>Actions and Menus</h3>
<p>Actions and menus are regular records in database, usually declared through
data files. Actions can be triggered in three ways:</p>
<ol class="arabic simple">
<li>by clicking on menu items (linked to specific actions)</li>
<li>by clicking on buttons in views (if these are connected to actions)</li>
<li>as contextual actions on object</li>
</ol>
<p>Because menus are somewhat complex to declare there is a <tt class="docutils literal"><span class="pre">&lt;menuitem&gt;</span></tt>
shortcut to declare an <tt class="docutils literal"><span class="pre">ir.ui.menu</span></tt> and connect it to the corresponding
action more easily.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;action_list_ideas&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Ideas<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>idea.idea<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
<span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;menu_ideas&quot;</span> <span class="na">parent=</span><span class="s">&quot;menu_root&quot;</span> <span class="na">name=</span><span class="s">&quot;Ideas&quot;</span> <span class="na">sequence=</span><span class="s">&quot;10&quot;</span>
          <span class="na">action=</span><span class="s">&quot;action_list_ideas&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="aphorism admonition danger">
<p class="first admonition-title">Danger</p>
<p>The action must be declared before its corresponding menu in the XML file.</p>
<p class="last">Data files are executed sequentially, the action&#8217;s <tt class="docutils literal"><span class="pre">id</span></tt> must be present
in the database before the menu can be created.</p>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Define new menu entries</p>
<p>Define new menu entries to access courses and sessions under the
OpenAcademy menu entry. A user should be able to</p>
<ul class="simple">
<li>display a list of all the courses</li>
<li>create/modify courses</li>
</ul>
<ol class="arabic simple">
<li>Create <tt class="docutils literal"><span class="pre">openacademy/views/openacademy.xml</span></tt> with an action and
the menus triggering the action</li>
<li>Add it to the <tt class="docutils literal"><span class="pre">data</span></tt> list of <tt class="docutils literal"><span class="pre">openacademy/__openerp__.py</span></tt></li>
</ol>
<div class="pq-patch last container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="c"># &#39;security/ir.model.access.csv&#39;,</span>
        <span class="s">&#39;templates.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c"># only loaded in demonstration mode</span>
    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- window action --&gt;</span>
</span><span class="hll">        <span class="c">&lt;!--</span>
</span><span class="hll"><span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</span><span class="hll"><span class="c">            that is an action opening a view or a set of views</span>
</span><span class="hll"><span class="c">        --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;course_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Courses<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span> <span class="na">type=</span><span class="s">&quot;html&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_view_nocontent_create&quot;</span><span class="nt">&gt;</span>Create the first course
</span><span class="hll">                <span class="nt">&lt;/p&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- top level menu: no parent --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;main_openacademy_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Open Academy&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- A first level in the left side menu is needed</span>
</span><span class="hll"><span class="c">             before using action= attribute --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;openacademy_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Open Academy&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;main_openacademy_menu&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- the following menuitem should appear *after*</span>
</span><span class="hll"><span class="c">             its parent openacademy_menu and *after* its</span>
</span><span class="hll"><span class="c">             action course_list_action --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;courses_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Courses&quot;</span> <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;course_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- Full id location:</span>
</span><span class="hll"><span class="c">             action=&quot;openacademy.course_list_action&quot;</span>
</span><span class="hll"><span class="c">             It is not required when it is the same module --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="basic-views">
<h2>Basic views</h2>
<p>Views define the way the records of a model are displayed. Each type of view
represents a mode of visualization (a list of records, a graph of their
aggregation, ). Views can either be requested generically via their type
(e.g. <em>a list of partners</em>) or specifically via their id. For generic
requests, the view with the correct type and the lowest priority will be
used (so the lowest-priority view of each type is the default view for that
type).</p>
<p><a class="reference internal" href="views.html#reference-views-inheritance" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#reference-views-inheritance"><em>View inheritance</em></a> allows altering views
declared elsewhere (adding or removing content).</p>
<div class="section" id="generic-view-declaration">
<h3>Generic view declaration</h3>
<p>A view is declared as a record of the model <tt class="docutils literal"><span class="pre">ir.ui.view</span></tt>. The view type
is implied by the root element of the <tt class="docutils literal"><span class="pre">arch</span></tt> field:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;view_id&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>view.name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>object_name<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;priority&quot;</span> <span class="na">eval=</span><span class="s">&quot;16&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- view content: &lt;form&gt;, &lt;tree&gt;, &lt;graph&gt;, ... --&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="aphorism admonition danger">
<p class="first admonition-title">Danger</p>
<p>The view&#8217;s content is XML.</p>
<p class="last">The <tt class="docutils literal"><span class="pre">arch</span></tt> field must thus be declared as <tt class="docutils literal"><span class="pre">type=&quot;xml&quot;</span></tt> to be parsed
correctly.</p>
</div>
</div>
<div class="section" id="tree-views">
<h3>Tree views</h3>
<p>Tree views, also called list views, display records in a tabular form.</p>
<p>Their root element is <tt class="docutils literal"><span class="pre">&lt;tree&gt;</span></tt>. The simplest form of the tree view simply
lists all the fields to display in the table (each field as a column):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Idea list&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tree&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="form-views">
<h3>Form views</h3>
<p>Forms are used to create and edit single records.</p>
<p>Their root element is <tt class="docutils literal"><span class="pre">&lt;form&gt;</span></tt>. They composed of high-level structure
elements (groups, notebooks) and interactive elements (buttons and fields):</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Idea form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;General stuff&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>

        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;Dates&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;active&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;invent_date&quot;</span> <span class="na">readonly=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>

        <span class="nt">&lt;notebook</span> <span class="na">colspan=</span><span class="s">&quot;4&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">nolabel=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/page&gt;</span>
        <span class="nt">&lt;/notebook&gt;</span>

        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Customise form view using XML</p>
<p>Create your own form view for the Course object. Data displayed should be:
the name and the description of the course.</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;openerp&gt;</span>
    <span class="nt">&lt;data&gt;</span>
<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Course Form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;sheet&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/sheet&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Notebooks</p>
<p>In the Course form view, put the description field under a tab, such that
it will be easier to add other tabs later, containing additional
information.</p>
<p>Modify the Course form view as follows:</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
<span class="hll">                        <span class="nt">&lt;notebook&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;About&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                This is an example of notebooks
</span><span class="hll">                            <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/notebook&gt;</span>
</span>                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>Form views can also use plain HTML for more flexible layouts:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Idea Form&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;header&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Confirm&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_confirm&quot;</span>
                <span class="na">states=</span><span class="s">&quot;draft&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Mark as done&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_done&quot;</span>
                <span class="na">states=</span><span class="s">&quot;confirmed&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">string=</span><span class="s">&quot;Reset to draft&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span> <span class="na">name=</span><span class="s">&quot;action_draft&quot;</span>
                <span class="na">states=</span><span class="s">&quot;confirmed,done&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;sheet&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_title&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;name&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_edit_only&quot;</span> <span class="na">string=</span><span class="s">&quot;Idea Name&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;h1&gt;&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;/h1&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;separator</span> <span class="na">string=</span><span class="s">&quot;General&quot;</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;group</span> <span class="na">colspan=</span><span class="s">&quot;2&quot;</span> <span class="na">col=</span><span class="s">&quot;2&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Idea description...&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/group&gt;</span>
    <span class="nt">&lt;/sheet&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="search-views">
<h3>Search views</h3>
<p>Search views customize the search field associated with the list view (and
other aggregated views). Their root element is <tt class="docutils literal"><span class="pre">&lt;search&gt;</span></tt> and they&#8217;re
composed of fields defining which fields can be searched on:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;search&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
<p>If no search view exists for the model, Odoo generates one which only allows
searching on the <tt class="docutils literal"><span class="pre">name</span></tt> field.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Search courses</p>
<p>Allow searching for courses based on their title or their description.</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_search_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.search<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;search&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/search&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="relations-between-models">
<h2>Relations between models</h2>
<p>A record from a model may be related to a record from another model. For
instance, a sale order record is related to a client record that contains the
client data; it is also related to its sale order line records.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Create a session model</p>
<p>For the module Open Academy, we consider a model for <em>sessions</em>: a session
is an occurrence of a course taught at a given time for a given audience.</p>
<p>Create a model for <em>sessions</em>. A session has a name, a start date, a
duration and a number of seats. Add an action and a menu item to display
them. Make the new model visible via a menu item.</p>
<ol class="arabic simple">
<li>Create the class <em>Session</em> in <tt class="docutils literal"><span class="pre">openacademy/models.py</span></tt>.</li>
<li>Add access to the session object in <tt class="docutils literal"><span class="pre">openacademy/view/openacademy.xml</span></tt>.</li>
</ol>
<div class="pq-patch container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>
<span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.session&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
</span><span class="hll">    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Duration in days&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>        <span class="c">&lt;!-- Full id location:</span>
<span class="c">             action=&quot;openacademy.course_list_action&quot;</span>
<span class="c">             It is not required when it is the same module --&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="c">&lt;!-- session form view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;sheet&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/sheet&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">/&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">digits=(6,</span> <span class="pre">2)</span></tt> specifies the precision of a float number:
6 is the total number of digits, while 2 is the number of
digits after the comma. Note that it results in the number
digits before the comma is a maximum 4</p>
</div>
</div>
<div class="section" id="relational-fields">
<h3>Relational fields</h3>
<p>Relational fields link records, either of the same model (hierarchies) or
between different models.</p>
<p>Relational field types are:</p>
<dl class="docutils">
<dt><a class="reference internal" href="orm.html#openerp.fields.Many2one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2one" title="openerp.fields.Many2one"><tt class="xref py py-class docutils literal"><span class="pre">Many2one(other_model,</span> <span class="pre">ondelete='set</span> <span class="pre">null')</span></tt></a></dt>
<dd><p class="first">A simple link to an other object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_id</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<div class="last admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="javascript:if(confirm('http://www.postgresql.org/docs/9.3/static/tutorial-fk.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.postgresql.org/docs/9.3/static/tutorial-fk.html'" tppabs="http://www.postgresql.org/docs/9.3/static/tutorial-fk.html">foreign keys</a></p>
</div>
</dd>
<dt><a class="reference internal" href="orm.html#openerp.fields.One2many" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.One2many" title="openerp.fields.One2many"><tt class="xref py py-class docutils literal"><span class="pre">One2many(other_model,</span> <span class="pre">related_field)</span></tt></a></dt>
<dd><p class="first">A virtual relationship, inverse of a <a class="reference internal" href="orm.html#openerp.fields.Many2one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2one" title="openerp.fields.Many2one"><tt class="xref py py-class docutils literal"><span class="pre">Many2one</span></tt></a>.
A <a class="reference internal" href="orm.html#openerp.fields.One2many" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.One2many" title="openerp.fields.One2many"><tt class="xref py py-class docutils literal"><span class="pre">One2many</span></tt></a> behaves as a container of records,
accessing it results in a (possibly empty) set of records:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_ids</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<div class="last admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">Because a <a class="reference internal" href="orm.html#openerp.fields.One2many" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.One2many" title="openerp.fields.One2many"><tt class="xref py py-class docutils literal"><span class="pre">One2many</span></tt></a> is a virtual relationship,
there <em>must</em> be a <a class="reference internal" href="orm.html#openerp.fields.Many2one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2one" title="openerp.fields.Many2one"><tt class="xref py py-class docutils literal"><span class="pre">Many2one</span></tt></a> field in the
<tt class="samp docutils literal"><em><span class="pre">other_model</span></em></tt>, and its name <em>must</em> be <tt class="samp docutils literal"><em><span class="pre">related_field</span></em></tt></p>
</div>
</dd>
<dt><a class="reference internal" href="orm.html#openerp.fields.Many2many" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Many2many" title="openerp.fields.Many2many"><tt class="xref py py-class docutils literal"><span class="pre">Many2many(other_model)</span></tt></a></dt>
<dd><p class="first">Bidirectional multiple relationship, any record on one side can be related
to any number of records on the other side. Behaves as a container of
records, accessing it also results in a possibly empty set of records:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">foo</span><span class="o">.</span><span class="n">other_ids</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">other</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</dd>
</dl>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Many2one relations</p>
<p>Using a many2one, modify the <em>Course</em> and <em>Session</em> models to reflect their
relation with other models:</p>
<ul class="simple">
<li>A course has a <em>responsible</em> user; the value of that field is a record of
the built-in model <tt class="docutils literal"><span class="pre">res.users</span></tt>.</li>
<li>A session has an <em>instructor</em>; the value of that field is a record of the
built-in model <tt class="docutils literal"><span class="pre">res.partner</span></tt>.</li>
<li>A session is related to a <em>course</em>; the value of that field is a record
of the model <tt class="docutils literal"><span class="pre">openacademy.course</span></tt> and is required.</li>
<li>Adapt the views.</li>
</ul>
<ol class="arabic simple">
<li>Add the relevant <tt class="docutils literal"><span class="pre">Many2one</span></tt> fields to the models, and</li>
<li>add them in the views.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Title&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>

<span class="hll">    <span class="n">responsible_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.users&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;set null&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Responsible&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">
</span>
<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.session&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">()</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">)</span>
</span><span class="hll">    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;responsible_id&quot;</span><span class="nt">/&gt;</span>
</span>                        <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;notebook&gt;</span>
                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- override the automatically generated list view for courses --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;course_tree_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>course.tree<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Course Tree&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;responsible_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="c">&lt;!-- window action --&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            The following tag is an action definition for a &quot;window action&quot;,</span>
</pre></div>
</div>
<div class="highlight-xml+lasso"><div class="highlight"><pre>                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
<span class="hll">                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;General&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Schedule&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/group&gt;</span>
</span>                        <span class="nt">&lt;/group&gt;</span>
                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- session tree/list view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_tree_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.tree<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Inverse one2many relations</p>
<p>Using the inverse relational field one2many, modify the models to reflect
the relation between courses and sessions.</p>
<ol class="arabic simple">
<li>Modify the <tt class="docutils literal"><span class="pre">Course</span></tt> class, and</li>
<li>add the field in the course form view.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">responsible_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.users&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;set null&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Responsible&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
</span><span class="hll">        <span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Sessions&quot;</span><span class="p">)</span>
</span>

<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Description&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/page&gt;</span>
<span class="hll">                            <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Registered sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;/tree&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;/field&gt;</span>
</span>                            <span class="nt">&lt;/page&gt;</span>
                        <span class="nt">&lt;/notebook&gt;</span>
                    <span class="nt">&lt;/sheet&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Multiple many2many relations</p>
<p>Using the relational field many2many, modify the <em>Session</em> model to relate
every session to a set of <em>attendees</em>. Attendees will be represented by
partner records, so we will relate to the built-in model <tt class="docutils literal"><span class="pre">res.partner</span></tt>.
Adapt the views accordingly.</p>
<ol class="arabic simple">
<li>Modify the <tt class="docutils literal"><span class="pre">Session</span></tt> class, and</li>
<li>add the field in the form view.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">)</span>
    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
<span class="hll">                        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span>                    <span class="nt">&lt;/sheet&gt;</span>
                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="inheritance">
<h2>Inheritance</h2>
<div class="section" id="model-inheritance">
<h3>Model inheritance</h3>
<p>Odoo provides two <em>inheritance</em> mechanisms to extend an existing model in a
modular way.</p>
<p>The first inheritance mechanism allows a module to modify the behavior of a
model defined in another module:</p>
<ul class="simple">
<li>add fields to a model,</li>
<li>override the definition of fields on a model,</li>
<li>add constraints to a model,</li>
<li>add methods to a model,</li>
<li>override existing methods on a model.</li>
</ul>
<p>The second inheritance mechanism (delegation) allows to link every record of a
model to a record in a parent model, and provides transparent access to the
fields of the parent record.</p>
<img alt="../_images/inheritance_methods.png" class="align-center" src="inheritance_methods.png" tppabs="https://www.odoo.com/documentation/8.0/_images/inheritance_methods.png" />
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="orm.html#openerp.models.Model._inherit" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._inherit" title="openerp.models.Model._inherit"><tt class="xref py py-attr docutils literal"><span class="pre">_inherit</span></tt></a></li>
<li><a class="reference internal" href="orm.html#openerp.models.Model._inherits" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._inherits" title="openerp.models.Model._inherits"><tt class="xref py py-attr docutils literal"><span class="pre">_inherits</span></tt></a></li>
</ul>
</div>
</div>
<div class="section" id="view-inheritance">
<h3>View inheritance</h3>
<p>Instead of modifying existing views in place (by overwriting them), Odoo
provides view inheritance where children &#8220;extension&#8221; views are applied on top of
root views, and can add or remove content from their parent.</p>
<p>An extension view references its parent using the <tt class="docutils literal"><span class="pre">inherit_id</span></tt> field, and
instead of a single view its <tt class="docutils literal"><span class="pre">arch</span></tt> field is composed of any number of
<tt class="docutils literal"><span class="pre">xpath</span></tt> elements selecting and altering the content of their parent view:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- improved idea categories list --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;idea_category_list2&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>id.category.list2<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>ir.ui.view<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;id_category_list&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="c">&lt;!-- find field description inside tree, and add the field</span>
<span class="c">             idea_ids after it --&gt;</span>
        <span class="nt">&lt;xpath</span> <span class="na">expr=</span><span class="s">&quot;/tree/field[@name=&#39;description&#39;]&quot;</span> <span class="na">position=</span><span class="s">&quot;after&quot;</span><span class="nt">&gt;</span>
          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;idea_ids&quot;</span> <span class="na">string=</span><span class="s">&quot;Number of ideas&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/xpath&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">expr</span></tt></dt>
<dd>An <a class="reference external" href="javascript:if(confirm('http://w3.org/TR/xpath  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://w3.org/TR/xpath'" tppabs="http://w3.org/TR/xpath">XPath</a> expression selecting a single element in the parent view.
Raises an error if it matches no element or more than one</dd>
<dt><tt class="docutils literal"><span class="pre">position</span></tt></dt>
<dd><p class="first">Operation to apply to the matched element:</p>
<dl class="last docutils">
<dt><tt class="docutils literal"><span class="pre">inside</span></tt></dt>
<dd>appends <tt class="docutils literal"><span class="pre">xpath</span></tt>&#8216;s body at the end of the matched element</dd>
<dt><tt class="docutils literal"><span class="pre">replace</span></tt></dt>
<dd>replaces the matched element by the <tt class="docutils literal"><span class="pre">xpath</span></tt>&#8216;s body</dd>
<dt><tt class="docutils literal"><span class="pre">before</span></tt></dt>
<dd>inserts the <tt class="docutils literal"><span class="pre">xpath</span></tt>&#8216;s body as a sibling before the matched element</dd>
<dt><tt class="docutils literal"><span class="pre">after</span></tt></dt>
<dd>inserts the <tt class="docutils literal"><span class="pre">xpaths</span></tt>&#8216;s body as a sibling after the matched element</dd>
<dt><tt class="docutils literal"><span class="pre">attributes</span></tt></dt>
<dd>alters the attributes of the matched element using special
<tt class="docutils literal"><span class="pre">attribute</span></tt> elements in the <tt class="docutils literal"><span class="pre">xpath</span></tt>&#8216;s body</dd>
</dl>
</dd>
</dl>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Alter existing content</p>
<ul class="simple">
<li>Using model inheritance, modify the existing <em>Partner</em> model to add an
<tt class="docutils literal"><span class="pre">instructor</span></tt> boolean field, and a many2many field that corresponds to
the session-partner relation</li>
<li>Using view inheritance, display this fields in the partner form view</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is the opportunity to introduce the developer mode to
inspect the view, find its external ID and the place to put the
new field.</p>
</div>
<ol class="arabic simple">
<li>Create a file <tt class="docutils literal"><span class="pre">openacademy/partner.py</span></tt> and import it in
<tt class="docutils literal"><span class="pre">__init__.py</span></tt></li>
<li>Create a file <tt class="docutils literal"><span class="pre">openacademy/views/partner.xml</span></tt> and add it to
<tt class="docutils literal"><span class="pre">__openerp__.py</span></tt></li>
</ol>
<div class="pq-patch last container">
<em>openacademy/__init__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">controllers</span>
<span class="kn">import</span> <span class="nn">models</span>
<span class="hll"><span class="kn">import</span> <span class="nn">partner</span>
</span></pre></div>
</div>
</div>
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>        <span class="c"># &#39;security/ir.model.access.csv&#39;,</span>
        <span class="s">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s">&#39;views/partner.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c"># only loaded in demonstration mode</span>
    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div>
<em>openacademy/partner.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span>
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Partner</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_inherit</span> <span class="o">=</span> <span class="s">&#39;res.partner&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="c"># Add a new column to the res.partner model, by default partners are not</span>
</span><span class="hll">    <span class="c"># instructors</span>
</span><span class="hll">    <span class="n">instructor</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="s">&quot;Instructor&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attended Sessions&quot;</span><span class="p">,</span> <span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
<em>openacademy/views/partner.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
</span><span class="hll"> <span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="c">&lt;!-- Add instructor field to existing view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;partner_instructor_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>partner.instructor<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>res.partner<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inherit_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;base.view_partner_form&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;notebook</span> <span class="na">position=</span><span class="s">&quot;inside&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;page</span> <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/page&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/notebook&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Contacts<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>res.partner<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;configuration_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Configuration&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;main_openacademy_menu&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contacts&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="domains">
<h4>Domains</h4>
<p>In Odoo, <a class="reference internal" href="orm.html#reference-orm-domains" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#reference-orm-domains"><em>Domains</em></a> are values that encode conditions on
records. A domain is a  list of criteria used to select a subset of a model&#8217;s
records. Each criteria is a triple with a field name, an operator and a value.</p>
<p>For instance, when used on the <em>Product</em> model the following domain selects
all <em>services</em> with a unit price over <em>1000</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[(</span><span class="s">&#39;product_type&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="s">&#39;service&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)]</span>
</pre></div>
</div>
<p>By default criteria are combined with an implicit AND. The logical operators
<tt class="docutils literal"><span class="pre">&amp;</span></tt> (AND), <tt class="docutils literal"><span class="pre">|</span></tt> (OR) and <tt class="docutils literal"><span class="pre">!</span></tt> (NOT) can be used to explicitly combine
criteria. They are used in prefix position (the operator is inserted before
its arguments rather than between). For instance to select products &#8220;which are
services <em>OR</em> have a unit price which is <em>NOT</em> between 1000 and 2000&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="s">&#39;|&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="s">&#39;product_type&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="s">&#39;service&#39;</span><span class="p">),</span>
    <span class="s">&#39;!&#39;</span><span class="p">,</span> <span class="s">&#39;&amp;&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;unit_price&#39;</span><span class="p">,</span> <span class="s">&#39;&lt;&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)]</span>
</pre></div>
</div>
<p>A <tt class="docutils literal"><span class="pre">domain</span></tt> parameter can be added to relational fields to limit valid
records for the relation when trying to select records in the client interface.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Domains on relational fields</p>
<p>When selecting the instructor for a <em>Session</em>, only instructors (partners
with <tt class="docutils literal"><span class="pre">instructor</span></tt> set to <tt class="docutils literal"><span class="pre">True</span></tt>) should be visible.</p>
<div class="pq-patch container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>

<span class="hll">    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">domain</span><span class="o">=</span><span class="p">[(</span><span class="s">&#39;instructor&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)])</span>
</span>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A domain declared as a literal list is evaluated server-side and
can&#8217;t refer to dynamic values on the right-hand side, a domain
declared as a string is evaluated client-side and allows
field names on the right-hand side</p>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>More complex domains</p>
<p>Create new partner categories <em>Teacher / Level 1</em> and <em>Teacher / Level 2</em>.
The instructor for a session can be either an instructor or a teacher
(of any level).</p>
<ol class="arabic simple">
<li>Modify the <em>Session</em> model&#8217;s domain</li>
<li>Modify <tt class="docutils literal"><span class="pre">openacademy/view/partner.xml</span></tt> to get access to
<em>Partner categories</em>:</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>

    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">,</span>
<span class="hll">        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;instructor&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</span><span class="hll">                     <span class="p">(</span><span class="s">&#39;category_id.name&#39;</span><span class="p">,</span> <span class="s">&#39;ilike&#39;</span><span class="p">,</span> <span class="s">&quot;Teacher&quot;</span><span class="p">)])</span>
</span>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<em>openacademy/views/partner.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contacts&quot;</span>
                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
                  <span class="na">action=</span><span class="s">&quot;contact_list_action&quot;</span><span class="nt">/&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;contact_cat_list_action&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Contact Tags<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>res.partner.category<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;contact_cat_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Contact Tags&quot;</span>
</span><span class="hll">                  <span class="na">parent=</span><span class="s">&quot;configuration_menu&quot;</span>
</span><span class="hll">                  <span class="na">action=</span><span class="s">&quot;contact_cat_list_action&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;res.partner.category&quot;</span> <span class="na">id=</span><span class="s">&quot;teacher1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Teacher / Level 1<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;res.partner.category&quot;</span> <span class="na">id=</span><span class="s">&quot;teacher2&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Teacher / Level 2<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="computed-fields-and-default-values">
<h2>Computed fields and default values</h2>
<p>So far fields have been stored directly in and retrieved directly from the
database. Fields can also be <em>computed</em>. In that case, the field&#8217;s value is not
retrieved from the database but computed on-the-fly by calling a method of the
model.</p>
<p>To create a computed field, create a field and set its attribute
<tt class="xref py py-attr docutils literal"><span class="pre">compute</span></tt> to the name of a method. The computation
method should simply set the value of the field to compute on every record in
<tt class="docutils literal"><span class="pre">self</span></tt>.</p>
<div class="aphorism admonition danger">
<p class="first admonition-title">Danger</p>
<p><tt class="docutils literal"><span class="pre">self</span></tt> is a collection</p>
<p>The object <tt class="docutils literal"><span class="pre">self</span></tt> is a <em>recordset</em>, i.e., an ordered collection of
records. It supports the standard Python operations on collections, like
<tt class="docutils literal"><span class="pre">len(self)</span></tt> and <tt class="docutils literal"><span class="pre">iter(self)</span></tt>, plus extra set operations like <tt class="docutils literal"><span class="pre">recs1</span> <span class="pre">+</span>
<span class="pre">recs2</span></tt>.</p>
<p class="last">Iterating over <tt class="docutils literal"><span class="pre">self</span></tt> gives the records one by one, where each record is
itself a collection of size 1. You can access/assign fields on single
records by using the dot notation, like <tt class="docutils literal"><span class="pre">record.name</span></tt>.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span>

<span class="k">class</span> <span class="nc">ComputedModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;test.computed&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">compute</span><span class="o">=</span><span class="s">&#39;_compute_name&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_compute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">record</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</div>
<p>Our compute method is very simple: it loops over <tt class="docutils literal"><span class="pre">self</span></tt> and performs the same
operation on every record. We can make it slightly simpler by using the
decorator <a class="reference internal" href="orm.html#openerp.api.one" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.api.one" title="openerp.api.one"><tt class="xref py py-func docutils literal"><span class="pre">one()</span></tt></a> to automatically loop on the collection:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.one</span>
<span class="k">def</span> <span class="nf">_compute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e6</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="dependencies">
<h3>Dependencies</h3>
<p>The value of a computed field usually depends on the values of other fields on
the computed record. The ORM expects the developer to specify those dependencies
on the compute method with the decorator <a class="reference internal" href="orm.html#openerp.api.depends" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.api.depends" title="openerp.api.depends"><tt class="xref py py-func docutils literal"><span class="pre">depends()</span></tt></a>.
The given dependencies are used by the ORM to trigger the recomputation of the
field whenever some of its dependencies have been modified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>

<span class="k">class</span> <span class="nc">ComputedModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;test.computed&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">compute</span><span class="o">=</span><span class="s">&#39;_compute_name&#39;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>

    <span class="nd">@api.one</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;value&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_compute_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Record with value </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Computed fields</p>
<ul class="simple">
<li>Add the percentage of taken seats to the <em>Session</em> model</li>
<li>Display that field in the tree and form views</li>
<li>Display the field as a progress bar</li>
</ul>
<ol class="arabic simple">
<li>Add a computed field to <em>Session</em></li>
<li>Show the field in the <em>Session</em> view:</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">course_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span>
        <span class="n">ondelete</span><span class="o">=</span><span class="s">&#39;cascade&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Course&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="n">taken_seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Taken seats&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_taken_seats&#39;</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span><span class="p">:</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
</span></pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;seats&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
</span>                            <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;/group&gt;</span>
                        <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="highlight-xml+lasso"><div class="highlight"><pre>                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
</span>                <span class="nt">&lt;/tree&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="default-values">
<h3>Default values</h3>
<p>Any field can be given a default value. In the field definition, add the option
<tt class="docutils literal"><span class="pre">default=X</span></tt> where <tt class="docutils literal"><span class="pre">X</span></tt> is either a Python literal value (boolean, integer,
float, string), or a function taking a recordset and returning a value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s">&quot;Unknown&quot;</span><span class="p">)</span>
<span class="n">user_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.users&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The object <tt class="docutils literal"><span class="pre">self.env</span></tt> gives access to request parameters and other useful
things:</p>
<ul class="last simple">
<li><tt class="docutils literal"><span class="pre">self.env.cr</span></tt> or <tt class="docutils literal"><span class="pre">self._cr</span></tt> is the database <em>cursor</em> object; it is
used for querying the database</li>
<li><tt class="docutils literal"><span class="pre">self.env.uid</span></tt> or <tt class="docutils literal"><span class="pre">self._uid</span></tt> is the current user&#8217;s database id</li>
<li><tt class="docutils literal"><span class="pre">self.env.user</span></tt> is the current user&#8217;s record</li>
<li><tt class="docutils literal"><span class="pre">self.env.context</span></tt> or <tt class="docutils literal"><span class="pre">self._context</span></tt> is the context dictionary</li>
<li><tt class="docutils literal"><span class="pre">self.env.ref(xml_id)</span></tt> returns the record corresponding to an XML id</li>
<li><tt class="docutils literal"><span class="pre">self.env[model_name]</span></tt> returns an instance of the given model</li>
</ul>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Active objects  Default values</p>
<ul class="simple">
<li>Define the start_date default value as today (see
<a class="reference internal" href="orm.html#openerp.fields.Date" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.fields.Date" title="openerp.fields.Date"><tt class="xref py py-class docutils literal"><span class="pre">Date</span></tt></a>).</li>
<li>Add a field <tt class="docutils literal"><span class="pre">active</span></tt> in the class Session, and set sessions as active by
default.</li>
</ul>
<div class="pq-patch container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.session&#39;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="o">.</span><span class="n">today</span><span class="p">)</span>
</span>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>
<span class="hll">    <span class="n">active</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span>
    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;instructor&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;active&quot;</span><span class="nt">/&gt;</span>
</span>                            <span class="nt">&lt;/group&gt;</span>
                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Schedule&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Odoo has built-in rules making fields with an <tt class="docutils literal"><span class="pre">active</span></tt> field set
to <tt class="docutils literal"><span class="pre">False</span></tt> invisible.</p>
</div>
</div>
</div>
</div>
<div class="section" id="onchange">
<h2>Onchange</h2>
<p>The &#8220;onchange&#8221; mechanism provides a way for the client interface to update a
form whenever the user has filled in a value in a field, without saving anything
to the database.</p>
<p>For instance, suppose a model has three fields <tt class="docutils literal"><span class="pre">amount</span></tt>, <tt class="docutils literal"><span class="pre">unit_price</span></tt> and
<tt class="docutils literal"><span class="pre">price</span></tt>, and you want to update the price on the form when any of the other
fields is modified. To achieve this, define a method where <tt class="docutils literal"><span class="pre">self</span></tt> represents
the record in the form view, and decorate it with <a class="reference internal" href="orm.html#openerp.api.onchange" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.api.onchange" title="openerp.api.onchange"><tt class="xref py py-func docutils literal"><span class="pre">onchange()</span></tt></a>
to specify on which field it has to be triggered. Any change you make on
<tt class="docutils literal"><span class="pre">self</span></tt> will be reflected on the form.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="c">&lt;!-- content of form view --&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;amount&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;unit_price&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;price&quot;</span> <span class="na">readonly=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># onchange handler</span>
<span class="nd">@api.onchange</span><span class="p">(</span><span class="s">&#39;amount&#39;</span><span class="p">,</span> <span class="s">&#39;unit_price&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_onchange_price</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># set auto-changing field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amount</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_price</span>
    <span class="c"># Can optionally return a warning and domains</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&quot;Something bad happened&quot;</span><span class="p">,</span>
            <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="s">&quot;It was very bad indeed&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>For computed fields, valued <tt class="docutils literal"><span class="pre">onchange</span></tt> behavior is built-in as can be seen by
playing with the <em>Session</em> form: change the number of seats or participants, and
the <tt class="docutils literal"><span class="pre">taken_seats</span></tt> progressbar is automatically updated.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Warning</p>
<p>Add an explicit onchange to warn about invalid values, like a negative
number of seats, or more participants than seats.</p>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>            <span class="bp">self</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">taken_seats</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.onchange</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_verify_valid_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span class="hll">            <span class="k">return</span> <span class="p">{</span>
</span><span class="hll">                <span class="s">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">                    <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&quot;Incorrect &#39;seats&#39; value&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="s">&quot;The number of available seats may not be negative&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">},</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">):</span>
</span><span class="hll">            <span class="k">return</span> <span class="p">{</span>
</span><span class="hll">                <span class="s">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">                    <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="s">&quot;Too many attendees&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="s">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="p">},</span>
</span><span class="hll">            <span class="p">}</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="model-constraints">
<h2>Model constraints</h2>
<p>Odoo provides two ways to set up automatically verified invariants:
<a class="reference internal" href="orm.html#openerp.api.constrains" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.api.constrains" title="openerp.api.constrains"><tt class="xref py py-func docutils literal"><span class="pre">Python</span> <span class="pre">constraints</span></tt></a> and
<a class="reference internal" href="orm.html#openerp.models.Model._sql_constraints" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._sql_constraints" title="openerp.models.Model._sql_constraints"><tt class="xref py py-attr docutils literal"><span class="pre">SQL</span> <span class="pre">constraints</span></tt></a>.</p>
<p>A Python constraint is defined as a method decorated with
<a class="reference internal" href="orm.html#openerp.api.constrains" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.api.constrains" title="openerp.api.constrains"><tt class="xref py py-func docutils literal"><span class="pre">constrains()</span></tt></a>, and invoked on a recordset. The decorator
specifies which fields are involved in the constraint, so that the constraint is
automatically evaluated when one of them is modified. The method is expected to
raise an exception if its invariant is not satisfied:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openerp.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>

<span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;age&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_check_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">record</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s">&quot;Your record is too old: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">record</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
    <span class="c"># all records passed the test, don&#39;t return anything</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add Python constraints</p>
<p>Add a constraint that checks that the instructor is not present in the
attendees of his/her own session.</p>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>

<span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span>
</span>
<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.course&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>                    <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="s">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">}</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
</span><span class="hll">            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="s">&quot;A session&#39;s instructor can&#39;t be an attendee&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<p>SQL constraints are defined through the model attribute
<a class="reference internal" href="orm.html#openerp.models.Model._sql_constraints" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._sql_constraints" title="openerp.models.Model._sql_constraints"><tt class="xref py py-attr docutils literal"><span class="pre">_sql_constraints</span></tt></a>. The latter is assigned to a list
of triples of strings <tt class="docutils literal"><span class="pre">(name,</span> <span class="pre">sql_definition,</span> <span class="pre">message)</span></tt>, where <tt class="docutils literal"><span class="pre">name</span></tt> is a
valid SQL constraint name, <tt class="docutils literal"><span class="pre">sql_definition</span></tt> is a <a class="reference external" href="javascript:if(confirm('http://www.postgresql.org/docs/9.3/static/ddl-constraints.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.postgresql.org/docs/9.3/static/ddl-constraints.html'" tppabs="http://www.postgresql.org/docs/9.3/static/ddl-constraints.html">table_constraint</a> expression,
and <tt class="docutils literal"><span class="pre">message</span></tt> is the error message.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add SQL constraints</p>
<p>With the help of <a class="reference external" href="javascript:if(confirm('http://www.postgresql.org/docs/9.3/static/ddl-constraints.html  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://www.postgresql.org/docs/9.3/static/ddl-constraints.html'" tppabs="http://www.postgresql.org/docs/9.3/static/ddl-constraints.html">PostgreSQL&#8217;s documentation</a> , add the following
constraints:</p>
<ol class="arabic simple">
<li>CHECK that the course description and the course title are different</li>
<li>Make the Course&#8217;s name UNIQUE</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
        <span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Sessions&quot;</span><span class="p">)</span>

<span class="hll">    <span class="n">_sql_constraints</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="hll">        <span class="p">(</span><span class="s">&#39;name_description_check&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s">&#39;CHECK(name != description)&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s">&quot;The title of the course should not be the description&quot;</span><span class="p">),</span>
</span><span class="hll">
</span><span class="hll">        <span class="p">(</span><span class="s">&#39;name_unique&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s">&#39;UNIQUE(name)&#39;</span><span class="p">,</span>
</span><span class="hll">         <span class="s">&quot;The course title must be unique&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="p">]</span>
</span><span class="hll">
</span>
<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.session&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Exercise 6 - Add a duplicate option</p>
<p>Since we added a constraint for the Course name uniqueness, it is not
possible to use the &#8220;duplicate&#8221; function anymore (<em class="menuselection">Form 
Duplicate</em>).</p>
<p>Re-implement your own &#8220;copy&#8221; method which allows to duplicate the Course
object, changing the original name into &#8220;Copy of [original name]&#8221;.</p>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">One2many</span><span class="p">(</span>
        <span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s">&#39;course_id&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Sessions&quot;</span><span class="p">)</span>

<span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
</span><span class="hll">        <span class="n">default</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">default</span> <span class="ow">or</span> <span class="p">{})</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">copied_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_count</span><span class="p">(</span>
</span><span class="hll">            <span class="p">[(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;=like&#39;</span><span class="p">,</span> <span class="s">u&quot;Copy of {}%&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))])</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="n">copied_count</span><span class="p">:</span>
</span><span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="s">u&quot;Copy of {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span class="hll">        <span class="k">else</span><span class="p">:</span>
</span><span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="s">u&quot;Copy of {} ({})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">copied_count</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">        <span class="n">default</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
</span><span class="hll">        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Course</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="n">_sql_constraints</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&#39;name_description_check&#39;</span><span class="p">,</span>
         <span class="s">&#39;CHECK(name != description)&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="advanced-views">
<h2>Advanced Views</h2>
<div class="section" id="id3">
<h3>Tree views</h3>
<p>Tree views can take supplementary attributes to further customize their
behavior:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">colors</span></tt></dt>
<dd><p class="first">mappings of colors to conditions. If the condition evaluates to <tt class="docutils literal"><span class="pre">True</span></tt>,
the corresponding color is applied to the row:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Idea Categories&quot;</span> <span class="na">colors=</span><span class="s">&quot;blue:state==&#39;draft&#39;;red:state==&#39;trashed&#39;&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/tree&gt;</span>
</pre></div>
</div>
<p class="last">Clauses are separated by <tt class="docutils literal"><span class="pre">;</span></tt>, the color and condition are separated by
<tt class="docutils literal"><span class="pre">:</span></tt>.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">editable</span></tt></dt>
<dd>Either <tt class="docutils literal"><span class="pre">&quot;top&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;bottom&quot;</span></tt>. Makes the tree view editable in-place
(rather than having to go through the form view), the value is the
position where new rows appear.</dd>
</dl>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>List coloring</p>
<p>Modify the Session tree view in such a way that sessions lasting less than
5 days are colored blue, and the ones lasting more than 15 days are
colored red.</p>
<p>Modify the session tree view:</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.tree<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
<span class="hll">                <span class="nt">&lt;tree</span> <span class="na">string=</span><span class="s">&quot;Session Tree&quot;</span> <span class="na">colors=</span><span class="s">&quot;#0000ff:duration&amp;lt;5;red:duration&amp;gt;15&quot;</span><span class="nt">&gt;</span>
</span>                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span> <span class="na">invisible=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span>                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;taken_seats&quot;</span> <span class="na">widget=</span><span class="s">&quot;progressbar&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/tree&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="calendars">
<h3>Calendars</h3>
<p>Displays records as calendar events. Their root element is <tt class="docutils literal"><span class="pre">&lt;calendar&gt;</span></tt> and
their most common attributes are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">color</span></tt></dt>
<dd>The name of the field used for <em>color segmentation</em>. Colors are
automatically distributed to events, but events in the same color segment
(records which have the same value for their <tt class="docutils literal"><span class="pre">&#64;color</span></tt> field) will be
given the same color.</dd>
<dt><tt class="docutils literal"><span class="pre">date_start</span></tt></dt>
<dd>record&#8217;s field holding the start date/time for the event</dd>
<dt><tt class="docutils literal"><span class="pre">date_stop</span></tt> (optional)</dt>
<dd>record&#8217;s field holding the end date/time for the event</dd>
</dl>
<p>field (to define the label for each calendar event)</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;calendar</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span> <span class="na">date_start=</span><span class="s">&quot;invent_date&quot;</span> <span class="na">color=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/calendar&gt;</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Calendar view</p>
<p>Add a Calendar view to the <em>Session</em> model enabling the user to view the
events associated to the Open Academy.</p>
<ol class="arabic">
<li><p class="first">Add an <tt class="docutils literal"><span class="pre">end_date</span></tt> field computed from <tt class="docutils literal"><span class="pre">start_date</span></tt> and
<tt class="docutils literal"><span class="pre">duration</span></tt></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">the inverse function makes the field writable, and allows
moving the sessions (via drag and drop) in the calendar view</p>
</div>
</li>
<li><p class="first">Add a calendar view to the <em>Session</em> model</p>
</li>
<li><p class="first">And add the calendar view to the <em>Session</em> model&#8217;s actions</p>
</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>

<span class="hll"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
</span><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span>

<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>

    <span class="n">taken_seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Taken seats&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_taken_seats&#39;</span><span class="p">)</span>
<span class="hll">    <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;End Date&quot;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
</span><span class="hll">        <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_end_date&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s">&#39;_set_end_date&#39;</span><span class="p">)</span>
</span>
    <span class="nd">@api.one</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>            <span class="p">}</span>

    <span class="nd">@api.one</span>
<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;start_date&#39;</span><span class="p">,</span> <span class="s">&#39;duration&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">):</span>
</span><span class="hll">            <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_date</span>
</span><span class="hll">            <span class="k">return</span>
</span><span class="hll">
</span><span class="hll">        <span class="c"># Add duration to start_date, but: Monday + 5 days = Saturday, so</span>
</span><span class="hll">        <span class="c"># subtract one second to get on Friday instead</span>
</span><span class="hll">        <span class="n">start</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">)</span>
</span><span class="hll">        <span class="n">duration</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">duration</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_set_end_date</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">):</span>
</span><span class="hll">            <span class="k">return</span>
</span><span class="hll">
</span><span class="hll">        <span class="c"># Compute the difference between dates, but: Friday - Monday = 4 days,</span>
</span><span class="hll">        <span class="c"># so add one day to get 5 days instead</span>
</span><span class="hll">        <span class="n">start_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">)</span>
</span><span class="hll">        <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Datetime</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_date</span><span class="p">)</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_date</span> <span class="o">-</span> <span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="c">&lt;!-- calendar view --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_calendar_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.calendar<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;calendar</span> <span class="na">string=</span><span class="s">&quot;Session Calendar&quot;</span> <span class="na">date_start=</span><span class="s">&quot;start_date&quot;</span>
</span><span class="hll">                          <span class="na">date_stop=</span><span class="s">&quot;end_date&quot;</span>
</span><span class="hll">                          <span class="na">color=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/calendar&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar<span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Search views</h3>
<p>Search view <tt class="docutils literal"><span class="pre">&lt;field&gt;</span></tt> elements can have a <tt class="docutils literal"><span class="pre">&#64;filter_domain</span></tt> that overrides
the domain generated for searching on the given field. In the given domain,
<tt class="docutils literal"><span class="pre">self</span></tt> represents the value entered by the user. In the example below, it is
used to search on both fields <tt class="docutils literal"><span class="pre">name</span></tt> and <tt class="docutils literal"><span class="pre">description</span></tt>.</p>
<p>Search views can also contain <tt class="docutils literal"><span class="pre">&lt;filter&gt;</span></tt> elements, which act as toggles for
predefined searches. Filters must have one of the following attributes:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">domain</span></tt></dt>
<dd>add the given domain to the current search</dd>
<dt><tt class="docutils literal"><span class="pre">context</span></tt></dt>
<dd>add some context to the current search; use the key <tt class="docutils literal"><span class="pre">group_by</span></tt> to group
results on the given field name</dd>
</dl>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;search</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span> <span class="na">string=</span><span class="s">&quot;Name and description&quot;</span>
           <span class="na">filter_domain=</span><span class="s">&quot;[&#39;|&#39;, (&#39;name&#39;, &#39;ilike&#39;, self), (&#39;description&#39;, &#39;ilike&#39;, self)]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;country_id&quot;</span> <span class="na">widget=</span><span class="s">&quot;selection&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;my_ideas&quot;</span> <span class="na">string=</span><span class="s">&quot;My Ideas&quot;</span>
            <span class="na">domain=</span><span class="s">&quot;[(&#39;inventor_id&#39;, &#39;=&#39;, uid)]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Group By&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;group_by_inventor&quot;</span> <span class="na">string=</span><span class="s">&quot;Inventor&quot;</span>
                <span class="na">context=</span><span class="s">&quot;{&#39;group_by&#39;: &#39;inventor&#39;}&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/group&gt;</span>
<span class="nt">&lt;/search&gt;</span>
</pre></div>
</div>
<p>To use a non-default search view in an action, it should be linked using the
<tt class="docutils literal"><span class="pre">search_view_id</span></tt> field of the action record.</p>
<p>The action can also set default values for search fields through its
<tt class="docutils literal"><span class="pre">context</span></tt> field: context keys of the form
<tt class="samp docutils literal"><span class="pre">search_default_</span><em><span class="pre">field_name</span></em></tt> will initialize <em>field_name</em> with the
provided value. Search filters must have an optional <tt class="docutils literal"><span class="pre">&#64;name</span></tt> to have a
default and behave as booleans (they can only be enabled by default).</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Search views</p>
<ol class="arabic simple">
<li>Add a button to filter the courses for which the current user is the
responsible in the course search view. Make it selected by default.</li>
<li>Add a button to group courses by responsible user.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                <span class="nt">&lt;search&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;description&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                    <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;my_courses&quot;</span> <span class="na">string=</span><span class="s">&quot;My Courses&quot;</span>
</span><span class="hll">                            <span class="na">domain=</span><span class="s">&quot;</span><span class="cp">[</span><span class="p">(</span><span class="s1">&#39;responsible_id&#39;</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="nx">uid</span><span class="p">)</span><span class="cp">]</span><span class="s">&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;Group By&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;filter</span> <span class="na">name=</span><span class="s">&quot;by_responsible&quot;</span> <span class="na">string=</span><span class="s">&quot;Responsible&quot;</span>
</span><span class="hll">                                <span class="na">context=</span><span class="s">&quot;{&#39;group_by&#39;: &#39;responsible_id&#39;}&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/group&gt;</span>
</span>                <span class="nt">&lt;/search&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;context&quot;</span> <span class="na">eval=</span><span class="s">&quot;{&#39;search_default_my_courses&#39;: 1}&quot;</span><span class="nt">/&gt;</span>
</span>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;help&quot;</span> <span class="na">type=</span><span class="s">&quot;html&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;oe_view_nocontent_create&quot;</span><span class="nt">&gt;</span>Create the first course
                <span class="nt">&lt;/p&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="gantt">
<h3>Gantt</h3>
<p>Horizontal bar charts typically used to show project planning and advancement,
their root element is <tt class="docutils literal"><span class="pre">&lt;gantt&gt;</span></tt>.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;gantt</span> <span class="na">string=</span><span class="s">&quot;Ideas&quot;</span> <span class="na">date_start=</span><span class="s">&quot;invent_date&quot;</span> <span class="na">color=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;level</span> <span class="na">object=</span><span class="s">&quot;idea.idea&quot;</span> <span class="na">link=</span><span class="s">&quot;id&quot;</span> <span class="na">domain=</span><span class="s">&quot;[]&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/level&gt;</span>
<span class="nt">&lt;/gantt&gt;</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Gantt charts</p>
<p>Add a Gantt Chart enabling the user to view the sessions scheduling linked
to the Open Academy module. The sessions should be grouped by instructor.</p>
<ol class="arabic simple">
<li>Create a computed field expressing the session&#8217;s duration in hours</li>
<li>Add the gantt view&#8217;s definition, and add the gantt view to the
<em>Session</em> model&#8217;s action</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">end_date</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Date</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;End Date&quot;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_end_date&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s">&#39;_set_end_date&#39;</span><span class="p">)</span>

<span class="hll">    <span class="n">hours</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Duration in hours&quot;</span><span class="p">,</span>
</span><span class="hll">                         <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_hours&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s">&#39;_set_hours&#39;</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@api.one</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_date</span> <span class="o">-</span> <span class="n">start_date</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@api.one</span>
<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;duration&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">*</span> <span class="mi">24</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_set_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">/</span> <span class="mi">24</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;session_gantt_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>session.gantt<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;gantt</span> <span class="na">string=</span><span class="s">&quot;Session Gantt&quot;</span> <span class="na">color=</span><span class="s">&quot;course_id&quot;</span>
</span><span class="hll">                       <span class="na">date_start=</span><span class="s">&quot;start_date&quot;</span> <span class="na">date_delay=</span><span class="s">&quot;hours&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;level</span> <span class="na">object=</span><span class="s">&quot;res.partner&quot;</span> <span class="na">link=</span><span class="s">&quot;instructor_id&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/level&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/gantt&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar,gantt<span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="graph-views">
<h3>Graph views</h3>
<p>Graph views allow aggregated overview and analysis of models, their root
element is <tt class="docutils literal"><span class="pre">&lt;graph&gt;</span></tt>.</p>
<p>Graph views have 4 display modes, the default mode is selected using the
<tt class="docutils literal"><span class="pre">&#64;type</span></tt> attribute.</p>
<dl class="docutils">
<dt>Pivot</dt>
<dd>a multidimensional table, allows the selection of filers and dimensions
to get the right aggregated dataset before moving to a more graphical
overview</dd>
<dt>Bar (default)</dt>
<dd><p class="first">a bar chart, the first dimension is used to define groups on the
horizontal axis, other dimensions define aggregated bars within each group.</p>
<p class="last">By default bars are side-by-side, they can be stacked by using
<tt class="docutils literal"><span class="pre">&#64;stacked=&quot;True&quot;</span></tt> on the <tt class="docutils literal"><span class="pre">&lt;graph&gt;</span></tt></p>
</dd>
<dt>Line</dt>
<dd>2-dimensional line chart</dd>
<dt>Pie</dt>
<dd>2-dimensional pie</dd>
</dl>
<p>Graph views contain <tt class="docutils literal"><span class="pre">&lt;field&gt;</span></tt> with a mandatory <tt class="docutils literal"><span class="pre">&#64;type</span></tt> attribute taking
the values:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">row</span></tt> (default)</dt>
<dd>the field should be aggregated by default</dd>
<dt><tt class="docutils literal"><span class="pre">measure</span></tt></dt>
<dd>the field should be aggregated rather than grouped on</dd>
</dl>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;graph</span> <span class="na">string=</span><span class="s">&quot;Total idea score by Inventor&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;inventor_id&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;score&quot;</span> <span class="na">type=</span><span class="s">&quot;measure&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/graph&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Graph views perform aggregations on database values, they do not work
with non-stored computed fields.</p>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Graph view</p>
<p>Add a Graph view in the Session object that displays, for each course, the
number of attendees under the form of a bar chart.</p>
<ol class="arabic simple">
<li>Add the number of attendees as a stored computed field</li>
<li>Then add the relevant view</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">hours</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Duration in hours&quot;</span><span class="p">,</span>
                         <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_hours&#39;</span><span class="p">,</span> <span class="n">inverse</span><span class="o">=</span><span class="s">&#39;_set_hours&#39;</span><span class="p">)</span>

<span class="hll">    <span class="n">attendees_count</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees count&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_attendees_count&#39;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">
</span>    <span class="nd">@api.one</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hours</span> <span class="o">/</span> <span class="mi">24</span>

    <span class="nd">@api.one</span>
<span class="hll">    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">_get_attendees_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">attendees_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;openacademy_session_graph_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>openacademy.session.graph<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;graph</span> <span class="na">string=</span><span class="s">&quot;Participations by Courses&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;course_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendees_count&quot;</span> <span class="na">type=</span><span class="s">&quot;measure&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/graph&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar,gantt,graph<span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="kanban">
<h3>Kanban</h3>
<p>Used to organize tasks, production processes, etc their root element is
<tt class="docutils literal"><span class="pre">&lt;kanban&gt;</span></tt>.</p>
<p>A kanban view shows a set of cards possibly grouped in columns. Each card
represents a record, and each column the values of an aggregation field.</p>
<p>For instance, project tasks may be organized by stage (each column is a
stage), or by responsible (each column is a user), and so on.</p>
<p>Kanban views define the structure of each card as a mix of form elements
(including basic HTML) and <a class="reference internal" href="qweb.html#reference-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#reference-qweb"><em>QWeb</em></a>.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Kanban view</p>
<p>Add a Kanban view that displays sessions grouped by course (columns are
thus courses).</p>
<ol class="arabic simple">
<li>Add an integer <tt class="docutils literal"><span class="pre">color</span></tt> field to the <em>Session</em> model</li>
<li>Add the kanban view and update the action</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">duration</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Duration in days&quot;</span><span class="p">)</span>
    <span class="n">seats</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s">&quot;Number of seats&quot;</span><span class="p">)</span>
    <span class="n">active</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="hll">    <span class="n">color</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">()</span>
</span>
    <span class="n">instructor_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Instructor&quot;</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;instructor&#39;</span><span class="p">,</span> <span class="s">&#39;=&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">),</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;view_openacad_session_kanban&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>openacad.session.kanban<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;kanban</span> <span class="na">default_group_by=</span><span class="s">&quot;course_id&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;color&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;templates&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">&quot;kanban-box&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;div</span>
</span><span class="hll">                                    <span class="na">t-attf-class=</span><span class="s">&quot;oe_kanban_color_{{kanban_getcolor(record.color.raw_value)}}</span>
</span><span class="hll"><span class="s">                                                  oe_kanban_global_click_edit oe_semantic_html_override</span>
</span><span class="hll"><span class="s">                                                  oe_kanban_card {{record.group_fancy==1 ? &#39;oe_kanban_card_fancy&#39; : &#39;&#39;}}&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_dropdown_kanban&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                    <span class="c">&lt;!-- dropdown menu --&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_dropdown_toggle&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;oe_e&quot;</span><span class="nt">&gt;</span>#<span class="nt">&lt;/span&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;oe_dropdown_menu&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                            <span class="nt">&lt;li&gt;</span>
</span><span class="hll">                                                <span class="nt">&lt;a</span> <span class="na">type=</span><span class="s">&quot;delete&quot;</span><span class="nt">&gt;</span>Delete<span class="nt">&lt;/a&gt;</span>
</span><span class="hll">                                            <span class="nt">&lt;/li&gt;</span>
</span><span class="hll">                                            <span class="nt">&lt;li&gt;</span>
</span><span class="hll">                                                <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">&quot;oe_kanban_colorpicker&quot;</span>
</span><span class="hll">                                                    <span class="na">data-field=</span><span class="s">&quot;color&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                            <span class="nt">&lt;/li&gt;</span>
</span><span class="hll">                                        <span class="nt">&lt;/ul&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;oe_clear&quot;</span><span class="nt">&gt;&lt;/div&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;div</span> <span class="na">t-attf-class=</span><span class="s">&quot;oe_kanban_content&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                    <span class="c">&lt;!-- title --&gt;</span>
</span><span class="hll">                                    Session name:
</span><span class="hll">                                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;br/&gt;</span>
</span><span class="hll">                                    Start date:
</span><span class="hll">                                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;start_date&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                    <span class="nt">&lt;br/&gt;</span>
</span><span class="hll">                                    duration:
</span><span class="hll">                                    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;duration&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/templates&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/kanban&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form,calendar,gantt,graph,kanban<span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="workflows">
<h2>Workflows</h2>
<p>Workflows are models associated to business objects describing their dynamics.
Workflows are also used to track processes that evolve over time.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Almost a workflow</p>
<p>Add a <tt class="docutils literal"><span class="pre">state</span></tt> field to the <em>Session</em> model. It will be used to define
a workflow-ish.</p>
<p>A sesion can have three possible states: Draft (default), Confirmed and
Done.</p>
<p>In the session form, add a (read-only) field to
visualize the state, and buttons to change it. The valid transitions are:</p>
<ul class="simple">
<li>Draft -&gt; Confirmed</li>
<li>Confirmed -&gt; Draft</li>
<li>Confirmed -&gt; Done</li>
<li>Done -&gt; Draft</li>
</ul>
<ol class="arabic simple">
<li>Add a new <tt class="docutils literal"><span class="pre">state</span></tt> field</li>
<li>Add state-transitioning methods, those can be called from view
buttons to change the record&#8217;s state</li>
<li>And add the relevant buttons to the session&#8217;s form view</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">attendees_count</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span>
        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees count&quot;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s">&#39;_get_attendees_count&#39;</span><span class="p">,</span> <span class="n">store</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="hll">    <span class="n">state</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Selection</span><span class="p">([</span>
</span><span class="hll">         <span class="p">(</span><span class="s">&#39;draft&#39;</span><span class="p">,</span> <span class="s">&quot;Draft&quot;</span><span class="p">),</span>
</span><span class="hll">         <span class="p">(</span><span class="s">&#39;confirmed&#39;</span><span class="p">,</span> <span class="s">&quot;Confirmed&quot;</span><span class="p">),</span>
</span><span class="hll">         <span class="p">(</span><span class="s">&#39;done&#39;</span><span class="p">,</span> <span class="s">&quot;Done&quot;</span><span class="p">),</span>
</span><span class="hll">    <span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;draft&#39;</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">action_draft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s">&#39;draft&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">action_confirm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s">&#39;confirmed&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nd">@api.one</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">action_done</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="s">&#39;done&#39;</span>
</span><span class="hll">
</span>    <span class="nd">@api.one</span>
    <span class="nd">@api.depends</span><span class="p">(</span><span class="s">&#39;seats&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_taken_seats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
<span class="hll">                    <span class="nt">&lt;header&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;action_draft&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Reset to draft&quot;</span>
</span><span class="hll">                                <span class="na">states=</span><span class="s">&quot;confirmed,done&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;action_confirm&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Confirm&quot;</span> <span class="na">states=</span><span class="s">&quot;draft&quot;</span>
</span><span class="hll">                                <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;action_done&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Mark as done&quot;</span> <span class="na">states=</span><span class="s">&quot;confirmed&quot;</span>
</span><span class="hll">                                <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/header&gt;</span>
</span><span class="hll">
</span>                    <span class="nt">&lt;sheet&gt;</span>
                        <span class="nt">&lt;group&gt;</span>
                            <span class="nt">&lt;group</span> <span class="na">string=</span><span class="s">&quot;General&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<p>Workflows may be associated with any object in Odoo, and are entirely
customizable. Workflows are used to structure and manage the lifecycles of
business objects and documents, and define transitions, triggers, etc. with
graphical tools. Workflows, activities (nodes or actions) and transitions
(conditions) are declared as XML records, as usual. The tokens that navigate
in workflows are called workitems.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A workflow associated with a model is only created when the
model&#8217;s records are created. Thus there is no workflow instance
associated with session instances created before the workflow&#8217;s
definition</p>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Workflow</p>
<p>Replace the ad-hoc <em>Session</em> workflow by a real workflow. Transform the
<em>Session</em> form view so its buttons call the workflow instead of the
model&#8217;s methods.</p>
<div class="pq-patch container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>        <span class="s">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/partner.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s">&#39;views/session_workflow.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c"># only loaded in demonstration mode</span>
    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div>
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>         <span class="p">(</span><span class="s">&#39;draft&#39;</span><span class="p">,</span> <span class="s">&quot;Draft&quot;</span><span class="p">),</span>
         <span class="p">(</span><span class="s">&#39;confirmed&#39;</span><span class="p">,</span> <span class="s">&quot;Confirmed&quot;</span><span class="p">),</span>
         <span class="p">(</span><span class="s">&#39;done&#39;</span><span class="p">,</span> <span class="s">&quot;Done&quot;</span><span class="p">),</span>
<span class="hll">    <span class="p">])</span>
</span>
    <span class="nd">@api.one</span>
    <span class="k">def</span> <span class="nf">action_draft</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Form&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;header&gt;</span>
<span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;draft&quot;</span> <span class="na">type=</span><span class="s">&quot;workflow&quot;</span>
</span>                                <span class="na">string=</span><span class="s">&quot;Reset to draft&quot;</span>
                                <span class="na">states=</span><span class="s">&quot;confirmed,done&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span> <span class="na">type=</span><span class="s">&quot;workflow&quot;</span>
</span>                                <span class="na">string=</span><span class="s">&quot;Confirm&quot;</span> <span class="na">states=</span><span class="s">&quot;draft&quot;</span>
                                <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
<span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;done&quot;</span> <span class="na">type=</span><span class="s">&quot;workflow&quot;</span>
</span>                                <span class="na">string=</span><span class="s">&quot;Mark as done&quot;</span> <span class="na">states=</span><span class="s">&quot;confirmed&quot;</span>
                                <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;state&quot;</span> <span class="na">widget=</span><span class="s">&quot;statusbar&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</div>
<em>openacademy/views/session_workflow.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow&quot;</span> <span class="na">id=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>OpenAcademy sessions workflow<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;osv&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;on_create&quot;</span><span class="nt">&gt;</span>True<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;draft&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Draft<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;flow_start&quot;</span> <span class="na">eval=</span><span class="s">&quot;True&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>function<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;</span>action_draft()<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Confirmed<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>function<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;</span>action_confirm()<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;done&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Done<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>function<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;</span>action_done()<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_draft_to_confirmed&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_from&quot;</span> <span class="na">ref=</span><span class="s">&quot;draft&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;signal&quot;</span><span class="nt">&gt;</span>confirm<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_confirmed_to_draft&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_from&quot;</span> <span class="na">ref=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;draft&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;signal&quot;</span><span class="nt">&gt;</span>draft<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_done_to_draft&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_from&quot;</span> <span class="na">ref=</span><span class="s">&quot;done&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;draft&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;signal&quot;</span><span class="nt">&gt;</span>draft<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_confirmed_to_done&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_from&quot;</span> <span class="na">ref=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;done&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;signal&quot;</span><span class="nt">&gt;</span>done<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
<div class="last admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">In order to check if instances of the workflow are correctly
created alongside sessions, go to <em class="menuselection">Settings 
Technical  Workflows  Instances</em></p>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Automatic transitions</p>
<p>Automatically transition sessions from <em>Draft</em> to <em>Confirmed</em> when more
than half the session&#8217;s seats are reserved.</p>
<div class="pq-patch last container">
<em>openacademy/views/session_workflow.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;done&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;signal&quot;</span><span class="nt">&gt;</span>done<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_auto_confirm_half_filled&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_from&quot;</span> <span class="na">ref=</span><span class="s">&quot;draft&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;act_to&quot;</span> <span class="na">ref=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;condition&quot;</span><span class="nt">&gt;</span>taken_seats <span class="ni">&amp;gt;</span> 50<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Server actions</p>
<p>Replace the Python methods for synchronizing session state by
server actions.</p>
<p>Both the workflow and the server actions could have been created entirely
from the UI.</p>
<div class="pq-patch last container">
<em>openacademy/views/session_workflow.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;on_create&quot;</span><span class="nt">&gt;</span>True<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>

<span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.server&quot;</span> <span class="na">id=</span><span class="s">&quot;set_session_to_draft&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Set session to Draft<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_openacademy_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">recs = self.browse(cr, uid, context<span class="cp">[</span><span class="s1">&#39;active_ids&#39;</span><span class="cp">]</span>, context=context)
</span><span class="hll">recs.action_draft()
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;draft&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Draft<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;flow_start&quot;</span> <span class="na">eval=</span><span class="s">&quot;True&quot;</span><span class="nt">/&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>dummy<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;set_session_to_draft&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.server&quot;</span> <span class="na">id=</span><span class="s">&quot;set_session_to_confirmed&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Set session to Confirmed<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_openacademy_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">recs = self.browse(cr, uid, context<span class="cp">[</span><span class="s1">&#39;active_ids&#39;</span><span class="cp">]</span>, context=context)
</span><span class="hll">recs.action_confirm()
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;confirmed&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Confirmed<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>dummy<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;set_session_to_confirmed&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.server&quot;</span> <span class="na">id=</span><span class="s">&quot;set_session_to_done&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Set session to Done<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_openacademy_session&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;code&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">recs = self.browse(cr, uid, context<span class="cp">[</span><span class="s1">&#39;active_ids&#39;</span><span class="cp">]</span>, context=context)
</span><span class="hll">recs.action_done()
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>
        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.activity&quot;</span> <span class="na">id=</span><span class="s">&quot;done&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Done<span class="nt">&lt;/field&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;wkf_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;wkf_session&quot;</span><span class="nt">/&gt;</span>
<span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;kind&quot;</span><span class="nt">&gt;</span>dummy<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action&quot;</span><span class="nt">&gt;&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;action_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;set_session_to_done&quot;</span><span class="nt">/&gt;</span>
</span>        <span class="nt">&lt;/record&gt;</span>

        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;workflow.transition&quot;</span> <span class="na">id=</span><span class="s">&quot;session_draft_to_confirmed&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="security">
<h2>Security</h2>
<p>Access control mechanisms must be configured to achieve a coherent security
policy.</p>
<div class="section" id="group-based-access-control-mechanisms">
<h3>Group-based access control mechanisms</h3>
<p>Groups are created as normal records on the model <tt class="docutils literal"><span class="pre">res.groups</span></tt>, and granted
menu access via menu definitions. However even without a menu, objects may
still be accessible indirectly, so actual object-level permissions (read,
write, create, unlink) must be defined for groups. They are usually inserted
via CSV files inside modules. It is also possible to restrict access to
specific fields on a view or object using the field&#8217;s groups attribute.</p>
</div>
<div class="section" id="access-rights">
<h3>Access rights</h3>
<p>Access rights are defined as records of the model <tt class="docutils literal"><span class="pre">ir.model.access</span></tt>. Each
access right is associated to a model, a group (or no group for global
access), and a set of permissions: read, write, create, unlink. Such access
rights are usually created by a CSV file named after its model:
<tt class="docutils literal"><span class="pre">ir.model.access.csv</span></tt>.</p>
<div class="highlight-text"><div class="highlight"><pre>id,name,model_id/id,group_id/id,perm_read,perm_write,perm_create,perm_unlink
access_idea_idea,idea.idea,model_idea_idea,base.group_user,1,1,1,0
access_idea_vote,idea.vote,model_idea_vote,base.group_user,1,1,1,0
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add access control through the OpenERP interface</p>
<p>Create a new user &#8220;John Smith&#8221;. Then create a group
&#8220;OpenAcademy / Session Read&#8221; with read access to the <em>Session</em> model.</p>
<ol class="last arabic simple">
<li>Create a new user <em>John Smith</em> through
<em class="menuselection">Settings  Users  Users</em></li>
<li>Create a new group <tt class="docutils literal"><span class="pre">session_read</span></tt> through
<em class="menuselection">Settings  Users  Groups</em>, it should have
read access on the <em>Session</em> model</li>
<li>Edit <em>John Smith</em> to make them a member of <tt class="docutils literal"><span class="pre">session_read</span></tt></li>
<li>Log in as <em>John Smith</em> to check the access rights are correct</li>
</ol>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add access control through data files in your module</p>
<p>Using data files,</p>
<ul class="simple">
<li>Create a group <em>OpenAcademy / Manager</em> with full access to all
OpenAcademy models</li>
<li>Make <em>Session</em> and <em>Course</em> readable by all users</li>
</ul>
<ol class="arabic simple">
<li>Create a new file <tt class="docutils literal"><span class="pre">openacademy/security/security.xml</span></tt> to
hold the OpenAcademy Manager group</li>
<li>Edit the file <tt class="docutils literal"><span class="pre">openacademy/security/ir.model.access.csv</span></tt> with
the access rights to the models</li>
<li>Finally update <tt class="docutils literal"><span class="pre">openacademy/__openerp__.py</span></tt> to add the new data
files to it</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="c"># always loaded</span>
    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
<span class="hll">        <span class="s">&#39;security/security.xml&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="s">&#39;security/ir.model.access.csv&#39;</span><span class="p">,</span>
</span>        <span class="s">&#39;templates.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/partner.xml&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div>
<em>openacademy/security/ir.model.access.csv</em><div class="pq-section container">
<div class="highlight-guess"><div class="highlight"><pre><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">model_id</span><span class="o">/</span><span class="n">id</span><span class="p">,</span><span class="n">group_id</span><span class="o">/</span><span class="n">id</span><span class="p">,</span><span class="n">perm_read</span><span class="p">,</span><span class="n">perm_write</span><span class="p">,</span><span class="n">perm_create</span><span class="p">,</span><span class="n">perm_unlink</span>
<span class="hll"><span class="n">course_manager</span><span class="p">,</span><span class="n">course</span> <span class="n">manager</span><span class="p">,</span><span class="n">model_openacademy_course</span><span class="p">,</span><span class="n">group_manager</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
</span><span class="hll"><span class="n">session_manager</span><span class="p">,</span><span class="n">session</span> <span class="n">manager</span><span class="p">,</span><span class="n">model_openacademy_session</span><span class="p">,</span><span class="n">group_manager</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
</span><span class="hll"><span class="n">course_read_all</span><span class="p">,</span><span class="n">course</span> <span class="n">all</span><span class="p">,</span><span class="n">model_openacademy_course</span><span class="p">,,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</span><span class="hll"><span class="n">session_read_all</span><span class="p">,</span><span class="n">session</span> <span class="n">all</span><span class="p">,</span><span class="n">model_openacademy_session</span><span class="p">,,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</span></pre></div>
</div>
</div>
<em>openacademy/security/security.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;group_manager&quot;</span> <span class="na">model=</span><span class="s">&quot;res.groups&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>OpenAcademy / Manager<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="record-rules">
<h3>Record rules</h3>
<p>A record rule restricts the access rights to a subset of records of the given
model. A rule is a record of the model <tt class="docutils literal"><span class="pre">ir.rule</span></tt>, and is associated to a
model, a number of groups (many2many field), permissions to which the
restriction applies, and a domain. The domain specifies to which records the
access rights are limited.</p>
<p>Here is an example of a rule that prevents the deletion of leads that are not
in state <tt class="docutils literal"><span class="pre">cancel</span></tt>. Notice that the value of the field <tt class="docutils literal"><span class="pre">groups</span></tt> must follow
the same convention as the method <a class="reference internal" href="orm.html#openerp.models.Model.write" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model.write" title="openerp.models.Model.write"><tt class="xref py py-meth docutils literal"><span class="pre">write()</span></tt></a> of the ORM.</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;delete_cancelled_only&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Only cancelled leads may be deleted<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;crm.model_crm_lead&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;groups&quot;</span> <span class="na">eval=</span><span class="s">&quot;[(4, ref(&#39;base.group_sale_manager&#39;))]&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_read&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_write&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_create&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_unlink&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>[(&#39;state&#39;,&#39;=&#39;,&#39;cancel&#39;)]<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Record rule</p>
<p>Add a record rule for the model Course and the group
&#8220;OpenAcademy / Manager&#8221;, that restricts <tt class="docutils literal"><span class="pre">write</span></tt> and <tt class="docutils literal"><span class="pre">unlink</span></tt> accesses
to the responsible of a course. If a course has no responsible, all users
of the group must be able to modify it.</p>
<p>Create a new rule in <tt class="docutils literal"><span class="pre">openacademy/security/security.xml</span></tt>:</p>
<div class="pq-patch last container">
<em>openacademy/security/security.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;group_manager&quot;</span> <span class="na">model=</span><span class="s">&quot;res.groups&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>OpenAcademy / Manager<span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
<span class="hll">    
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">&quot;only_responsible_can_modify&quot;</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Only Responsible can modify Course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_openacademy_course&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;groups&quot;</span> <span class="na">eval=</span><span class="s">&quot;</span><span class="cp">[</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nx">ref</span><span class="p">(</span><span class="s1">&#39;openacademy.group_manager&#39;</span><span class="p">))</span><span class="cp">]</span><span class="s">&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_read&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_write&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_create&quot;</span> <span class="na">eval=</span><span class="s">&quot;0&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;perm_unlink&quot;</span> <span class="na">eval=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="cp">[</span><span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;responsible_id&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">),</span>
</span><span class="hll">                      <span class="p">(</span><span class="s1">&#39;responsible_id&#39;</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="nx">user.id</span><span class="p">)</span><span class="cp">]</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="wizards">
<h2>Wizards</h2>
<p>Wizards describe interactive sessions with the user (or dialog boxes) through
dynamic forms. A wizard is simply a model that extends the class
<tt class="xref py py-class docutils literal"><span class="pre">TransientModel</span></tt> instead of
<a class="reference internal" href="orm.html#openerp.models.Model" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model" title="openerp.models.Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a>. The class
<tt class="xref py py-class docutils literal"><span class="pre">TransientModel</span></tt> extends <a class="reference internal" href="orm.html#openerp.models.Model" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model" title="openerp.models.Model"><tt class="xref py py-class docutils literal"><span class="pre">Model</span></tt></a>
and reuse all its existing mechanisms, with the following particularities:</p>
<ul class="simple">
<li>Wizard records are not meant to be persistent; they are automatically deleted
from the database after a certain time. This is why they are called
<em>transient</em>.</li>
<li>Wizard models do not require explicit access rights: users have all
permissions on wizard records.</li>
<li>Wizard records may refer to regular records or wizard records through many2one
fields, but regular records <em>cannot</em> refer to wizard records through a
many2one field.</li>
</ul>
<p>We want to create a wizard that allow users to create attendees for a particular
session, or for a list of sessions at once.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Define the wizard</p>
<p>Create a wizard model with a many2one relationship with the <em>Session</em>
model and a many2many relationship with the <em>Partner</em> model.</p>
<p>Add a new file <tt class="docutils literal"><span class="pre">openacademy/wizard.py</span></tt>:</p>
<div class="pq-patch last container">
<em>openacademy/__init__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">controllers</span>
<span class="kn">import</span> <span class="nn">models</span>
<span class="kn">import</span> <span class="nn">partner</span>
<span class="hll"><span class="kn">import</span> <span class="nn">wizard</span>
</span></pre></div>
</div>
</div>
<em>openacademy/wizard.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="hll"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="hll">
</span><span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span>
</span><span class="hll">
</span><span class="hll"><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
</span><span class="hll">    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.wizard&#39;</span>
</span><span class="hll">
</span><span class="hll">    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span><span class="hll">    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="launching-wizards">
<h3>Launching wizards</h3>
<p>Wizards are launched by <tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt> records, with the field
<tt class="docutils literal"><span class="pre">target</span></tt> set to the value <tt class="docutils literal"><span class="pre">new</span></tt>. The latter opens the wizard view into a
popup window. The action may be triggered by a menu item.</p>
<p>There is another way to launch the wizard: using an <tt class="docutils literal"><span class="pre">ir.actions.act_window</span></tt>
record like above, but with an extra field <tt class="docutils literal"><span class="pre">src_model</span></tt> that specifies in the
context of which model the action is available. The wizard will appear in the
contextual actions of the model, above the main view. Because of some internal
hooks in the ORM, such an action is declared in XML with the tag <tt class="docutils literal"><span class="pre">act_window</span></tt>.</p>
<div class="code xml highlight-python"><div class="highlight"><pre>&lt;act_window id=&quot;launch_the_wizard&quot;
            name=&quot;Launch the Wizard&quot;
            src_model=&quot;context_model_name&quot;
            res_model=&quot;wizard_model_name&quot;
            view_mode=&quot;form&quot;
            target=&quot;new&quot;
            key2=&quot;client_action_multi&quot;/&gt;
</pre></div>
</div>
<p>Wizards use regular views and their buttons may use the attribute
<tt class="docutils literal"><span class="pre">special=&quot;cancel&quot;</span></tt> to close the wizard window without saving.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Launch the wizard</p>
<ol class="arabic simple">
<li>Define a form view for the wizard.</li>
<li>Add the action to launch it in the context of the <em>Session</em> model.</li>
<li>Define a default value for the session field in the wizard; use the
context parameter <tt class="docutils literal"><span class="pre">self._context</span></tt> to retrieve the current session.</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/wizard.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.wizard&#39;</span>

<span class="hll">    <span class="k">def</span> <span class="nf">_default_session</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;active_id&#39;</span><span class="p">))</span>
</span><span class="hll">
</span>    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span>
<span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_session</span><span class="p">)</span>
</span>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>        <span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">&quot;session_menu&quot;</span> <span class="na">name=</span><span class="s">&quot;Sessions&quot;</span>
                  <span class="na">parent=</span><span class="s">&quot;openacademy_menu&quot;</span>
                  <span class="na">action=</span><span class="s">&quot;session_list_action&quot;</span><span class="nt">/&gt;</span>
<span class="hll">
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;wizard_form_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>wizard.form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>openacademy.wizard<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Add Attendees&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;group&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_id&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/group&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;act_window</span> <span class="na">id=</span><span class="s">&quot;launch_session_wizard&quot;</span>
</span><span class="hll">                    <span class="na">name=</span><span class="s">&quot;Add Attendees&quot;</span>
</span><span class="hll">                    <span class="na">src_model=</span><span class="s">&quot;openacademy.session&quot;</span>
</span><span class="hll">                    <span class="na">res_model=</span><span class="s">&quot;openacademy.wizard&quot;</span>
</span><span class="hll">                    <span class="na">view_mode=</span><span class="s">&quot;form&quot;</span>
</span><span class="hll">                    <span class="na">target=</span><span class="s">&quot;new&quot;</span>
</span><span class="hll">                    <span class="na">key2=</span><span class="s">&quot;client_action_multi&quot;</span><span class="nt">/&gt;</span>
</span>    <span class="nt">&lt;/data&gt;</span>
<span class="nt">&lt;/openerp&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Register attendees</p>
<p>Add buttons to the wizard, and implement the corresponding method for adding
the attendees to the given session.</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_id&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/group&gt;</span>
<span class="hll">                    <span class="nt">&lt;footer&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">name=</span><span class="s">&quot;subscribe&quot;</span> <span class="na">type=</span><span class="s">&quot;object&quot;</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Subscribe&quot;</span> <span class="na">class=</span><span class="s">&quot;oe_highlight&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        or
</span><span class="hll">                        <span class="nt">&lt;button</span> <span class="na">special=</span><span class="s">&quot;cancel&quot;</span> <span class="na">string=</span><span class="s">&quot;Cancel&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/footer&gt;</span>
</span>                <span class="nt">&lt;/form&gt;</span>
            <span class="nt">&lt;/field&gt;</span>
        <span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</div>
<em>openacademy/wizard.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="n">session_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span>
        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Session&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_session</span><span class="p">)</span>
    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>
<span class="hll">
</span><span class="hll">    <span class="nd">@api.multi</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="o">.</span><span class="n">attendee_ids</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span>
</span><span class="hll">        <span class="k">return</span> <span class="p">{}</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Register attendees to multiple sessions</p>
<p>Modify the wizard model so that attendees can be registered to multiple
sessions.</p>
<div class="pq-patch last container">
<em>openacademy/views/openacademy.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre>            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Add Attendees&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;group&gt;</span>
<span class="hll">                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;session_ids&quot;</span><span class="nt">/&gt;</span>
</span>                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;attendee_ids&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/group&gt;</span>
                    <span class="nt">&lt;footer&gt;</span>
</pre></div>
</div>
</div>
<em>openacademy/wizard.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Wizard</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">TransientModel</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.wizard&#39;</span>

<span class="hll">    <span class="k">def</span> <span class="nf">_default_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">[</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">browse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;active_ids&#39;</span><span class="p">))</span>
</span>
<span class="hll">    <span class="n">session_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span>
</span><span class="hll">        <span class="n">string</span><span class="o">=</span><span class="s">&quot;Sessions&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">_default_sessions</span><span class="p">)</span>
</span>    <span class="n">attendee_ids</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2many</span><span class="p">(</span><span class="s">&#39;res.partner&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s">&quot;Attendees&quot;</span><span class="p">)</span>

    <span class="nd">@api.multi</span>
    <span class="k">def</span> <span class="nf">subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">session_ids</span><span class="p">:</span>
</span><span class="hll">            <span class="n">session</span><span class="o">.</span><span class="n">attendee_ids</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span>
</span>        <span class="k">return</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="internationalization">
<h2>Internationalization</h2>
<p>Each module can provide its own translations within the i18n directory, by
having files named LANG.po where LANG is the locale code for the language, or
the language and country combination when they differ (e.g. pt.po or
pt_BR.po). Translations will be loaded automatically by Odoo for all
enabled languages. Developers always use English when creating a module, then
export the module terms using Odoo&#8217;s gettext POT export feature
(<em class="menuselection">Settings  Translations  Import/Export  Export
Translation</em> without specifying a language), to create the module template POT
file, and then derive the translated PO files. Many IDE&#8217;s have plugins or modes
for editing and merging PO/POT files.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The GNU gettext format (Portable Object) used by Odoo is
integrated into LaunchPad, making it an online collaborative
translation platform.</p>
</div>
<div class="highlight-text"><div class="highlight"><pre>|- idea/ # The module directory
   |- i18n/ # Translation files
      | - idea.pot # Translation Template (exported from Odoo)
      | - fr.po # French translation
      | - pt_BR.po # Brazilian Portuguese translation
      | (...)
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">By default Odoo&#8217;s POT export only extracts labels inside XML files or
inside field definitions in Python code, but any Python string can be
translated this way by surrounding it with the function <tt class="xref py py-func docutils literal"><span class="pre">openerp._()</span></tt>
(e.g. <tt class="docutils literal"><span class="pre">_(&quot;Label&quot;)</span></tt>)</p>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Translate a module</p>
<p>Choose a second language for your Odoo installation. Translate your
module using the facilities provided by Odoo.</p>
<ol class="arabic simple">
<li>Create a directory <tt class="docutils literal"><span class="pre">openacademy/i18n/</span></tt></li>
<li>Install whichever language you want (
<em class="menuselection">Administration  Translations  Load an
Official Translation</em>)</li>
<li>Synchronize translatable terms (<em class="menuselection">Administration 
Translations  Application Terms  Synchronize Translations</em>)</li>
<li>Create a template translation file by exporting (
<em class="menuselection">Administration  Translations -&gt; Import/Export
 Export Translation</em>) without specifying a language, save in
<tt class="docutils literal"><span class="pre">openacademy/i18n/</span></tt></li>
<li>Create a translation file by exporting (
<em class="menuselection">Administration  Translations  Import/Export
 Export Translation</em>) and specifying a language. Save it in
<tt class="docutils literal"><span class="pre">openacademy/i18n/</span></tt></li>
<li>Open the exported translation file (with a basic text editor or a
dedicated PO-file editor e.g. <a class="reference external" href="javascript:if(confirm('http://poedit.net/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://poedit.net/'" tppabs="http://poedit.net/">POEdit</a> and translate the missing
terms</li>
<li>In <tt class="docutils literal"><span class="pre">models.py</span></tt>, add an import statement for the function
<tt class="docutils literal"><span class="pre">openerp._</span></tt> and mark missing strings as translatable</li>
<li>Repeat steps 3-6</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/models.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>
<span class="hll"><span class="kn">from</span> <span class="nn">openerp</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">api</span><span class="p">,</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">_</span>
</span>
<span class="k">class</span> <span class="nc">Course</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s">&#39;openacademy.course&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        <span class="n">default</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">default</span> <span class="ow">or</span> <span class="p">{})</span>

        <span class="n">copied_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_count</span><span class="p">(</span>
<span class="hll">            <span class="p">[(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;=like&#39;</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s">u&quot;Copy of {}%&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))])</span>
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">copied_count</span><span class="p">:</span>
<span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">u&quot;Copy of {}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span>        <span class="k">else</span><span class="p">:</span>
<span class="hll">            <span class="n">new_name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">u&quot;Copy of {} ({})&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">copied_count</span><span class="p">)</span>
</span>
        <span class="n">default</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_name</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Course</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">                    <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Incorrect &#39;seats&#39; value&quot;</span><span class="p">),</span>
</span><span class="hll">                    <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;The number of available seats may not be negative&quot;</span><span class="p">),</span>
</span>                <span class="p">},</span>
            <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seats</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s">&#39;warning&#39;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">                    <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Too many attendees&quot;</span><span class="p">),</span>
</span><span class="hll">                    <span class="s">&#39;message&#39;</span><span class="p">:</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Increase seats or remove excess attendees&quot;</span><span class="p">),</span>
</span>                <span class="p">},</span>
            <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    <span class="nd">@api.constrains</span><span class="p">(</span><span class="s">&#39;instructor_id&#39;</span><span class="p">,</span> <span class="s">&#39;attendee_ids&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_check_instructor_not_in_attendees</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">instructor_id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attendee_ids</span><span class="p">:</span>
<span class="hll">            <span class="k">raise</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s">&quot;A session&#39;s instructor can&#39;t be an attendee&quot;</span><span class="p">))</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="reporting">
<h2>Reporting</h2>
<div class="section" id="printed-reports">
<h3>Printed reports</h3>
<p>Odoo 8.0 comes with a new report engine based on <a class="reference internal" href="qweb.html#reference-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/qweb.html#reference-qweb"><em>QWeb</em></a>,
<a class="reference external" href="javascript:if(confirm('http://getbootstrap.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://getbootstrap.com/'" tppabs="http://getbootstrap.com/">Twitter Bootstrap</a> and <a class="reference external" href="javascript:if(confirm('http://wkhtmltopdf.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://wkhtmltopdf.org/'" tppabs="http://wkhtmltopdf.org/">Wkhtmltopdf</a>.</p>
<p>A report is a combination two elements:</p>
<ul>
<li><p class="first">an <tt class="docutils literal"><span class="pre">ir.actions.report.xml</span></tt>, for which a <tt class="docutils literal"><span class="pre">&lt;report&gt;</span></tt> shortcut element is
provided, it sets up various basic parameters for the report (default
type, whether the report should be saved to the database after generation,)</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;report</span>
    <span class="na">id=</span><span class="s">&quot;account_invoices&quot;</span>
    <span class="na">model=</span><span class="s">&quot;account.invoice&quot;</span>
    <span class="na">string=</span><span class="s">&quot;Invoices&quot;</span>
    <span class="na">report_type=</span><span class="s">&quot;qweb-pdf&quot;</span>
    <span class="na">name=</span><span class="s">&quot;account.report_invoice&quot;</span>
    <span class="na">file=</span><span class="s">&quot;account.report_invoice&quot;</span>
    <span class="na">attachment_use=</span><span class="s">&quot;True&quot;</span>
    <span class="na">attachment=</span><span class="s">&quot;(object.state in (&#39;open&#39;,&#39;paid&#39;)) and</span>
<span class="s">        (&#39;INV&#39;+(object.number or &#39;&#39;).replace(&#39;/&#39;,&#39;&#39;)+&#39;.pdf&#39;)&quot;</span>
<span class="nt">/&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">A standard <a class="reference internal" href="views.html#reference-views-qweb" tppabs="https://www.odoo.com/documentation/8.0/reference/views.html#reference-views-qweb"><em>QWeb view</em></a> for the actual report:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.html_container&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;docs&quot;</span> <span class="na">t-as=</span><span class="s">&quot;o&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.external_layout&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;page&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;h2&gt;</span>Report title<span class="nt">&lt;/h2&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/t&gt;</span>

the standard rendering context provides a number of elements, the most
important being:

``docs``
    the records for which the report is printed
``user``
    the user printing the report
</pre></div>
</div>
</li>
</ul>
<p>Because reports are standard web pages, they are available through a URL and
output parameters can be manipulated through this URL, for instance the HTML
version of the <em>Invoice</em> report is available through
<a class="reference external" href="javascript:if(confirm('http://localhost:8069/report/html/account.report_invoice/1  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://localhost:8069/report/html/account.report_invoice/1'" tppabs="http://localhost:8069/report/html/account.report_invoice/1">http://localhost:8069/report/html/account.report_invoice/1</a> (if <tt class="docutils literal"><span class="pre">account</span></tt> is
installed) and the PDF version through
<a class="reference external" href="javascript:if(confirm('http://localhost:8069/report/pdf/account.report_invoice/1  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://localhost:8069/report/pdf/account.report_invoice/1'" tppabs="http://localhost:8069/report/pdf/account.report_invoice/1">http://localhost:8069/report/pdf/account.report_invoice/1</a>.</p>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Create a report for the Session model</p>
<p>For each session, it should display session&#8217;s name, its start and end,
and list the session&#8217;s attendees.</p>
<div class="pq-patch last container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/partner.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/session_workflow.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s">&#39;reports.xml&#39;</span><span class="p">,</span>
</span>    <span class="p">],</span>
    <span class="c"># only loaded in demonstration mode</span>
    <span class="s">&#39;demo&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
</div>
<em>openacademy/reports.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll"><span class="nt">&lt;data&gt;</span>
</span><span class="hll">    <span class="nt">&lt;report</span>
</span><span class="hll">        <span class="na">id=</span><span class="s">&quot;report_session&quot;</span>
</span><span class="hll">        <span class="na">model=</span><span class="s">&quot;openacademy.session&quot;</span>
</span><span class="hll">        <span class="na">string=</span><span class="s">&quot;Session Report&quot;</span>
</span><span class="hll">        <span class="na">name=</span><span class="s">&quot;openacademy.report_session_view&quot;</span>
</span><span class="hll">        <span class="na">file=</span><span class="s">&quot;openacademy.report_session&quot;</span>
</span><span class="hll">        <span class="na">report_type=</span><span class="s">&quot;qweb-pdf&quot;</span> <span class="nt">/&gt;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">&quot;report_session_view&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.html_container&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;docs&quot;</span> <span class="na">t-as=</span><span class="s">&quot;doc&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">&quot;report.external_layout&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;page&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;h2</span> <span class="na">t-field=</span><span class="s">&quot;doc.name&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;p&gt;</span>From <span class="nt">&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;doc.start_date&quot;</span><span class="nt">/&gt;</span> to <span class="nt">&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;doc.end_date&quot;</span><span class="nt">/&gt;&lt;/p&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;h3&gt;</span>Attendees:<span class="nt">&lt;/h3&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;ul&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">&quot;doc.attendee_ids&quot;</span> <span class="na">t-as=</span><span class="s">&quot;attendee&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                                <span class="nt">&lt;li&gt;&lt;span</span> <span class="na">t-field=</span><span class="s">&quot;attendee.name&quot;</span><span class="nt">/&gt;&lt;/li&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/ul&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/div&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/t&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/template&gt;</span>
</span><span class="hll"><span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="dashboards">
<h3>Dashboards</h3>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Define a Dashboard</p>
<p>Define a dashboard containing the graph view you created, the sessions
calendar view and a list view of the courses (switchable to a form
view). This dashboard should be available through a menuitem in the menu,
and automatically displayed in the web client when the OpenAcademy main
menu is selected.</p>
<ol class="arabic">
<li><p class="first">Create a file <tt class="docutils literal"><span class="pre">openacademy/views/session_board.xml</span></tt>. It should contain
the board view, the actions referenced in that view, an action to
open the dashboard and a re-definition of the main menu item to add
the dashboard action</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Available dashboard styles are <tt class="docutils literal"><span class="pre">1</span></tt>, <tt class="docutils literal"><span class="pre">1-1</span></tt>, <tt class="docutils literal"><span class="pre">1-2</span></tt>,
<tt class="docutils literal"><span class="pre">2-1</span></tt> and <tt class="docutils literal"><span class="pre">1-1-1</span></tt></p>
</div>
</li>
<li><p class="first">Update <tt class="docutils literal"><span class="pre">openacademy/__openerp__.py</span></tt> to reference the new data
file</p>
</li>
</ol>
<div class="pq-patch last container">
<em>openacademy/__openerp__.py</em><div class="pq-section container">
<div class="highlight-python"><div class="highlight"><pre>    <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="s">&#39;0.1&#39;</span><span class="p">,</span>

    <span class="c"># any module necessary for this one to work correctly</span>
<span class="hll">    <span class="s">&#39;depends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;base&#39;</span><span class="p">,</span> <span class="s">&#39;board&#39;</span><span class="p">],</span>
</span>
    <span class="c"># always loaded</span>
    <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="p">[</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>        <span class="s">&#39;views/openacademy.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/partner.xml&#39;</span><span class="p">,</span>
        <span class="s">&#39;views/session_workflow.xml&#39;</span><span class="p">,</span>
<span class="hll">        <span class="s">&#39;views/session_board.xml&#39;</span><span class="p">,</span>
</span>        <span class="s">&#39;reports.xml&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="c"># only loaded in demonstration mode</span>
</pre></div>
</div>
</div>
<em>openacademy/views/session_board.xml</em><div class="pq-section container">
<div class="highlight-xml+lasso"><div class="highlight"><pre><span class="hll"><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
</span><span class="hll"><span class="nt">&lt;openerp&gt;</span>
</span><span class="hll">    <span class="nt">&lt;data&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_session_graph&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Attendees by course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>graph<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span>
</span><span class="hll">                   <span class="na">ref=</span><span class="s">&quot;openacademy.openacademy_session_graph_view&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_session_calendar&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Sessions<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.session<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>calendar<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;openacademy.session_calendar_view&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;act_course_list&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Courses<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>openacademy.course<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>tree,form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;board_session_form&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Session Dashboard Form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>board.board<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">            <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                <span class="nt">&lt;form</span> <span class="na">string=</span><span class="s">&quot;Session Dashboard&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;board</span> <span class="na">style=</span><span class="s">&quot;2-1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;column&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Attendees by course&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_session_graph)d&quot;</span>
</span><span class="hll">                                <span class="na">height=</span><span class="s">&quot;150&quot;</span>
</span><span class="hll">                                <span class="na">width=</span><span class="s">&quot;510&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Sessions&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_session_calendar)d&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/column&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;column&gt;</span>
</span><span class="hll">                            <span class="nt">&lt;action</span>
</span><span class="hll">                                <span class="na">string=</span><span class="s">&quot;Courses&quot;</span>
</span><span class="hll">                                <span class="na">name=</span><span class="s">&quot;%(act_course_list)d&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">                        <span class="nt">&lt;/column&gt;</span>
</span><span class="hll">                    <span class="nt">&lt;/board&gt;</span>
</span><span class="hll">                <span class="nt">&lt;/form&gt;</span>
</span><span class="hll">            <span class="nt">&lt;/field&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">        <span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.actions.act_window&quot;</span> <span class="na">id=</span><span class="s">&quot;open_board_session&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Session Dashboard<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;res_model&quot;</span><span class="nt">&gt;</span>board.board<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_type&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_mode&quot;</span><span class="nt">&gt;</span>form<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;usage&quot;</span><span class="nt">&gt;</span>menu<span class="nt">&lt;/field&gt;</span>
</span><span class="hll">          <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;view_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;board_session_form&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">        <span class="nt">&lt;/record&gt;</span>
</span><span class="hll">
</span><span class="hll">        <span class="nt">&lt;menuitem</span>
</span><span class="hll">            <span class="na">name=</span><span class="s">&quot;Session Dashboard&quot;</span> <span class="na">parent=</span><span class="s">&quot;base.menu_reporting_dashboard&quot;</span>
</span><span class="hll">            <span class="na">action=</span><span class="s">&quot;open_board_session&quot;</span>
</span><span class="hll">            <span class="na">sequence=</span><span class="s">&quot;1&quot;</span>
</span><span class="hll">            <span class="na">id=</span><span class="s">&quot;menu_board_session&quot;</span> <span class="na">icon=</span><span class="s">&quot;terp-graph&quot;</span><span class="nt">/&gt;</span>
</span><span class="hll">    <span class="nt">&lt;/data&gt;</span>
</span><span class="hll"><span class="nt">&lt;/openerp&gt;</span>
</span></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="webservices">
<h2>WebServices</h2>
<p>The web-service module offer a common interface for all web-services :</p>
<ul class="simple">
<li>XML-RPC</li>
<li>JSON-RPC</li>
</ul>
<p>Business objects can also be accessed via the distributed object
mechanism. They can all be modified via the client interface with contextual
views.</p>
<p>Odoo is accessible through XML-RPC/JSON-RPC interfaces, for which libraries
exist in many languages.</p>
<div class="section" id="xml-rpc-library">
<h3>XML-RPC Library</h3>
<p>The following example is a Python program that interacts with an Odoo
server with the library <tt class="docutils literal"><span class="pre">xmlrpclib</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">xmlrpclib</span>

<span class="n">root</span> <span class="o">=</span> <span class="s">&#39;http://</span><span class="si">%s</span><span class="s">:</span><span class="si">%d</span><span class="s">/xmlrpc/&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="n">uid</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s">&#39;common&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Logged in as </span><span class="si">%s</span><span class="s"> (uid: </span><span class="si">%d</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>

<span class="c"># Create a new note</span>
<span class="n">sock</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s">&#39;object&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&#39;memo&#39;</span> <span class="p">:</span> <span class="s">&#39;This is a note&#39;</span><span class="p">,</span>
    <span class="s">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="s">&#39;note.note&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition exercise">
<p class="first admonition-title">Exercise</p>
<p>Add a new service to the client</p>
<p>Write a Python program able to send XML-RPC requests to a PC running
Odoo (yours, or your instructor&#8217;s). This program should display all
the sessions, and their corresponding number of seats. It should also
create a new session for one of the courses.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="n">HOST</span> <span class="o">=</span> <span class="s">&#39;localhost&#39;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">8069</span>
<span class="n">DB</span> <span class="o">=</span> <span class="s">&#39;openacademy&#39;</span>
<span class="n">USER</span> <span class="o">=</span> <span class="s">&#39;admin&#39;</span>
<span class="n">PASS</span> <span class="o">=</span> <span class="s">&#39;admin&#39;</span>
<span class="n">ROOT</span> <span class="o">=</span> <span class="s">&#39;http://</span><span class="si">%s</span><span class="s">:</span><span class="si">%d</span><span class="s">/xmlrpc/&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span><span class="n">PORT</span><span class="p">)</span>

<span class="c"># 1. Login</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">+</span> <span class="s">&#39;common&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">DB</span><span class="p">,</span><span class="n">USER</span><span class="p">,</span><span class="n">PASS</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Logged in as </span><span class="si">%s</span><span class="s"> (uid:</span><span class="si">%d</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">USER</span><span class="p">,</span><span class="n">uid</span><span class="p">)</span>

<span class="n">call</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
    <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">ServerProxy</span><span class="p">(</span><span class="n">ROOT</span> <span class="o">+</span> <span class="s">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">,</span>
    <span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>

<span class="c"># 2. Read the sessions</span>
<span class="n">sessions</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span><span class="s">&#39;search_read&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">,</span><span class="s">&#39;seats&#39;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">session</span> <span class="ow">in</span> <span class="n">sessions</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&quot;Session </span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s"> seats)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">session</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">],</span> <span class="n">session</span><span class="p">[</span><span class="s">&#39;seats&#39;</span><span class="p">])</span>
<span class="c"># 3.create a new session</span>
<span class="n">session_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="s">&#39;My session&#39;</span><span class="p">,</span>
    <span class="s">&#39;course_id&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Instead of using a hard-coded course id, the code can look up a course
by name:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="c"># 3.create a new session for the &quot;Functional&quot; course</span>
<span class="n">course_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s">&#39;openacademy.course&#39;</span><span class="p">,</span> <span class="s">&#39;search&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&#39;name&#39;</span><span class="p">,</span><span class="s">&#39;ilike&#39;</span><span class="p">,</span><span class="s">&#39;Functional&#39;</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">session_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="s">&#39;openacademy.session&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s">&#39;name&#39;</span> <span class="p">:</span> <span class="s">&#39;My session&#39;</span><span class="p">,</span>
    <span class="s">&#39;course_id&#39;</span> <span class="p">:</span> <span class="n">course_id</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="json-rpc-library">
<h3>JSON-RPC Library</h3>
<p>The following example is a Python program that interacts with an Odoo server
with the standard Python libraries <tt class="docutils literal"><span class="pre">urllib2</span></tt> and <tt class="docutils literal"><span class="pre">json</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">urllib2</span>

<span class="k">def</span> <span class="nf">json_rpc</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;jsonrpc&quot;</span><span class="p">:</span> <span class="s">&quot;2.0&quot;</span><span class="p">,</span>
        <span class="s">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
        <span class="s">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
        <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000000000</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s">&quot;Content-Type&quot;</span><span class="p">:</span><span class="s">&quot;application/json&quot;</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="n">reply</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">reply</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;error&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">reply</span><span class="p">[</span><span class="s">&quot;error&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">reply</span><span class="p">[</span><span class="s">&quot;result&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json_rpc</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">&quot;call&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;service&quot;</span><span class="p">:</span> <span class="n">service</span><span class="p">,</span> <span class="s">&quot;method&quot;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span> <span class="s">&quot;args&quot;</span><span class="p">:</span> <span class="n">args</span><span class="p">})</span>

<span class="c"># log in the given database</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">/jsonrpc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">&quot;common&quot;</span><span class="p">,</span> <span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">)</span>

<span class="c"># create a new note</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&#39;memo&#39;</span> <span class="p">:</span> <span class="s">&#39;This is another note&#39;</span><span class="p">,</span>
    <span class="s">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">call</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">&quot;object&quot;</span><span class="p">,</span> <span class="s">&quot;execute&quot;</span><span class="p">,</span> <span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="s">&#39;note.note&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>Here is the same program, using the library
<cite>jsonrpclib &lt;https://pypi.python.org/pypi/jsonrpclib&gt;</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">jsonrpclib</span>

<span class="c"># server proxy object</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">/jsonrpc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">jsonrpclib</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="c"># log in the given database</span>
<span class="n">uid</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s">&quot;common&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;login&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">DB</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PASS</span><span class="p">])</span>

<span class="c"># helper function for invoking model methods</span>
<span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="n">DB</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">PASS</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">method</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">server</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s">&quot;object&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&quot;execute&quot;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>

<span class="c"># create a new note</span>
<span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;color&#39;</span> <span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s">&#39;memo&#39;</span> <span class="p">:</span> <span class="s">&#39;This is another note&#39;</span><span class="p">,</span>
    <span class="s">&#39;create_uid&#39;</span><span class="p">:</span> <span class="n">uid</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">note_id</span> <span class="o">=</span> <span class="n">invoke</span><span class="p">(</span><span class="s">&#39;note.note&#39;</span><span class="p">,</span> <span class="s">&#39;create&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>Examples can be easily adapted from XML-RPC to JSON-RPC.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>There are a number of high-level APIs in various languages to access Odoo
systems without <em>explicitly</em> going through XML-RPC or JSON-RPC, such as:</p>
<ul class="last simple">
<li><a class="reference external" href="javascript:if(confirm('https://github.com/akretion/ooor  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/akretion/ooor'" tppabs="https://github.com/akretion/ooor">https://github.com/akretion/ooor</a></li>
<li><a class="reference external" href="javascript:if(confirm('https://github.com/syleam/openobject-library  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/syleam/openobject-library'" tppabs="https://github.com/syleam/openobject-library">https://github.com/syleam/openobject-library</a></li>
<li><a class="reference external" href="javascript:if(confirm('https://github.com/nicolas-van/openerp-client-lib  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://github.com/nicolas-van/openerp-client-lib'" tppabs="https://github.com/nicolas-van/openerp-client-lib">https://github.com/nicolas-van/openerp-client-lib</a></li>
<li><a class="reference external" href="javascript:if(confirm('https://pypi.python.org/pypi/oersted/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://pypi.python.org/pypi/oersted/'" tppabs="https://pypi.python.org/pypi/oersted/">https://pypi.python.org/pypi/oersted/</a></li>
</ul>
</div>
<table class="docutils footnote" frame="void" id="autofields" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>it is possible to <a class="reference internal" href="orm.html#openerp.models.Model._log_access" tppabs="https://www.odoo.com/documentation/8.0/reference/orm.html#openerp.models.Model._log_access" title="openerp.models.Model._log_access"><tt class="xref py py-attr docutils literal"><span class="pre">disable</span> <span class="pre">the</span> <span class="pre">automatic</span> <span class="pre">creation</span> <span class="pre">of</span> <span class="pre">some</span>
<span class="pre">fields</span></tt></a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="rawsql" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[2]</a></td><td>writing raw SQL queries is possible, but requires care as it
bypasses all Odoo authentication and security mechanisms.</td></tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </div>
    <div class="footer">
      <div class="container">
        <ul class="docs-footer-links muted">
            <li>
                &copy; Copyright <a href="javascript:if(confirm('https://odoo.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='https://odoo.com/'" tppabs="https://odoo.com/">Odoo S.A.</a>.
            </li><li>路</li>
            <li>Created using <a href="javascript:if(confirm('http://sphinx-doc.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://sphinx-doc.org/'" tppabs="http://sphinx-doc.org/">Sphinx</a> 1.2.2.</li>
        </ul>
      <p>
        odoo docs theme based on <a href="javascript:if(confirm('http://getbootstrap.com/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://getbootstrap.com/'" tppabs="http://getbootstrap.com/">Bootstrap
        3.2 documentation</a> adapted to
        <a href="javascript:if(confirm('http://sphinx-doc.org/  \n\n该文件无法用 Teleport Ultra 下载, 因为 它是一个域或路径外部被设置为它的启始地址的地址。  \n\n你想在服务器上打开它?'))window.location='http://sphinx-doc.org/'" tppabs="http://sphinx-doc.org/">Sphinx</a> output with branding and
        color changes.
      </p>
      </div>
    </div><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','analytics.js'/*tpa=https://www.google-analytics.com/analytics.js*/,'ga');

    ga('create', 'UA-52174891-1', 'auto');
    ga('send','pageview');
    </script>
  </body>
</html>